USE [QSPFulfillment]
GO

/****** Object:  StoredProcedure [dbo].[pr_ar_sync_delete_generated_data]    Script Date: 06/16/2010 13:23:17 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

-- =============================================
-- Author:		Juan Martinez
-- Create date: 2010-05-14
-- Description:	Start date is inclisive
--				End date is exclusive
-- =============================================
CREATE PROCEDURE [dbo].[pr_ar_sync_delete_generated_data]
	@pStartDate datetime, 
	@pEndDate datetime
AS
BEGIN

	SET NOCOUNT ON;

	-- Delete payment_invoice
	delete 
	from	payment_invoice 
	where	is_created_by_ar_sync = 1
			and transaction_date >= @pStartDate 
			and transaction_date < @pEndDate

	-- Delete payments
	delete 
	from	payment 
	where	is_created_by_ar_sync = 1
			and transaction_date >= @pStartDate 
			and transaction_date < @pEndDate

	-- Delete adjustment
	delete 
	from	adjustment_invoice 
	where	is_created_by_ar_sync = 1
			and transaction_date >= @pStartDate 
			and transaction_date < @pEndDate

	-- Delete adjustment
	delete 
	from	adjustment 
	where	is_created_by_ar_sync = 1
			and transaction_date >= @pStartDate 
			and transaction_date < @pEndDate

	-- Delete invoice
	delete 
	from	invoice 
	where	is_created_by_ar_sync = 1
			and transaction_date >= @pStartDate 
			and transaction_date < @pEndDate

END

GO


