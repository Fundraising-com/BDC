///////////////////////////////////////////////////////////////////////////
// Description: Data Access class for the table 'product'
// Generated by Jas on: Monday, November 03, 2003, 4:18:07 PM
// Because the Base Class already implements IDispose, this class doesn't.
///////////////////////////////////////////////////////////////////////////
using System;
using System.Data;
using System.Data.SqlTypes;
using System.Data.SqlClient;
using QSPForm.Common.DataDef;
using dataDef = QSPForm.Common.DataDef.LogoTable;

namespace QSPForm.Data
{
	/// <summary>
	/// Purpose: Data Access class for the table 'product'.
	/// </summary>
	public class Logo : DBTableOperation
	{

		#region Parameter
		//Stored procedure parameter names
		public const string PARAM_PKID = "@ilogo_id";
		public const string PARAM_LOGO_NAME = "@slogo_name";
		public const string PARAM_FSM_ID = "@ifield_sales_manager_id";
		public const string PARAM_FILE_EXTENSION = "@sfile_extension";
		public const string PARAM_DESCRIPTION = "@sdescription";
		public const string PARAM_REGION_ID = "@iregion_id";
		public const string PARAM_NATIONAL = "@bnational";
		public const string PARAM_ENABLED = "@benabled";
		public const string PARAM_CATEGORY = "@iimage_category_id";

		//
		// Stored procedure names for each operation
		private const string SQL_PROC_INSERT = "pr_QSPForm_logo_Insert";
		private const string SQL_PROC_UPDATE = "pr_QSPForm_logo_Update";	
		private const string SQL_PROC_DELETE = "pr_QSPForm_logo_Delete";
		private const string SQL_PROC_SELECT_ONE = "pr_QSPForm_logo_SelectOne";
		private const string SQL_PROC_SELECT_ALL = "pr_QSPForm_logo_SelectAll";

		#endregion

		//
		// DataSetCommand object
		//
		
		private SqlCommand insertCommand;
		private SqlCommand updateCommand;
		private SqlCommand deleteCommand;

		/// <summary>
		/// Purpose: Class constructor.
		/// </summary>
		public Logo()
		{
			// Nothing for now.
		}

		//----------------------------------------------------------------
		// Sub GetInsertCommand:
		//   Initialize the parameterized Insert command for the DataAdapter
		//----------------------------------------------------------------
		protected override SqlCommand GetInsertCommand()
		{
			if ( insertCommand == null )
			{
				//
				// Construct the command since we don't have it already
				// 
				insertCommand = new SqlCommand(SQL_PROC_INSERT);
				insertCommand.CommandType = CommandType.StoredProcedure;
				insertCommand.UpdatedRowSource = UpdateRowSource.OutputParameters; 
            
				SqlParameterCollection sqlParams = insertCommand.Parameters;
            
				//Fill the SqlParameterCollection
				FillParams(sqlParams);				
								
				//Adjust paramters direction
				sqlParams[PARAM_PKID].Direction = ParameterDirection.Output;				
				
				//Map the source column
				MapColumn(sqlParams);	


				//Adjust for insert context
				sqlParams.Add(new SqlParameter(PARAM_CREATE_USER_ID, SqlDbType.Int));
				sqlParams[PARAM_CREATE_USER_ID].SourceColumn = dataDef.FLD_CREATE_USER_ID;

			}
            
			return insertCommand;
		}

		//----------------------------------------------------------------
		// Sub BuildUpdateCommand:
		//   Initialize the parameterized Update command for the DataAdapter
		//----------------------------------------------------------------
		protected override SqlCommand GetUpdateCommand()
		{
			if ( updateCommand == null )
			{
				
				updateCommand = new SqlCommand(SQL_PROC_UPDATE);
				updateCommand.CommandType = CommandType.StoredProcedure;
				
            
				SqlParameterCollection sqlParams = updateCommand.Parameters;
            
				//Fill the SqlParameterCollection
				FillParams(sqlParams);

				//Map the source column
				MapColumn(sqlParams);

				

				//Adjust for update context
				sqlParams.Add(new SqlParameter(PARAM_UPDATE_USER_ID, SqlDbType.Int));
				sqlParams[PARAM_UPDATE_USER_ID].SourceColumn = dataDef.FLD_UPDATE_USER_ID;

				sqlParams.Add(new SqlParameter(PARAM_DELETED, SqlDbType.Bit));
				sqlParams[PARAM_DELETED].SourceColumn = dataDef.FLD_DELETED;

			}
            
			return updateCommand;
		}
		//-----------------------
		// Set Mapping and Params in 2 differents method
		//-----------------------

		private void FillParams(SqlParameterCollection param)
		{
			param.Add(new SqlParameter(PARAM_PKID, SqlDbType.Int));
			param.Add(new SqlParameter(PARAM_FSM_ID, SqlDbType.Int));
			param.Add(new SqlParameter(PARAM_LOGO_NAME,SqlDbType.VarChar, 50));
			param.Add(new SqlParameter(PARAM_FILE_EXTENSION,SqlDbType.VarChar, 4));
			param.Add(new SqlParameter(PARAM_DESCRIPTION,SqlDbType.VarChar, 500));
			param.Add(new SqlParameter(PARAM_ENABLED, SqlDbType.Bit));
			param.Add(new SqlParameter(PARAM_CATEGORY, SqlDbType.Int));
			
			
		}

		private void MapColumn(SqlParameterCollection param)
		{
			param[PARAM_PKID].SourceColumn = dataDef.FLD_PKID;
			param[PARAM_FSM_ID].SourceColumn = dataDef.FLD_FSM_ID;
			param[PARAM_LOGO_NAME].SourceColumn = dataDef.FLD_LOGO_NAME;
			param[PARAM_FILE_EXTENSION].SourceColumn = dataDef.FLD_FILE_EXTENSION;
			param[PARAM_DESCRIPTION].SourceColumn = dataDef.FLD_DESCRIPTION;
			param[PARAM_ENABLED].SourceColumn = dataDef.FLD_ENABLED;
			param[PARAM_CATEGORY].SourceColumn = dataDef.FLD_CATEGORY;

		}

		protected override string TableName
		{
			get{return dataDef.TBL_LOGO;}
		}

		
		//----------------------------------------------------------------
		// Sub BuildUpdateCommand:
		//   Initialize the parameterized Update command for the DataAdapter
		//----------------------------------------------------------------
		protected override SqlCommand GetDeleteCommand()
		{
			if ( deleteCommand == null )
			{
				//
				// Construct the command since we don't have it already
				//
				deleteCommand = new SqlCommand(SQL_PROC_DELETE);
				deleteCommand.CommandType = CommandType.StoredProcedure;
				
				SqlParameterCollection sqlParams = deleteCommand.Parameters;
            
				sqlParams.Add(new SqlParameter(PARAM_PKID, SqlDbType.Int));
				sqlParams.Add(new SqlParameter(PARAM_UPDATE_USER_ID, SqlDbType.Int));
				//
				// Define the parameter mappings from the data tabl
				//
				sqlParams[PARAM_PKID].SourceColumn = dataDef.FLD_PKID;	
				sqlParams[PARAM_UPDATE_USER_ID].SourceColumn = dataDef.FLD_UPDATE_USER_ID;
				//Only Mapped DataColumn are imply...
			}
            
			return deleteCommand;
		}

		//public dataDef SelectAll_Search(int SearchType, String Criteria, int RegionID, int NationalStatus, int DisplayStatus, string StartDate, string EndDate, string FM_ID, bool IncludeFMReportedTo)
        public dataDef SelectAll_Search(int searchType, String criteria, int logoType, int displayStatus, string fm_id, int imageCategory)
		{
			dataDef Table = new dataDef();
			SqlCommand	cmdToExecute = new SqlCommand();
			cmdToExecute.CommandText = "dbo.pr_QSPForm_Logo_SelectAll_Search2";
			cmdToExecute.CommandType = CommandType.StoredProcedure;
			cmdToExecute.Parameters.Add(new SqlParameter(PARAM_SEARCH_TYPE, SqlDbType.Int, 4, ParameterDirection.Input, false, 10, 0, "", DataRowVersion.Proposed, searchType));
			cmdToExecute.Parameters.Add(new SqlParameter(PARAM_SEARCH_CRITERIA, SqlDbType.VarChar, 100, ParameterDirection.Input, false, 10, 0, "", DataRowVersion.Proposed, criteria));
			
			if (fm_id.Length > 0)
				cmdToExecute.Parameters.Add(new SqlParameter(PARAM_FSM_ID, SqlDbType.VarChar, 4, ParameterDirection.Input, false, 10, 0, "", DataRowVersion.Proposed, fm_id));
			cmdToExecute.Parameters.Add(new SqlParameter("@ilogo_type", SqlDbType.Int,4,ParameterDirection.Input,false,10,0,"",DataRowVersion.Proposed, logoType));
			if (displayStatus > -1)
				cmdToExecute.Parameters.Add(new SqlParameter("@benabled", SqlDbType.Bit, 1, ParameterDirection.Input, false, 10, 0, "", DataRowVersion.Proposed, (displayStatus == 1)));
			if ( imageCategory > 0 )
				cmdToExecute.Parameters.Add(new SqlParameter("@iimage_category_id", SqlDbType.Int, 1, ParameterDirection.Input, false, 10, 0, "", DataRowVersion.Proposed, imageCategory));
			
			Select(cmdToExecute,Table);

			return Table;
		}

		public dataDef SelectAll_Search(string Criteria, string FSM_ID)
		{
			dataDef Table = new dataDef();
			SqlCommand	cmdToExecute = new SqlCommand();
			cmdToExecute.CommandText = "dbo.pr_QSPForm_logo_SelectAll_Search";
			cmdToExecute.CommandType = CommandType.StoredProcedure;
			cmdToExecute.Parameters.Add(new SqlParameter(PARAM_FSM_ID, SqlDbType.VarChar, 4, ParameterDirection.Input, false, 10, 0, "", DataRowVersion.Proposed, FSM_ID));
			cmdToExecute.Parameters.Add(new SqlParameter(PARAM_SEARCH_CRITERIA, SqlDbType.VarChar, 100, ParameterDirection.Input, false, 10, 0, "", DataRowVersion.Proposed, Criteria));
			Select(cmdToExecute,Table);
			return Table;
		}
		public new dataDef SelectAll()
		{
			dataDef Table = new dataDef();
			SqlCommand	cmdToExecute = new SqlCommand();
			cmdToExecute.CommandText = "dbo.pr_QSPForm_logo_SelectAll";
			cmdToExecute.CommandType = CommandType.StoredProcedure;
			//cmdToExecute.Parameters.Add(new SqlParameter(PARAM_SEARCH_CRITERIA, SqlDbType.VarChar, 100, ParameterDirection.Input, false, 10, 0, "", DataRowVersion.Proposed, Criteria));
			Select(cmdToExecute,Table);
			return Table;
		}
		public new dataDef SelectOne(int LogoID)
		{
			dataDef Table = new dataDef();
			SqlCommand	cmdToExecute = new SqlCommand();
			cmdToExecute.CommandText = "dbo.pr_QSPForm_logo_SelectOne";
            cmdToExecute.CommandType = CommandType.StoredProcedure;
			cmdToExecute.Parameters.Add(new SqlParameter(PARAM_PKID, SqlDbType.Int, 4, ParameterDirection.Input, false, 10, 0, "", DataRowVersion.Proposed, LogoID));
			Select(cmdToExecute,Table);
			return Table;
		}
		public dataDef SelectAllLogoURLByOrderID(int OrderID)
		{
			dataDef Table = new dataDef();
			SqlCommand	cmdToExecute = new SqlCommand();
			cmdToExecute.CommandText = "dbo.AV_SelectAllLogoByOrderID";
			cmdToExecute.CommandType = CommandType.StoredProcedure;
			cmdToExecute.Parameters.Add(new SqlParameter("@iorder_id", SqlDbType.Int, 4, ParameterDirection.Input, false, 10, 0, "", DataRowVersion.Proposed, OrderID));
			Select(cmdToExecute,Table);
			return Table;
		}
        public dataDef SelectAllFavoriteByFMID(string FMID)
        {
            dataDef Table = new dataDef();
            SqlCommand cmdToExecute = new SqlCommand();
            cmdToExecute.CommandText = "dbo.pr_QSPForm_logo_SelectAllFavoriteByFMID";
            cmdToExecute.CommandType = CommandType.StoredProcedure;
            cmdToExecute.Parameters.Add(new SqlParameter("@sfm_id", SqlDbType.VarChar, 4, ParameterDirection.Input, false, 10, 0, "", DataRowVersion.Proposed, FMID));
            Select(cmdToExecute, Table);
            return Table;
        }

		/*
		
		//We create a new method when we want to the return type variable
		public new dataDef SelectOne(int ProductID)
		{
			dataDef Table = new dataDef();
			SqlCommand	cmdToExecute = new SqlCommand();
			cmdToExecute.CommandText = SQL_PROC_SELECT_ONE;
			cmdToExecute.CommandType = CommandType.StoredProcedure;
			
			cmdToExecute.Parameters.Add(new SqlParameter(PARAM_PKID, SqlDbType.Int, 4, ParameterDirection.Input, false, 10, 0, "", DataRowVersion.Proposed, ProductID));
			
			Select(cmdToExecute,Table);

			return Table;
				
		}

		public new dataDef SelectAll()
		{
			dataDef Table = new dataDef();

			SqlCommand	cmdToExecute = new SqlCommand();
			cmdToExecute.CommandText = SQL_PROC_SELECT_ALL;
			cmdToExecute.CommandType = CommandType.StoredProcedure;
			
					
			Select(cmdToExecute,Table);
			return  Table;
			
		}

		public dataDef SelectAllWproduct_type_idLogic(int ProductType)
		{
			dataDef Table = new dataDef();

			SqlCommand	cmdToExecute = new SqlCommand();
			cmdToExecute.CommandText = "dbo.pr_product_SelectAllWproduct_type_idLogic";
			cmdToExecute.CommandType = CommandType.StoredProcedure;
			cmdToExecute.Parameters.Add(new SqlParameter(PARAM_PRODUCT_TYPE_ID, SqlDbType.Int, 4, ParameterDirection.Input, false, 10, 0, "", DataRowVersion.Proposed, ProductType));
			
					
			Select(cmdToExecute,Table);
			
			return  Table;
			
		}
		*/
	
	}
}
