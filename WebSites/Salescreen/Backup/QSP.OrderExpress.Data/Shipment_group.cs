///////////////////////////////////////////////////////////////////////////
// Description: Data Access class for the table 'order'
// Generated by Jas on: Monday, November 03, 2003, 4:18:07 PM
// Because the Base Class already implements IDispose, this class doesn't.
///////////////////////////////////////////////////////////////////////////
using System;
using System.Data;
using System.Data.SqlTypes;
using System.Data.SqlClient;
using QSPForm.Common.DataDef;
using dataDef = QSPForm.Common.DataDef.ShipmentGroupTable;

namespace QSPForm.Data
{
	/// <summary>
	/// Purpose: Data Access class for the table 'Shipment_group'.
	/// </summary>
	public class Shipment_group : DBTableOperation
	{

		#region Parameter
		//Stored procedure parameter names
		public const string PARAM_PKID = "@ishipment_group_id";
		public const string PARAM_DELIVERY_WAREHOUSE_ID ="@idelivery_warehouse_id";
		public const string PARAM_DELIVERY_METHOD_ID ="@idelivery_method_id";
		public const string PARAM_SHIPPING_ADDRESS_ID ="@ishipping_postal_address_id";		
		public const string PARAM_SHIPPING_PHONE_NUMBER_ID ="@ishipping_phone_number_id";	
		public const string PARAM_SHIPPING_FAX_NUMBER_ID ="@ishipping_fax_number_id";	
		public const string PARAM_SHIPPING_EMAIL_ID ="@ishipping_email_id";	
		public const string PARAM_SHIPMENT_DATE ="@dashipment_date";	
		public const string PARAM_REQUESTED_DELIVERY_DATE ="@darequested_delivery_date";
        public const string PARAM_REQUESTED_DELIVERY_TIME = "@darequested_delivery_time";
		public const string PARAM_DELIVERY_NLT ="@dadelivery_no_later_than";
		public const string PARAM_SHIPPING_CHARGES ="@mshipping_charges";
        public const string PARAM_SHIPPING_EXPEDITED_FREIGHT_CHARGES_PAYMENT_ASSIGNMENT_TYPE_ID = "@iexpedited_freight_charge_payment_assignment_type_id";
		public const string PARAM_SHIPMENT_SUPPLY_TO ="@ishipment_supply_to";
		
		//For SearchAll
		private const String PARAM_START_DATE		= "@dastart_date";
		private const String PARAM_END_DATE			= "@daend_date";
		
		//
		// Stored procedure names for each operation
		private const string SQL_PROC_DELETE = "dbo.pr_shipment_group_Delete";
		private const string SQL_PROC_INSERT = "dbo.pr_shipment_group_Insert";
		private const string SQL_PROC_UPDATE = "dbo.pr_shipment_group_Update";	
		private const string SQL_PROC_SELECT_ONE = "dbo.pr_shipment_group_SelectOne";
		private const string SQL_PROC_SELECT_ALL = "dbo.pr_shipment_group_SelectAll";

		#endregion

		//
		// DataSetCommand object
		//
		
		private SqlCommand insertCommand;
		private SqlCommand updateCommand;
		private SqlCommand deleteCommand;

		/// <summary>
		/// Purpose: Class constructor.
		/// </summary>
		public Shipment_group()
		{
			// Nothing for now.
		}

		//----------------------------------------------------------------
		// Sub GetInsertCommand:
		//   Initialize the parameterized Insert command for the DataAdapter
		//----------------------------------------------------------------
		protected override SqlCommand GetInsertCommand()
		{
			if ( insertCommand == null )
			{
				//
				// Construct the command since we don't have it already
				// 
				insertCommand = new SqlCommand(SQL_PROC_INSERT);
				insertCommand.CommandType = CommandType.StoredProcedure;
				insertCommand.UpdatedRowSource = UpdateRowSource.OutputParameters; 
            
				SqlParameterCollection sqlParams = insertCommand.Parameters;
            
				sqlParams.Add(new SqlParameter(PARAM_DELIVERY_WAREHOUSE_ID, SqlDbType.Int));
				sqlParams.Add(new SqlParameter(PARAM_DELIVERY_METHOD_ID, SqlDbType.Int));
				sqlParams.Add(new SqlParameter(PARAM_SHIPPING_ADDRESS_ID, SqlDbType.Int));	
				sqlParams.Add(new SqlParameter(PARAM_SHIPPING_PHONE_NUMBER_ID, SqlDbType.Int));	
				sqlParams.Add(new SqlParameter(PARAM_SHIPPING_FAX_NUMBER_ID, SqlDbType.Int));
				sqlParams.Add(new SqlParameter(PARAM_SHIPPING_EMAIL_ID, SqlDbType.Int));
				sqlParams.Add(new SqlParameter(PARAM_SHIPMENT_DATE, SqlDbType.DateTime));
				sqlParams.Add(new SqlParameter(PARAM_REQUESTED_DELIVERY_DATE, SqlDbType.DateTime));
                sqlParams.Add(new SqlParameter(PARAM_REQUESTED_DELIVERY_TIME, SqlDbType.DateTime));
				sqlParams.Add(new SqlParameter(PARAM_DELIVERY_NLT, SqlDbType.DateTime));
				sqlParams.Add(new SqlParameter(PARAM_SHIPPING_CHARGES, SqlDbType.Money));
				sqlParams.Add(new SqlParameter(PARAM_SHIPPING_EXPEDITED_FREIGHT_CHARGES_PAYMENT_ASSIGNMENT_TYPE_ID, SqlDbType.Int));
				sqlParams.Add(new SqlParameter(PARAM_SHIPMENT_SUPPLY_TO, SqlDbType.Int));	
				sqlParams.Add(new SqlParameter(PARAM_CREATE_USER_ID, SqlDbType.Int));
				
							
				sqlParams.Add(new SqlParameter(PARAM_PKID, SqlDbType.Int));				
				sqlParams[PARAM_PKID].Direction = ParameterDirection.Output;

				//
				// Define the parameter mappings from the data table in the
				// dataset.
				//
				sqlParams[PARAM_PKID].SourceColumn = dataDef.FLD_PKID;
				sqlParams[PARAM_DELIVERY_WAREHOUSE_ID].SourceColumn = dataDef.FLD_DELIVERY_WAREHOUSE_ID;
				sqlParams[PARAM_DELIVERY_METHOD_ID].SourceColumn = dataDef.FLD_DELIVERY_METHOD_ID;
				sqlParams[PARAM_SHIPPING_ADDRESS_ID].SourceColumn = dataDef.FLD_SHIPPING_POSTAL_ADDRESS_ID;
				sqlParams[PARAM_SHIPPING_PHONE_NUMBER_ID].SourceColumn = dataDef.FLD_SHIPPING_PHONE_NUMBER_ID;
				sqlParams[PARAM_SHIPPING_FAX_NUMBER_ID].SourceColumn = dataDef.FLD_SHIPPING_FAX_NUMBER_ID;
				sqlParams[PARAM_SHIPPING_EMAIL_ID].SourceColumn = dataDef.FLD_SHIPPING_EMAIL_ADDRESS_ID;
				sqlParams[PARAM_SHIPMENT_DATE].SourceColumn = dataDef.FLD_SHIPMENT_DATE;
				sqlParams[PARAM_REQUESTED_DELIVERY_DATE].SourceColumn = dataDef.FLD_REQUESTED_DELIVERY_DATE;
                sqlParams[PARAM_REQUESTED_DELIVERY_TIME].SourceColumn = dataDef.FLD_REQUESTED_DELIVERY_TIME;
				sqlParams[PARAM_DELIVERY_NLT].SourceColumn = dataDef.FLD_DELIVERY_NLT;
				sqlParams[PARAM_SHIPPING_CHARGES].SourceColumn = dataDef.FLD_SHIPPING_CHARGES;
				sqlParams[PARAM_SHIPPING_EXPEDITED_FREIGHT_CHARGES_PAYMENT_ASSIGNMENT_TYPE_ID].SourceColumn = dataDef.FLD_SHIPPING_EXPEDITED_FREIGHT_CHARGES_PAYMENT_ASSIGNMENT_TYPE_ID;
				sqlParams[PARAM_SHIPMENT_SUPPLY_TO].SourceColumn = dataDef.FLD_SHIP_SUPPLY_TO;
				sqlParams[PARAM_CREATE_USER_ID].SourceColumn = dataDef.FLD_CREATE_USER_ID;						
				
				//Don't need to map ErrorCode cause is not imply in the insert
				//Only Mapped DataColumn are imply...
			}
            
			return insertCommand;
		}

		//----------------------------------------------------------------
		// Sub BuildUpdateCommand:
		//   Initialize the parameterized Update command for the DataAdapter
		//----------------------------------------------------------------
		protected override SqlCommand GetUpdateCommand()
		{
			if ( updateCommand == null )
			{
				//
				// Construct the command since we don't have it already
				//
				updateCommand = new SqlCommand(SQL_PROC_UPDATE);
				updateCommand.CommandType = CommandType.StoredProcedure;
				
            
				SqlParameterCollection sqlParams = updateCommand.Parameters;
            
				sqlParams.Add(new SqlParameter(PARAM_PKID, SqlDbType.Int));
				sqlParams.Add(new SqlParameter(PARAM_DELIVERY_WAREHOUSE_ID, SqlDbType.Int));
				sqlParams.Add(new SqlParameter(PARAM_DELIVERY_METHOD_ID, SqlDbType.Int));
				sqlParams.Add(new SqlParameter(PARAM_SHIPPING_ADDRESS_ID, SqlDbType.Int));	
				sqlParams.Add(new SqlParameter(PARAM_SHIPPING_PHONE_NUMBER_ID, SqlDbType.Int));	
				sqlParams.Add(new SqlParameter(PARAM_SHIPPING_FAX_NUMBER_ID, SqlDbType.Int));
				sqlParams.Add(new SqlParameter(PARAM_SHIPPING_EMAIL_ID, SqlDbType.Int));
				sqlParams.Add(new SqlParameter(PARAM_SHIPMENT_DATE, SqlDbType.DateTime));
				sqlParams.Add(new SqlParameter(PARAM_REQUESTED_DELIVERY_DATE, SqlDbType.DateTime));
                sqlParams.Add(new SqlParameter(PARAM_REQUESTED_DELIVERY_TIME, SqlDbType.DateTime));
				sqlParams.Add(new SqlParameter(PARAM_DELIVERY_NLT, SqlDbType.DateTime));
				sqlParams.Add(new SqlParameter(PARAM_SHIPPING_CHARGES, SqlDbType.Money));
				sqlParams.Add(new SqlParameter(PARAM_SHIPPING_EXPEDITED_FREIGHT_CHARGES_PAYMENT_ASSIGNMENT_TYPE_ID, SqlDbType.Int));
				sqlParams.Add(new SqlParameter(PARAM_SHIPMENT_SUPPLY_TO, SqlDbType.Int));	
				
				sqlParams.Add(new SqlParameter(PARAM_DELETED, SqlDbType.Bit));
				sqlParams.Add(new SqlParameter(PARAM_UPDATE_USER_ID, SqlDbType.Int));	

				// Define the parameter mappings from the data tabl
				//
				sqlParams[PARAM_PKID].SourceColumn = dataDef.FLD_PKID;
				sqlParams[PARAM_DELIVERY_WAREHOUSE_ID].SourceColumn = dataDef.FLD_DELIVERY_WAREHOUSE_ID;
				sqlParams[PARAM_DELIVERY_METHOD_ID].SourceColumn = dataDef.FLD_DELIVERY_METHOD_ID;
				sqlParams[PARAM_SHIPPING_ADDRESS_ID].SourceColumn = dataDef.FLD_SHIPPING_POSTAL_ADDRESS_ID;
				sqlParams[PARAM_SHIPPING_PHONE_NUMBER_ID].SourceColumn = dataDef.FLD_SHIPPING_PHONE_NUMBER_ID;
				sqlParams[PARAM_SHIPPING_FAX_NUMBER_ID].SourceColumn = dataDef.FLD_SHIPPING_FAX_NUMBER_ID;
				sqlParams[PARAM_SHIPPING_EMAIL_ID].SourceColumn = dataDef.FLD_SHIPPING_EMAIL_ADDRESS_ID;
				sqlParams[PARAM_SHIPMENT_DATE].SourceColumn = dataDef.FLD_SHIPMENT_DATE;
				sqlParams[PARAM_REQUESTED_DELIVERY_DATE].SourceColumn = dataDef.FLD_REQUESTED_DELIVERY_DATE;
                sqlParams[PARAM_REQUESTED_DELIVERY_TIME].SourceColumn = dataDef.FLD_REQUESTED_DELIVERY_TIME;
				sqlParams[PARAM_DELIVERY_NLT].SourceColumn = dataDef.FLD_DELIVERY_NLT;
				sqlParams[PARAM_SHIPPING_CHARGES].SourceColumn = dataDef.FLD_SHIPPING_CHARGES;
				sqlParams[PARAM_SHIPPING_EXPEDITED_FREIGHT_CHARGES_PAYMENT_ASSIGNMENT_TYPE_ID].SourceColumn = dataDef.FLD_SHIPPING_EXPEDITED_FREIGHT_CHARGES_PAYMENT_ASSIGNMENT_TYPE_ID;
				sqlParams[PARAM_SHIPMENT_SUPPLY_TO].SourceColumn = dataDef.FLD_SHIP_SUPPLY_TO;
				
				sqlParams[PARAM_DELETED].SourceColumn = dataDef.FLD_DELETED;				
				sqlParams[PARAM_UPDATE_USER_ID].SourceColumn = dataDef.FLD_UPDATE_USER_ID;				
				//Don't need to map ErrorCode cause is not imply in the insert
				//Only Mapped DataColumn are imply...
			}
            
			return updateCommand;
		}

		//----------------------------------------------------------------
		// Sub BuildUpdateCommand:
		//   Initialize the parameterized Update command for the DataAdapter
		//----------------------------------------------------------------
		protected override SqlCommand GetDeleteCommand()
		{
			if ( deleteCommand == null )
			{
				//
				// Construct the command since we don't have it already
				//
				deleteCommand = new SqlCommand(SQL_PROC_DELETE);
				deleteCommand.CommandType = CommandType.StoredProcedure;
				
				SqlParameterCollection sqlParams = deleteCommand.Parameters;
            
				sqlParams.Add(new SqlParameter(PARAM_PKID, SqlDbType.Int));
				sqlParams.Add(new SqlParameter(PARAM_UPDATE_USER_ID, SqlDbType.Int));
				//
				// Define the parameter mappings from the data tabl
				//
				sqlParams[PARAM_PKID].SourceColumn = dataDef.FLD_PKID;	
				sqlParams[PARAM_UPDATE_USER_ID].SourceColumn = dataDef.FLD_UPDATE_USER_ID;
				//Only Mapped DataColumn are imply...
			}
            
			return deleteCommand;
		}

		protected override string TableName
		{
			get{return dataDef.TBL_SHIPMENT_GROUP;}
		}
		
		//We create a new method when we want to the return type variable
		public new dataDef SelectOne(int ID)
		{
			dataDef Table = new dataDef();
			SqlCommand	cmdToExecute = new SqlCommand();
			cmdToExecute.CommandText = SQL_PROC_SELECT_ONE;
			cmdToExecute.CommandType = CommandType.StoredProcedure;
			
			cmdToExecute.Parameters.Add(new SqlParameter(PARAM_PKID, SqlDbType.Int, 4, ParameterDirection.Input, false, 10, 0, "", DataRowVersion.Proposed, ID));
			
			Select(cmdToExecute,Table);

			return Table;
				
		}

		/// <summary>
		/// Purpose: SelectAll method. This method will Select all rows from the table.
		/// </summary>
		/// <returns>DataTable object if succeeded, otherwise an Exception is thrown. </returns>
		/// <remarks>
		/// Properties set after a succesful call of this method: 
		/// <UL>
		///		 <LI>ErrorCode</LI>
		/// </UL>
		/// </remarks>
		public new dataDef SelectAll()
		{
			dataDef Table = new dataDef();

			SqlCommand	cmdToExecute = new SqlCommand();
			cmdToExecute.CommandText = SQL_PROC_SELECT_ALL;
			cmdToExecute.CommandType = CommandType.StoredProcedure;
			
					
			Select(cmdToExecute,Table);
			return  Table;
			
		}

		public dataDef SelectAllWfm_idLogic(string FMID)
		{
			dataDef Table = new dataDef();

			SqlCommand	cmdToExecute = new SqlCommand();
			cmdToExecute.CommandText = "dbo.pr_shipment_group_SelectAllWfm_idLogic";
			cmdToExecute.CommandType = CommandType.StoredProcedure;
			cmdToExecute.Parameters.Add(new SqlParameter("@sfm_id", SqlDbType.VarChar, 4, ParameterDirection.Input, false, 10, 0, "", DataRowVersion.Proposed, FMID));
			
					
			Select(cmdToExecute,Table);
			
			return  Table;
			
		}

		public dataDef SelectAll_Search(int SearchType, String Criteria, string FM_ID, int SourceID, int ProgramType, string SubdivisionCode, DateTime StartDate, DateTime EndDate)
		{
			dataDef Table = new dataDef();
//			SqlCommand	cmdToExecute = new SqlCommand();
//			cmdToExecute.CommandText = "dbo.pr_order_SelectAll_Search";
//			cmdToExecute.CommandType = CommandType.StoredProcedure;
//			cmdToExecute.Parameters.Add(new SqlParameter(PARAM_SEARCH_TYPE, SqlDbType.Int, 4, ParameterDirection.Input, false, 10, 0, "", DataRowVersion.Proposed, SearchType));
//			cmdToExecute.Parameters.Add(new SqlParameter(PARAM_SEARCH_CRITERIA, SqlDbType.VarChar, 100, ParameterDirection.Input, false, 10, 0, "", DataRowVersion.Proposed, Criteria));
//			
//			if (FM_ID.Length > 0)
//				cmdToExecute.Parameters.Add(new SqlParameter(PARAM_FM_ID, SqlDbType.VarChar, 4, ParameterDirection.Input, false, 10, 0, "", DataRowVersion.Proposed, FM_ID));
//			if(SourceID > 0)
//				cmdToExecute.Parameters.Add(new SqlParameter(PARAM_SOURCE_ID, SqlDbType.Int,4,ParameterDirection.Input,false,10,0,"",DataRowVersion.Proposed, SourceID));
//			if(ProgramType > 0)
//				cmdToExecute.Parameters.Add(new SqlParameter("iprogram_type_id", SqlDbType.Int,4,ParameterDirection.Input,false,10,0,"",DataRowVersion.Proposed, ProgramType));
//			if (SubdivisionCode.Length > 0)
//				cmdToExecute.Parameters.Add(new SqlParameter("@ssubdivision_code", SqlDbType.NVarChar, 7, ParameterDirection.Input, false, 10, 0, "", DataRowVersion.Proposed, SubdivisionCode));
//			
//			//Mandatory
//			cmdToExecute.Parameters.Add(new SqlParameter(PARAM_START_DATE, SqlDbType.DateTime, 8, ParameterDirection.Input, false, 10, 0, "", DataRowVersion.Proposed, StartDate));
//			cmdToExecute.Parameters.Add(new SqlParameter(PARAM_END_DATE, SqlDbType.DateTime, 8, ParameterDirection.Input, false, 10, 0, "", DataRowVersion.Proposed, EndDate));
//			
//			
//			
//			Select(cmdToExecute,Table);

			return Table;
		}

		

	
	}
}
