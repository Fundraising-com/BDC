///////////////////////////////////////////////////////////////////////////
// Description: Data Access class for the table 'warehouse'
// Generated by Jas on: Monday, November 03, 2003, 4:18:12 PM
// Because the Base Class already implements IDispose, this class doesn't.
///////////////////////////////////////////////////////////////////////////
using System;
using System.Data;
using System.Data.SqlTypes;
using System.Data.SqlClient;
using System.Runtime.InteropServices;
using dataDef = QSPForm.Common.DataDef.WarehouseTable;

namespace QSPForm.Data
{
	
	/// <summary>
	/// Purpose: Data Access class for the table 'warehouse'.
	/// </summary>
	
	public class Warehouse : DBTableOperation
	{
		
		//
		// Stored procedure parameter names
		// Paremater Name must match with the SP Called
		private const string PARAM_PKID      = "@iwarehouse_id";
		private const string PARAM_FULF_WAREHOUSE_ID = "@ifulf_warehouse_id";
		private const string PARAM_NAME		 = "@swarehouse_name";
		private const string PARAM_COMPANY_NAME		 = "@scompany_name";
		private const string PARAM_SHORT_DESCRIPTION	= "@sshort_description";
		private const string PARAM_POSTAL_ADDRESS_ID = "@ipostal_address_id";
		private const string PARAM_VENDOR_ID = "@ivendor_id";
		private const string PARAM_WAREHOUSE_STATUS_ID = "@iwarehouse_status_id";
		private const string PARAM_PHONE_NUMBER_ID = "@iphone_number_id";
		private const string PARAM_FAX_NUMBER_ID = "@ifax_number_id";
		private const string PARAM_RECEIVING_PHONE_NUMBER_ID = "@ireceiving_phone_number_id";
		private const string PARAM_EMAIL_ID = "@iemail_id";
		private const string PARAM_IS_VENDOR_WAREHOUSE = "@bis_vendor_warehouse";
        private const string PARAM_PICK_UP = "@bpick_up";
		//
		// Stored procedure names for each operation
		private const string SQL_PROC_INSERT       = "dbo.pr_warehouse_insert";
		private const string SQL_PROC_UPDATE       = "dbo.pr_warehouse_update";
		private const string SQL_PROC_DELETE       = "dbo.pr_warehouse_delete";
		private const string SQL_PROC_SELECT_ONE   = "dbo.pr_warehouse_SelectOne";
		private const string SQL_PROC_SELECT_ALL   = "dbo.pr_warehouse_SelectAll";

		//
		// DataSetCommand object
		//
		private SqlCommand insertCommand;
		private SqlCommand updateCommand;
		private SqlCommand deleteCommand;
		
		/// <summary>
		/// Purpose: Class constructor.
		/// </summary>
		public Warehouse()
		{
			//
			// Create the DataSetCommand
			//
			adapter = new SqlDataAdapter();        
			adapter.TableMappings.Add("Table", dataDef.TBL_WAREHOUSE);
		}
		protected override string TableName
		{
			get{return dataDef.TBL_WAREHOUSE;}
		}

		//----------------------------------------------------------------
		// Sub GetInsertCommand:
		//   Initialize the parameterized Insert command for the DataAdapter
		//----------------------------------------------------------------
		protected override SqlCommand GetInsertCommand()
		{
			if ( insertCommand == null )
			{
				//
				// Construct the command since we don't have it already
				// 
				insertCommand = new SqlCommand(SQL_PROC_INSERT);
				insertCommand.CommandType = CommandType.StoredProcedure;				
            
				SqlParameterCollection sqlParams = insertCommand.Parameters;
            
				sqlParams.Add(new SqlParameter(PARAM_PKID, SqlDbType.Int));
				sqlParams.Add(new SqlParameter(PARAM_FULF_WAREHOUSE_ID, SqlDbType.Int));
				sqlParams.Add(new SqlParameter(PARAM_NAME, SqlDbType.VarChar, 50));
				sqlParams.Add(new SqlParameter(PARAM_COMPANY_NAME, SqlDbType.VarChar, 100));
				sqlParams.Add(new SqlParameter(PARAM_SHORT_DESCRIPTION, SqlDbType.VarChar, 100));
				sqlParams.Add(new SqlParameter(PARAM_POSTAL_ADDRESS_ID, SqlDbType.Int));
				sqlParams.Add(new SqlParameter(PARAM_VENDOR_ID, SqlDbType.Int));
				sqlParams.Add(new SqlParameter(PARAM_WAREHOUSE_STATUS_ID, SqlDbType.Int));
				sqlParams.Add(new SqlParameter(PARAM_PHONE_NUMBER_ID, SqlDbType.Int));
				sqlParams.Add(new SqlParameter(PARAM_FAX_NUMBER_ID, SqlDbType.Int));
				sqlParams.Add(new SqlParameter(PARAM_RECEIVING_PHONE_NUMBER_ID, SqlDbType.Int));
				sqlParams.Add(new SqlParameter(PARAM_EMAIL_ID, SqlDbType.Int));
				sqlParams.Add(new SqlParameter(PARAM_IS_VENDOR_WAREHOUSE, SqlDbType.Bit));
                sqlParams.Add(new SqlParameter(PARAM_PICK_UP, SqlDbType.Bit));

				sqlParams.Add(new SqlParameter(PARAM_CREATE_USER_ID, SqlDbType.Int));
				
				sqlParams[PARAM_PKID].Direction = ParameterDirection.Output;
				//
				// Define the parameter mappings from the data table in the
				// dataset.
				//
				sqlParams[PARAM_PKID].SourceColumn = dataDef.FLD_PKID;
				sqlParams[PARAM_FULF_WAREHOUSE_ID].SourceColumn = dataDef.FLD_FULF_WAREHOUSE_ID;
				sqlParams[PARAM_NAME].SourceColumn = dataDef.FLD_NAME;
				sqlParams[PARAM_COMPANY_NAME].SourceColumn = dataDef.FLD_COMPANY_NAME;
				sqlParams[PARAM_SHORT_DESCRIPTION].SourceColumn = dataDef.FLD_SHORT_DESCRIPTION;
				sqlParams[PARAM_POSTAL_ADDRESS_ID].SourceColumn = dataDef.FLD_POSTAL_ADDRESS_ID;
				sqlParams[PARAM_VENDOR_ID].SourceColumn = dataDef.FLD_VENDOR_ID;
				sqlParams[PARAM_WAREHOUSE_STATUS_ID].SourceColumn = dataDef.FLD_WAREHOUSE_STATUS_ID;
				sqlParams[PARAM_PHONE_NUMBER_ID].SourceColumn = dataDef.FLD_PHONE_NUMBER_ID;
				sqlParams[PARAM_FAX_NUMBER_ID].SourceColumn = dataDef.FLD_FAX_NUMBER_ID;
				sqlParams[PARAM_RECEIVING_PHONE_NUMBER_ID].SourceColumn = dataDef.FLD_RECEIVING_PHONE_NUMBER_ID;
				sqlParams[PARAM_EMAIL_ID].SourceColumn = dataDef.FLD_EMAIL_ID;
				sqlParams[PARAM_IS_VENDOR_WAREHOUSE].SourceColumn = dataDef.FLD_IS_VENDOR_WAREHOUSE;
                sqlParams[PARAM_PICK_UP].SourceColumn = dataDef.FLD_PICK_UP;

				sqlParams[PARAM_CREATE_USER_ID].SourceColumn = dataDef.FLD_CREATE_USER_ID;

				//Don't need to map ErrorCode cause is not imply in the insert
				//Only Mapped DataColumn are imply...
				
			}
            
			return insertCommand;
		}

		//----------------------------------------------------------------
		// Sub BuildUpdateCommand:
		//   Initialize the parameterized Update command for the DataAdapter
		//----------------------------------------------------------------
		protected override SqlCommand GetUpdateCommand()
		{
			if ( updateCommand == null )
			{
				//
				// Construct the command since we don't have it already
				//
				updateCommand = new SqlCommand(SQL_PROC_UPDATE);
				updateCommand.CommandType = CommandType.StoredProcedure;				
            
				SqlParameterCollection sqlParams = updateCommand.Parameters;
            
				sqlParams.Add(new SqlParameter(PARAM_PKID, SqlDbType.Int));
				sqlParams.Add(new SqlParameter(PARAM_FULF_WAREHOUSE_ID, SqlDbType.Int));
				sqlParams.Add(new SqlParameter(PARAM_NAME, SqlDbType.VarChar, 50));
				sqlParams.Add(new SqlParameter(PARAM_COMPANY_NAME, SqlDbType.VarChar, 100));
				sqlParams.Add(new SqlParameter(PARAM_SHORT_DESCRIPTION, SqlDbType.VarChar, 100));
				sqlParams.Add(new SqlParameter(PARAM_POSTAL_ADDRESS_ID, SqlDbType.Int));
				sqlParams.Add(new SqlParameter(PARAM_VENDOR_ID, SqlDbType.Int));
				sqlParams.Add(new SqlParameter(PARAM_WAREHOUSE_STATUS_ID, SqlDbType.Int));
				sqlParams.Add(new SqlParameter(PARAM_PHONE_NUMBER_ID, SqlDbType.Int));
				sqlParams.Add(new SqlParameter(PARAM_FAX_NUMBER_ID, SqlDbType.Int));
				sqlParams.Add(new SqlParameter(PARAM_RECEIVING_PHONE_NUMBER_ID, SqlDbType.Int));
				sqlParams.Add(new SqlParameter(PARAM_EMAIL_ID, SqlDbType.Int));
				sqlParams.Add(new SqlParameter(PARAM_IS_VENDOR_WAREHOUSE, SqlDbType.Bit));
                sqlParams.Add(new SqlParameter(PARAM_PICK_UP, SqlDbType.Bit));

				sqlParams.Add(new SqlParameter(PARAM_DELETED, SqlDbType.Bit));
				sqlParams.Add(new SqlParameter(PARAM_UPDATE_USER_ID, SqlDbType.Int));

				//
				// Define the parameter mappings from the data table in the
				// dataset.
				//
				sqlParams[PARAM_PKID].SourceColumn = dataDef.FLD_PKID;
				sqlParams[PARAM_FULF_WAREHOUSE_ID].SourceColumn = dataDef.FLD_FULF_WAREHOUSE_ID;
				sqlParams[PARAM_NAME].SourceColumn = dataDef.FLD_NAME;
				sqlParams[PARAM_COMPANY_NAME].SourceColumn = dataDef.FLD_COMPANY_NAME;
				sqlParams[PARAM_SHORT_DESCRIPTION].SourceColumn = dataDef.FLD_SHORT_DESCRIPTION;
				sqlParams[PARAM_POSTAL_ADDRESS_ID].SourceColumn = dataDef.FLD_POSTAL_ADDRESS_ID;
				sqlParams[PARAM_VENDOR_ID].SourceColumn = dataDef.FLD_VENDOR_ID;
				sqlParams[PARAM_WAREHOUSE_STATUS_ID].SourceColumn = dataDef.FLD_WAREHOUSE_STATUS_ID;
				sqlParams[PARAM_PHONE_NUMBER_ID].SourceColumn = dataDef.FLD_PHONE_NUMBER_ID;
				sqlParams[PARAM_FAX_NUMBER_ID].SourceColumn = dataDef.FLD_FAX_NUMBER_ID;
				sqlParams[PARAM_RECEIVING_PHONE_NUMBER_ID].SourceColumn = dataDef.FLD_RECEIVING_PHONE_NUMBER_ID;
				sqlParams[PARAM_EMAIL_ID].SourceColumn = dataDef.FLD_EMAIL_ID;
				sqlParams[PARAM_IS_VENDOR_WAREHOUSE].SourceColumn = dataDef.FLD_IS_VENDOR_WAREHOUSE;
                sqlParams[PARAM_PICK_UP].SourceColumn = dataDef.FLD_PICK_UP;

				sqlParams[PARAM_DELETED].SourceColumn = dataDef.FLD_DELETED;
				sqlParams[PARAM_UPDATE_USER_ID].SourceColumn = dataDef.FLD_UPDATE_USER_ID;
				

				//Don't need to map ErrorCode cause is not imply in the insert
				//Only Mapped DataColumn are imply...
			}
            
			return updateCommand;
		}

		//----------------------------------------------------------------
		// Sub BuildUpdateCommand:
		//   Initialize the parameterized Update command for the DataAdapter
		//----------------------------------------------------------------
		protected override SqlCommand GetDeleteCommand()
		{
			if ( deleteCommand == null )
			{
				//
				// Construct the command since we don't have it already
				//
				deleteCommand = new SqlCommand(SQL_PROC_DELETE);
				deleteCommand.CommandType = CommandType.StoredProcedure;				
            
				SqlParameterCollection sqlParams = deleteCommand.Parameters;
            
				sqlParams.Add(new SqlParameter(PARAM_PKID, SqlDbType.Int));
				sqlParams.Add(new SqlParameter(PARAM_UPDATE_USER_ID, SqlDbType.Int));
				//
				// Define the parameter mappings from the data tabl
				//
				sqlParams[PARAM_PKID].SourceColumn = dataDef.FLD_PKID;
				sqlParams[PARAM_UPDATE_USER_ID].SourceColumn = dataDef.FLD_UPDATE_USER_ID;
					//Only Mapped DataColumn are imply...
			}
            
			return deleteCommand;
		}
		
		public new dataDef SelectOne(int ID)
		{
			SqlCommand	cmdToExecute = new SqlCommand();
			cmdToExecute.CommandText = SQL_PROC_SELECT_ONE;
			cmdToExecute.CommandType = CommandType.StoredProcedure;			
			
			dataDef warehouse = new dataDef();

			cmdToExecute.Parameters.Add(new SqlParameter(PARAM_PKID, SqlDbType.Int, 4, ParameterDirection.Input, false, 10, 0, "", DataRowVersion.Proposed, ID));
			
			
			Select(cmdToExecute, warehouse);

			return warehouse;
		}

        public new dataDef SelectOneByFulfID(int FulfID)
        {
            SqlCommand cmdToExecute = new SqlCommand();
            cmdToExecute.CommandText = "dbo.pr_warehouse_SelectOneByFulfID";
            cmdToExecute.CommandType = CommandType.StoredProcedure;

            dataDef warehouse = new dataDef();

            cmdToExecute.Parameters.Add(new SqlParameter(PARAM_FULF_WAREHOUSE_ID, SqlDbType.Int, 4, ParameterDirection.Input, false, 10, 0, "", DataRowVersion.Proposed, FulfID));
            
            Select(cmdToExecute, warehouse);

            return warehouse;
        }

		public dataDef SelectAllWfulf_warehouse_idLogic(int FulfWarehouseID)
		{
			SqlCommand	cmdToExecute = new SqlCommand();
			cmdToExecute.CommandText = "dbo.pr_warehouse_SelectAllWfulf_warehouse_idLogic";
			cmdToExecute.CommandType = CommandType.StoredProcedure;			
			
			dataDef warehouse = new dataDef();

			cmdToExecute.Parameters.Add(new SqlParameter(PARAM_FULF_WAREHOUSE_ID, SqlDbType.Int, 4, ParameterDirection.Input, false, 10, 0, "", DataRowVersion.Proposed, FulfWarehouseID));
			
			
			Select(cmdToExecute, warehouse);

			return warehouse;
		}
		

		/// <summary>
		/// Purpose: SelectAll method. This method will Select all rows from the table.
		/// </summary>
		/// <returns>DataTable object if succeeded, otherwise an Exception is thrown. </returns>
		/// <remarks>
		/// Properties set after a succesful call of this method: 
		/// <UL>
		///		 <LI>ErrorCode</LI>
		/// </UL>
		/// </remarks>
		public new dataDef SelectAll()
		{
			dataDef Table = new dataDef();
			SqlCommand	cmdToExecute = new SqlCommand();
			cmdToExecute.CommandText = SQL_PROC_SELECT_ALL;
			cmdToExecute.CommandType = CommandType.StoredProcedure;
				
			Select(cmdToExecute,Table);
			return Table;		
		}
		
		/// <summary>
		/// Purpose: Select method. This method will Select one existing row from the database, based on the WarehouseName.
		/// </summary>
		/// <returns>dataDef (DataSet) object if succeeded, otherwise an Exception is thrown. </returns>
		/// <remarks>
		/// Properties needed for this method: 
		/// <UL>
		///		 <LI>Warehouse_Name</LI>
		/// </UL>
		/// </remarks>
		public dataDef SelectAllWwarehouse_nameLogic(String warehouseName)
		{
			dataDef Table = new dataDef();
			SqlCommand	cmdToExecute = new SqlCommand();
			cmdToExecute.CommandText = "dbo.[pr_warehouse_SelectAllWwarehouse_nameLogic]";
			cmdToExecute.CommandType = CommandType.StoredProcedure;
			
			cmdToExecute.Parameters.Add(new SqlParameter(PARAM_NAME, SqlDbType.VarChar, 50, ParameterDirection.Input, false, 0, 0, "", DataRowVersion.Proposed, warehouseName));
			
			Select(cmdToExecute,Table);
			return Table;
		}

		public dataDef SelectAll_Search(int SearchType, string Criteria, string SubdivisionCode)
		{
			dataDef Table = new dataDef();
			SqlCommand	cmdToExecute = new SqlCommand();
			cmdToExecute.CommandText = "dbo.pr_warehouse_SelectAll_Search";
			cmdToExecute.CommandType = CommandType.StoredProcedure;
			
			cmdToExecute.Parameters.Add(new SqlParameter(PARAM_SEARCH_TYPE, SqlDbType.Int, 4, ParameterDirection.Input, false, 10, 0, "", DataRowVersion.Proposed, SearchType));
			cmdToExecute.Parameters.Add(new SqlParameter(PARAM_SEARCH_CRITERIA, SqlDbType.VarChar, 100, ParameterDirection.Input, false, 10, 0, "", DataRowVersion.Proposed, Criteria));
			if (SubdivisionCode.Length > 0)
			cmdToExecute.Parameters.Add(new SqlParameter("@ssubdivision_code", SqlDbType.NVarChar, 7, ParameterDirection.Input, false, 10, 0, "", DataRowVersion.Proposed, SubdivisionCode));
			
			Select(cmdToExecute,Table);

			return Table;
		}

        public dataDef SelectAll_Search(int SearchType, string Criteria, string SubdivisionCode, bool PickUp)
        {
            dataDef Table = new dataDef();
            SqlCommand cmdToExecute = new SqlCommand();
            cmdToExecute.CommandText = "dbo.pr_warehouse_SelectAll_Search";
            cmdToExecute.CommandType = CommandType.StoredProcedure;

            cmdToExecute.Parameters.Add(new SqlParameter(PARAM_SEARCH_TYPE, SqlDbType.Int, 4, ParameterDirection.Input, false, 10, 0, "", DataRowVersion.Proposed, SearchType));
            cmdToExecute.Parameters.Add(new SqlParameter(PARAM_SEARCH_CRITERIA, SqlDbType.VarChar, 100, ParameterDirection.Input, false, 10, 0, "", DataRowVersion.Proposed, Criteria));
            if (SubdivisionCode.Length > 0)
                cmdToExecute.Parameters.Add(new SqlParameter("@ssubdivision_code", SqlDbType.NVarChar, 7, ParameterDirection.Input, false, 10, 0, "", DataRowVersion.Proposed, SubdivisionCode));
            cmdToExecute.Parameters.Add(new SqlParameter(PARAM_PICK_UP, SqlDbType.Bit, 4, ParameterDirection.Input, false, 10, 0, "", DataRowVersion.Proposed, PickUp));
            
            Select(cmdToExecute, Table);

            return Table;
        }
		public DataTable SelectInventory(int WarehouseID)
		{
			DataTable Table = new DataTable();
			SqlCommand	cmdToExecute = new SqlCommand();
			cmdToExecute.CommandText = "dbo.pr_warehouse_SelectInventory";
			cmdToExecute.CommandType = CommandType.StoredProcedure;				
			cmdToExecute.Parameters.Add(new SqlParameter("@iWarehouseID", SqlDbType.Int, 4, ParameterDirection.Input, false, 10, 0, "", DataRowVersion.Proposed, WarehouseID));	
			Select(cmdToExecute,Table);
			return Table;
		}
	}
}
