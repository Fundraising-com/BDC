////////////////////////////////////////////////////////////
// This software is solely the property of Karamasoft LLC. /
//   Copyright 2007 Karamasoft LLC. All rights reserved.   /
//                  www.karamasoft.com                     /
////////////////////////////////////////////////////////////

function ConvertText(s) { return String(s).replace(/\&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); } function ConvertAttribute(s) { return ConvertText(String(s).replace(/\"/g,'&quot;')); } function ConvertComments(s) { s=s.replace(/--/g,'-- '); if (s.substring(s.length-1) == '-') { s += ' '; } return '<!--'+s+'-->'; } function uxa0(nodeElem) { var s=''; var subNodes=nodeElem.childNodes; for (var i=0,lenSubNodes=subNodes.length; i < lenSubNodes; i++) { var subNode=subNodes[i]; var subNodeTagName=String(subNode.tagName).toLowerCase(); switch (subNode.nodeType) { case 1: { if (subNodeTagName != '') { var subNodeAttributes=subNode.attributes; var subNodeAttributeName; var subNodeAttributeVal; var subNodeImg=(subNodeTagName == 'img'); var ue6pDefined=false; var imgAltDefined=false; if (subNodeTagName == 'html') { s='<?xml version="1.0" encoding="iso-8859-1"?>\n<!DOCTYPE html PUBLIC "-/'+'/W3C/'+'/DTD XHTML 1.0 Transitional/'+'/EN" "http:/'+'/www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">\n'; } s += '<'+subNodeTagName; for (var j=0,lenSubNodeAttributes=subNodeAttributes.length; j < lenSubNodeAttributes; j++) { subNodeAttributeName=subNodeAttributes[j].nodeName.toLowerCase();  if (subNodeAttributes[j].specified || subNodeAttributeName == 'value') { switch (subNodeAttributeName) { case 'style': subNodeAttributeVal=subNode.style.cssText; break; case 'class': subNodeAttributeVal=subNode.className; break; case 'http-equiv': subNodeAttributeVal=subNode.httpEquiv; break;  case 'compact': case 'nowrap': case 'ismap': case 'declare': case 'noshade': case 'checked': case 'disabled': case 'readonly': case 'multiple': case 'selected': case 'noresize': case 'defer': subNodeAttributeVal=subNodeAttributeName; break; default: subNodeAttributeVal=subNodeAttributes[j].nodeValue; }  if (subNodeImg && !ue6pDefined && subNodeAttributeName == 'src') ue6pDefined=true; if (subNodeImg && !imgAltDefined && subNodeAttributeName == 'alt') imgAltDefined=true;  s += ' '+subNodeAttributeName+'="'+ConvertAttribute(subNodeAttributeVal)+'"'; } } if (subNodeImg) { if (!ue6pDefined) { s += ' src=""'; } if (!imgAltDefined) { s += ' alt=""'; } } if (subNodeTagName == 'script' || subNodeTagName == 'style' || subNodeTagName == 'title') { if (subNodeTagName == 'script') { if (subNode.type == '') { s += ' type="text/javascript"'; } } else if (subNodeTagName == 'style') { if (subNode.type == '') { s += ' type="text/css"'; } } s += '>'+subNode.innerHTML+'</'+subNodeTagName+'>'; } else if (subNodeTagName == 'base') { s += ' />'; } else if (subNode.canHaveChildren || subNode.hasChildNodes()) { s += '>'+uxa0(subNode)+'</'+subNodeTagName+'>'; } else { s += ' />'; } } break; } case 3: {  s += (subNodeTagName != 'pre') ? ConvertText(subNode.nodeValue) : subNode.nodeValue; break; } case 8: { s += ConvertComments(subNode.nodeValue); break; } default: break; } } return s; } function uxa1(s) { return s.replace(/ \/>/g,'>'); } if (typeof(Sys) != 'undefined' && typeof(Sys.Application) != 'undefined') { Sys.Application.notifyScriptLoaded(); } 