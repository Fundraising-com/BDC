<?xml version="1.0"?>
<SQLStatements Completed="0" Version="SF6803toSF700">
  <SQLServer><![CDATA[ALTER TABLE OrderItems ALTER COLUMN itemTotal nvarchar(50)]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Admin ADD SearchOnFields nvarchar(255) NULL]]></SQLServer>
  <SQLServer><![CDATA[UPDATE Admin SET SearchOnFields='Code,Name,NamePlural,ShortDescription,keywords' WHERE SearchOnFields IS NULL ]]></SQLServer>
  <SQLServer><![CDATA[UPDATE QBTemplates SET Description='Gift&nbsp;Wrap', Active=1, Skip=0, ColumnVisible=1 WHERE PageName='Invoice' AND Sequence='005']]></SQLServer>
  <SQLServer><![CDATA[sp_rename 'SearchResults.Rows', 'NumOfRows', 'COLUMN']]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE OrderAddresses ADD CODAmount nvarchar(20) NULL]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE OrderItems ALTER COLUMN Category ntext]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Admin ALTER COLUMN NextOrderNumber numeric(10, 0)]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE ProcessorResponse ALTER COLUMN OrderID numeric(10, 0)]]></SQLServer>
  <SQLServer><![CDATA[sp_rename 'QBSettings.Memo', 'QBMemo', 'COLUMN' ]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE OrderItems ALTER COLUMN ProductName nvarchar(255)]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Categories ALTER COLUMN Name nvarchar(255)]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE AffiliateSettings ALTER COLUMN Terms ntext]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Admin DROP COLUMN DomainName]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Admin ADD WebLicense ntext NULL]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Attributes ALTER COLUMN Name nvarchar(200)]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE AttributeDetail ALTER COLUMN Name nvarchar(200)]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE AttributeDetail ALTER COLUMN FileLocation nvarchar(255)]]></SQLServer>
  <SQLServer><![CDATA[INSERT INTO [QBConversion] ([PageName], [Sequence], [WebID], [QuickBooksID], [QBAccount]) VALUES( 'Shipping', '060', 'DEFAULT2', 'UPS', 'UPS')]]></SQLServer>
  <SQLServer><![CDATA[UPDATE qbconversion 
SET qbaccount=(SELECT qbaccount FROM qbconversion WHERE WebID='DEFAULT' AND PageName='Shipping'),
[Sequence]=(select [Sequence] from qbconversion WHERE WebID='DEFAULT' AND PageName='Shipping'),
QuickBooksID=(select QuickBooksID from QBConversion WHERE WebID='DEFAULT' AND PageName='Shipping') 
WHERE WebID='DEFAULT2']]></SQLServer>
  <SQLServer><![CDATA[DELETE FROM QBConversion WHERE WebID='DEFAULT' AND PageName='Shipping']]></SQLServer>
  <SQLServer><![CDATA[UPDATE QBConversion SET WebID='DEFAULT' WHERE PageName='Shipping' AND WebID='DEFAULT2']]></SQLServer>
  <SQLServer><![CDATA[UPDATE Admin SET WebLicense='69 159 139 247 59 253 137 38 201 207 84 123 242 56 225 142 9 212 178 27 214 8 202 233 236 227 68 44 7 104 142 36 142 235 253 86 137 247 168 1' WHERE WebLicense IS NULL OR WebLicense='']]></SQLServer>
  <SQLServer><![CDATA[UPDATE PaymentProcessors SET LiveServerPath='https://cart.bamart.com/soap/listener.mart' WHERE NAME='BankOfAmerica']]></SQLServer>
  <SQLServer><![CDATA[UPDATE PaymentProcessors SET LiveServerPath='secure.linkpt.net' WHERE NAME='LinkPoint']]></SQLServer>
  <SQLServer><![CDATA[UPDATE PaymentProcessors SET LiveServerPath='secure.psigate.com' WHERE NAME='PsiGate']]></SQLServer>
  <SQLServer><![CDATA[UPDATE PaymentProcessors SET LiveServerPath='https://www.securepay.com/secure1/index.asp' WHERE NAME='SecurePay']]></SQLServer>
  <SQLServer><![CDATA[UPDATE PaymentProcessors SET LiveServerPath='payflow.verisign.com' WHERE NAME='Verisign']]></SQLServer>
  <SQLServer><![CDATA[UPDATE PaymentProcessors SET LiveServerPath='https://secure.authorize.net/gateway/transact.dll' WHERE NAME='AuthorizeNet']]></SQLServer>
  <SQLServer><![CDATA[UPDATE PaymentProcessors SET LiveServerPath='https://www.paypal.com/cgi-bin/webscr' WHERE NAME='PayPal']]></SQLServer>
  <SQLServer><![CDATA[UPDATE PaymentProcessors SET LiveServerPath='https://select.worldpay.com/wcc/purchase'  WHERE NAME='WorldPay']]></SQLServer>
  <SQLServer><![CDATA[UPDATE PaymentProcessors SET LiveServerPath='https://secure2.epdq.co.uk/cgi-bin/CcxBarclaysEpdqEncTool.e|https://secure2.epdq.co.uk/cgi-bin/CcxBarclaysEpdq.e'  WHERE NAME='Barclay']]></SQLServer>
  <SQLServer><![CDATA[UPDATE PaymentProcessors SET LiveServerPath='https://secure.authorize.net/gateway/transact.dll'  WHERE NAME='QuickCommerce']]></SQLServer>
  <SQLServer><![CDATA[UPDATE PaymentProcessors SET LiveServerPath='https://secure.authorize.net/gateway/transact.dll'  WHERE NAME='PlanetPayment']]></SQLServer>
  <SQLServer><![CDATA[UPDATE PaymentProcessors SET LiveServerPath='https://secure.authorize.net/gateway/transact.dll'  WHERE NAME='SecureSource']]></SQLServer>
  <SQLServer><![CDATA[UPDATE QBTemplates SET Description='Gift Certificates', ColumnVisible=1 WHERE PageName='Invoice' and Sequence=22]]></SQLServer>
  <SQLServer><![CDATA[UPDATE QBTemplates SET Description='Gift Certificates', ColumnVisible=1 WHERE PageName='Receipt' and Sequence=23]]></SQLServer>
  <SQLServer><![CDATA[INSERT INTO [QBAccounts] ([AccountName], [Description], [Item]) VALUES('Order Discounts', 'Gift Certificates', 'GiftCertificate')]]></SQLServer>
  <SQLServer><![CDATA[DELETE FROM QBAccounts WHERE  (uid > 12)]]></SQLServer>
  <SQLServer><![CDATA[
IF NOT EXISTS(SELECT * FROM Messages WHERE Page='addgiftcertificates.ascx' AND Action = 'Error' AND Condition = 'Duplicate')
	INSERT INTO [Messages] ([Page], [Action], [Condition], [Message]) VALUES('addgiftcertificates.ascx', 'Error', 'Duplicate', 'This Gift Certificate Code is all ready in use')
]]></SQLServer>
  <SQLServer><![CDATA[DELETE FROM Messages WHERE Page='addcategory' AND Action='Error' AND Condition='Duplicate']]></SQLServer>
  <SQLServer><![CDATA[
IF NOT EXISTS(SELECT * FROM Messages WHERE Page='addcategory' AND Action = 'Error' AND Condition = 'Duplicate')
	INSERT INTO [Messages] ([Page], [Action], [Condition], [Message]) VALUES ('addcategory', 'Error', 'Duplicate', 'A root category with this name already exists.')
]]></SQLServer>
  <SQLServer><![CDATA[CREATE INDEX IX_MANUFACTURERID on Products(ManufacturerId)]]></SQLServer>
  <SQLServer><![CDATA[CREATE INDEX IX_VENDORID on Products(VendorId)]]></SQLServer>
  <SQLServer><![CDATA[CREATE INDEX IX_CODE on Products(Code)]]></SQLServer>
  <SQLServer><![CDATA[CREATE INDEX IX_ISACTIVE on Products(IsActive)]]></SQLServer>
  <SQLServer><![CDATA[CREATE INDEX IX_NAME on Products(Name)]]></SQLServer>
  <SQLServer><![CDATA[CREATE INDEX IX_PRODUCTID on ProductCategory(ProductID)]]></SQLServer>
  <SQLServer><![CDATA[CREATE INDEX IX_CATEGORYID on ProductCategory(CategoryID)]]></SQLServer>
  <SQLServer><![CDATA[CREATE INDEX IX_PRODUCTID on Inventory(ProductID)]]></SQLServer>
  <SQLServer><![CDATA[CREATE INDEX IX_ATTRIBUTEDETAILID on Inventory(AttributeDetailID)]]></SQLServer>
  <SQLServer><![CDATA[CREATE INDEX IX_PRODID on InventoryInfo(ProdID)]]></SQLServer>
  <SQLServer><![CDATA[CREATE INDEX IX_PRODUCTID on Giftwrap(ProductID)]]></SQLServer>
  <SQLServer><![CDATA[CREATE INDEX IX_PRODUCTID on VolumePricing(ProductID)]]></SQLServer>
  <SQLServer><![CDATA[CREATE INDEX IX_ADDRESSID on Manufacturers(AddressID)]]></SQLServer>
  <SQLServer><![CDATA[CREATE INDEX IX_ADDRESSID on Vendors(AddressID)]]></SQLServer>
  <SQLServer><![CDATA[CREATE INDEX IX_PRODUCTID on Attributes(ProductID)]]></SQLServer>
  <SQLServer><![CDATA[CREATE INDEX IX_PARENTID on RelatedProducts(ParentID)]]></SQLServer>
  <SQLServer><![CDATA[CREATE INDEX IX_RELATEDID on RelatedProducts(RelatedID)]]></SQLServer>
  <SQLServer><![CDATA[CREATE INDEX IX_PRODUCTID on CustomerSpecificPricing(ProductID)]]></SQLServer>
  <SQLServer><![CDATA[CREATE INDEX IX_GROUPID on CustomerSpecificPricing(GroupID)]]></SQLServer>
  <SQLServer><![CDATA[CREATE INDEX IX_CUSTGROUPID on Customers(CustGroupID)]]></SQLServer>
  <SQLServer><![CDATA[CREATE INDEX IX_CUSTOMERID on Addresses(CustomerID)]]></SQLServer>
  <SQLServer><![CDATA[CREATE INDEX IX_ATTRIBUTEID on AttributeDetail(AttributeID)]]></SQLServer>
  <SQLServer><![CDATA[CREATE INDEX IX_ORDERID on OrderAddresses(OrderID)]]></SQLServer>
  <SQLServer><![CDATA[CREATE INDEX IX_CUSTOMERID on Orders(CustomerID)]]></SQLServer>
  <SQLServer><![CDATA[CREATE INDEX IX_ISACTIVE on Categories(IsActive)]]></SQLServer>
  <SQLServer><![CDATA[CREATE INDEX IX_PARENTLEVEL on Categories(ParentLevel)]]></SQLServer>
  <SQLServer><![CDATA[CREATE INDEX IX_PARENTID on Categories(ParentID)]]></SQLServer>
  <SQLServer><![CDATA[CREATE INDEX IX_NAME on Categories(Name)]]></SQLServer>
  <SQLServer><![CDATA[CREATE INDEX IX_NAME on Attributes(Name)]]></SQLServer>
  <SQLServer><![CDATA[CREATE INDEX IX_CODE on PRODUCTS(Code)]]></SQLServer>
  <SQLServer><![CDATA[CREATE INDEX IX_ISACTIVE on PRODUCTS(IsActive)]]></SQLServer>
  <SQLServer><![CDATA[CREATE INDEX IX_NAME on PRODUCTS(Name)]]></SQLServer>
  <SQLServer><![CDATA[CREATE INDEX IX_NAMEPLURAL on PRODUCTS(NamePlural)]]></SQLServer>
  <SQLServer><![CDATA[CREATE INDEX IX_SHORTDESCRIPTION on PRODUCTS(ShortDescription)]]></SQLServer>
  <SQLServer><![CDATA[CREATE INDEX IX_DESCRIPTION on PRODUCTS(Description)]]></SQLServer>
  <SQLServer><![CDATA[CREATE INDEX IX_KEYWORDS on PRODUCTS(Keywords)]]></SQLServer>
  <SQLServer><![CDATA[DELETE FROM Messages WHERE [Page]='editcoupon' AND [Action]='Error' AND [Condition]='BlankProductID']]></SQLServer>
  <SQLServer><![CDATA[DELETE FROM Messages WHERE [Page]='editcoupon' AND [Action]='Error' AND [Condition]='BlankProductID']]></SQLServer>
  <SQLServer><![CDATA[DELETE FROM Messages WHERE [Page]='editcoupon' AND [Action]='Error' AND [Condition]='BlankVendorID']]></SQLServer>
  <SQLServer><![CDATA[DELETE FROM Messages WHERE [Page]='editcoupon' AND [Action]='Error' AND [Condition]='BlankManufacturerID']]></SQLServer>
  <SQLServer><![CDATA[INSERT INTO [Messages] ([Page], [Action], [Condition], [Message]) values('editcoupon', 'Error', 'BlankProductID', 'Must select a Product')]]></SQLServer>
  <SQLServer><![CDATA[INSERT INTO [Messages] ([Page], [Action], [Condition], [Message]) values('editcoupon', 'Error', 'BlankCategoryID', 'Must select a Category')]]></SQLServer>
  <SQLServer><![CDATA[INSERT INTO [Messages] ([Page], [Action], [Condition], [Message]) values('editcoupon', 'Error', 'BlankVendorID', 'Must select a Vendor')]]></SQLServer>
  <SQLServer><![CDATA[INSERT INTO [Messages] ([Page], [Action], [Condition], [Message]) values('editcoupon', 'Error', 'BlankManufacturerID', 'Must select a Manufacturer')]]></SQLServer>
  <SQLServer><![CDATA[DELETE FROM Messages WHERE ([Page]='EmailaFriend.aspx') AND ([Action]='PageTitle') AND ([Condition]='Title')]]></SQLServer>
  <SQLServer><![CDATA[INSERT INTO [Messages]  ([Page], [Action], [Condition], [Message]) VALUES ('EmailaFriend.aspx', 'PageTitle', 'Title', 'E-Mail a Friend')]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Customers ALTER COLUMN HTTPReferrer nvarchar(255)]]></SQLServer>
  <SQLServer><![CDATA[
IF NOT EXISTS(SELECT * FROM Instructions WHERE PageName = 'Confirm.aspx(PF)')
	INSERT INTO [Instructions] ([PageName], [Instruction]) VALUES ('Confirm.aspx(PF)', 'Thank you for your order! Print the order summary below and submit it by phone, mail or fax it to complete the order process.')
]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Affiliates ALTER COLUMN HomePage nvarchar(100)]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Affiliates ALTER COLUMN Email nvarchar(100)]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE AttributeDetail ALTER COLUMN Name nvarchar(255)]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Inventory ALTER COLUMN AttributeName nvarchar(255)]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE OrderItemsAttributes ALTER COLUMN AttributeName nvarchar(255)]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE OrderItemsAttributes ALTER COLUMN AttributeDetailName nvarchar(255)]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE ProcessorResponse ALTER COLUMN CustTransNo nvarchar(255)]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE ProcessorResponse ALTER COLUMN ActionCode nvarchar(255)]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE ProcessorResponse ALTER COLUMN RetrievalCode nvarchar(255)]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE ProcessorResponse ALTER COLUMN AuthorizationNo nvarchar(255)]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE ProcessorResponse ALTER COLUMN CVVResult nvarchar(255)]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE ProcessorResponse ALTER COLUMN ErrorLocation nvarchar(255)]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE ProcessorResponse ALTER COLUMN AVSResult nvarchar(255)]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE ProcessorResponse ALTER COLUMN MerchantTransNo nvarchar(255)]]></SQLServer>
  <SQLServer><![CDATA[DELETE FROM Messages WHERE Page='ParaData' and Action= 'Error']]></SQLServer>
  <SQLServer><![CDATA[INSERT INTO [Messages] ([Page], [Action], [Condition], [Message]) values('ParaData', 'Error', '2', 'A required field is missing.  Please enter data in all required fields and submit the order again.  If the problem persists, contact the site administrator.')]]></SQLServer>
  <SQLServer><![CDATA[INSERT INTO [Messages] ([Page], [Action], [Condition], [Message]) values('ParaData', 'Error', '3', 'A required field was given an invalid value in the request.  Please re-enter a valid value in the required fields and try to submit the order again.  If the problem persists, contact the site administrator.')]]></SQLServer>
  <SQLServer><![CDATA[INSERT INTO [Messages] ([Page], [Action], [Condition], [Message]) values('ParaData', 'Error', '4', 'The transaction you attempted is not allowed.  Please contact the site administrator to report the issue.')]]></SQLServer>
  <SQLServer><![CDATA[INSERT INTO [Messages] ([Page], [Action], [Condition], [Message]) values('ParaData', 'Error', '5', 'The transaction server could not process the transaction.  Please submit the order again.  If the problem persists, contact the site administrator.')]]></SQLServer>
  <SQLServer><![CDATA[INSERT INTO [Messages] ([Page], [Action], [Condition], [Message]) values('ParaData', 'Error', '6', 'The transaction you attempted could not be performed.  Please contact the site administrator and report the issue.')]]></SQLServer>
  <SQLServer><![CDATA[INSERT INTO [Messages] ([Page], [Action], [Condition], [Message]) values('ParaData', 'Error', '7', 'The software version is out of date.  Please contact the site administrator and report the issue.')]]></SQLServer>
  <SQLServer><![CDATA[INSERT INTO [Messages] ([Page], [Action], [Condition], [Message]) values('ParaData', 'Error', '8', 'The required response files from the payment handler is invalid.  Please submit the order again.  If the problem persists, contact the site administrator.')]]></SQLServer>
  <SQLServer><![CDATA[INSERT INTO [Messages] ([Page], [Action], [Condition], [Message]) values('ParaData', 'Error', '9', 'A required response file from the payment handler is invalid.  Please submit the order again.  If the problem persists, contact the site administrator.')]]></SQLServer>
  <SQLServer><![CDATA[INSERT INTO [Messages] ([Page], [Action], [Condition], [Message]) values('ParaData', 'Error', '10', 'The transaction you attempted could not be performed.  Please contact the site administrator.')]]></SQLServer>
  <SQLServer><![CDATA[INSERT INTO [Messages] ([Page], [Action], [Condition], [Message]) values('ParaData', 'Error', '100', 'There is a problem authorizing the credit card provided.  Please ensure that a valid credit card has been provided and submit the order again.')]]></SQLServer>
  <SQLServer><![CDATA[INSERT INTO [Messages] ([Page], [Action], [Condition], [Message]) values('ParaData', 'Error', '12', 'The acquirer gateway could not process the transaction.  Please submit the order again.  If the problem persists, contact the site administrator.')]]></SQLServer>
  <SQLServer><![CDATA[INSERT INTO [Messages] ([Page], [Action], [Condition], [Message]) values('ParaData', 'Error', '101', 'The acquirer gateway could not process the transaction.  Please submit the order again.  If the problem persists, contact the site administrator.')]]></SQLServer>
  <SQLServer><![CDATA[INSERT INTO [Messages] ([Page], [Action], [Condition], [Message]) values('ParaData', 'Error', '13', 'The payment engine could not process the transaction.  Please submit the order again.  If the problem persists, contact the site administrator.')]]></SQLServer>
  <SQLServer><![CDATA[INSERT INTO [Messages] ([Page], [Action], [Condition], [Message]) values('ParaData', 'Error', '102', 'The payment engine could not process the transaction.  Please submit the order again.  If the problem persists, contact the site administrator.')]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE PaymentProcessors ALTER COLUMN Pass nvarchar(500)]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE PaymentProcessors ALTER COLUMN UserID nvarchar(500)]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE PaymentProcessors ALTER COLUMN MerchantID nvarchar(500)]]></SQLServer>
  <SQLServer Error="UpdateError4"><![CDATA[UPDATE [PaymentProcessors] Set MerchantID='' WHERE [Name]='Paradata CommerceConnect' OR [Name]='Paradata']]></SQLServer>
  <SQLServer Error="UpdateError3"><![CDATA[UPDATE [PaymentProcessors] Set MerchantID='' WHERE [Name]='StoreFront Payment Gateway']]></SQLServer>
  <UpdateError3><![CDATA[INSERT INTO [PaymentProcessors] ([Name], [MerchantID], [UserID], [Pass], [DeclineMode], [AVSIsActive], [LiveServerPath], [AuthMode], [AVSFlags]) VALUES ('StoreFront Payment Gateway', NULL, NULL, NULL, 0, 0, NULL, 0, 'N')]]></UpdateError3>
  <UpdateError4><![CDATA[INSERT INTO [PaymentProcessors] ([Name], [MerchantID], [UserID], [Pass], [DeclineMode], [AVSIsActive], [LiveServerPath], [AuthMode], [AVSFlags]) VALUES ('Paradata CommerceConnect', NULL, NULL, NULL, 0, 0, NULL, 0, 'N')]]></UpdateError4>
  <SQLServer><![CDATA[UPDATE Admin SET TransMethod=(SELECT uid FROM PaymentProcessors WHERE [Name]='StoreFront Payment Gateway') WHERE CCOnline=0]]></SQLServer>
  <SQLServer><![CDATA[UPDATE PaymentProcessors SET Name='VeriSign' WHERE NAME='Verisign']]></SQLServer>
  <SQLServer><![CDATA[UPDATE PaymentProcessors SET Name='Paradata' WHERE NAME='Paradata CommerceConnect']]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE PaymentProcessors ADD TestMode integer NOT NULL DEFAULT (0)]]></SQLServer>
  <SQLServer><![CDATA[if exists (select * from sysobjects where id = object_id(N'[usp_rebuildcat]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
				drop procedure [usp_rebuildcat]]]></SQLServer>
  <SQLServer><![CDATA[CREATE   PROCEDURE usp_rebuildcat
	AS
	DECLARE @vdbname varchar(128)
	DECLARE @vcatname varchar(255)
	DECLARE @tid int
	SELECT @vdbname = DB_NAME()
	
	SELECT @tid = id FROM sysobjects where name = 'products'
	
	IF FULLTEXTSERVICEPROPERTY('IsFullTextINstalled') &gt; 0  
	BEGIN
		IF (DATABASEPROPERTY(@vdbname,'IsFullTextEnabled') = 1)  AND (OBJECTPROPERTY(@tid,'TableHasActiveFulltextIndex') = 1) AND (FULLTEXTCATALOGPROPERTY (@vdbname+'catalog' ,'populatestatus') = 0)
			BEGIN
			  -- Create a new indexing catalog for the current database
			   SET @vcatname = @vdbname + 'catalog'	
			   exec sp_fulltext_catalog @vcatname,'start_full'
			END
		END
	RETURN 0]]></SQLServer>
  <SQLServer><![CDATA[if exists (select * from sysobjects where id = object_id(N'[usp_categorysearch]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
  	drop procedure [usp_categorysearch]]]></SQLServer>
  <SQLServer><![CDATA[create proc usp_categorysearch 
                      @catid int, @answer varchar(8000) OUTPUT
                      AS
			Declare @vstacklist varchar(8000),@vpopped int
			SET @vstacklist = CAST(@catid AS varchar)  + ','
	
			WHILE (LEN(@vstacklist) &gt; 0 AND LEN(@vstacklist) &lt; 8000 )
			BEGIN
			   --pop the top of the stack	
			   SET @vpopped = SUBSTRING(@vstacklist,1,CHARINDEX(',',@vstacklist)-1)
			   SET @vstacklist =  RIGHT(@vstacklist,LEN(@vstacklist) - CHARINDEX(',',@vstacklist) )
			   SET @answer = @answer + CAST(@vpopped AS VARCHAR) +  ','
			   DECLARE catcrs CURSOR FOR 
			   SELECT uid FROM Categories WHERE parentid = @vpopped
		
			   OPEN  catcrs
			   FETCH NEXT FROM catcrs INTO @catid
			   WHILE @@FETCH_STATUS = 0
			   BEGIN 
				-- add all the children of this node to the list
				SET @vstacklist = CAST(@catid AS varchar) + ',' + @vstacklist 
				FETCH NEXT FROM catcrs INTO @catid	
			   END	   	
			   CLOSE catcrs
			   DEALLOCATE catcrs
			END]]></SQLServer>
  <SQLServer><![CDATA[if exists (select * from sysobjects where id = object_id(N'[usp_prodinitialsearch]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
						drop procedure [usp_prodinitialsearch]]]></SQLServer>
  <SQLServer Error="ProcError1"><![CDATA[DECLARE @vdbname varchar(128)

DECLARE @vcatname varchar(255)
DECLARE @vindname sysname
DECLARE @vcolname varchar(255)
DECLARE @searchon varchar(1000)
SELECT @vdbname = DB_NAME()

 -- Enable the database for full text indexing
  exec sp_fulltext_database 'enable'	
 
  -- Create a new indexing catalog for the current database
  SET @vcatname = @vdbname + 'catalog'	


IF (SELECT COUNT(*) FROM sysfulltextcatalogs WHERE name = @vcatname) > 0 
BEGIN
	EXEC sp_fulltext_table 'Products', 'drop'
    exec sp_fulltext_catalog @vcatname, 'drop'
END  

exec sp_fulltext_catalog @vcatname,'create'

  -- get the index name of the uid column of products table
  SELECT @vindname = si.name FROM sysobjects so, syscolumns sc, sysindexes si, sysindexkeys sk
         WHERE sc.id  = so.id
		 AND si.id = so.id
 	   AND sk.id = so.id
 	   AND sk.colid = sc.colid
	   AND si.indid = sk.indid
	   AND so.name = 'products'
	   AND sc.name = 'uid'

	  		
   -- create the products table for full text processing
  exec sp_fulltext_table 'products','create',@vcatname,@vindname
	
  -- now add all the candidate columns which can be text searched
  SET  @searchon = '&lt;%Param2%&gt;'
	  
          		
	WHILE CHARINDEX(',',@searchon) &gt; 0 OR LEN(@searchon) &gt; 0
	BEGIN
	   IF CHARINDEX(',',@searchon) &gt; 0	
		  SET @vcolname = SUBSTRING(@searchon,1,CHARINDEX(',',@searchon)-1)
	   ELSE
		  SET @vcolname = @searchon
	
   	  exec sp_fulltext_column 'products',@vcolname, 'add'		

	   IF CHARINDEX(',',@searchon) &gt; 0 
		  SET @searchon =  SUBSTRING(@searchon,CHARINDEX(',',@searchon)+1,LEN(@searchon))
	   ELSE
		   SET @searchon =''	
	END	
	 
         -- activate the full text index for the table
  
         exec sp_fulltext_table  'products','activate'

	-- start the full text indexing of the of the catalog created

	exec sp_fulltext_catalog @vcatname, 'start_full']]></SQLServer>
  <!-- SP8 -->
  <SQLServer><![CDATA[CREATE  PROC usp_prodinitialsearch
  		@searchkey varchar(255),
		@catid integer,
		@searchtype smallint,
		@searchon varchar(255),
		@onlyforsale smallint,
		@mfgrid int,
		@vendorid int,
		@lowerprice decimal(18,5),
		@upperprice decimal(18,5),
		@fromdate varchar(255),
		@todate varchar(255),
		@SearchFilterCondition VARCHAR(4000),
		@SearchFilterCount INT,
		@numrecs as int OUTPUT
	
	AS 

	DECLARE @vkey varchar(255)
	DECLARE @vdbname varchar(128), @vcatanswer  varchar(8000), @tempcatid int
	DECLARE @vcolname varchar(100)
	DECLARE @sqlstmt nvarchar(4000)
	DECLARE @joinstmt nvarchar(4000)
	DECLARE @wherestmt nvarchar(4000)
	DECLARE @vorderby varchar(100)
	CREATE TABLE #tproducts(uid INT)
	CREATE TABLE #tproducts2(uid INT)
	CREATE TABLE #tcategory(uid INT PRIMARY KEY)
	SELECT @vdbname = DB_NAME()
	
	SELECT @searchkey = LTRIM(RTRIM(@searchkey))
	SELECT @vorderby = ProductSort FROM Admin
	
	IF LEN(LTRIM(RTRIM(@searchkey))) &lt;= 0 
		GOTO NOTEXTSEARCH	

		  --manipulate the searchkeyword according to the type of search
		   IF @searchtype = 0 -- all words
		   BEGIN	 
			  SET @searchkey =  LTRIM(RTRIM(@searchkey))
			  SET @searchkey = REPLACE(@searchkey,' ','*&quot; AND &quot;')
  			  SET @searchkey = REPLACE(@searchkey,'-','*&quot; AND &quot;')	
			  SET @searchkey =  '&quot;' + @searchkey  + '*&quot;'
		   END	
		   ELSE IF @searchtype = 1	-- any word	
		   BEGIN	 
			  SET @searchkey =  LTRIM(RTRIM(@searchkey))
			  SET @searchkey = REPLACE(@searchkey,' ','*&quot; OR &quot;')
			  SET @searchkey = REPLACE(@searchkey,'-','*&quot; OR &quot;')
			  SET @searchkey =  '&quot;' + @searchkey  + '*&quot;'
		   END	
		   ELSE IF @searchtype = 2 -- phrase
		   BEGIN	 
			  SET @searchkey =  LTRIM(RTRIM(@searchkey))
			  SET @searchkey =  '&quot;' + @searchkey  + '&quot;'
		   END	 
	  
		INSERT INTO #tproducts
		SELECT  uid FROM products 
		WHERE code IS NOT NULL 
		AND isactive = 1 AND CONTAINS(*,@searchkey) 
		ORDER BY &lt;%Param1%&gt;
		
		GOTO SEARCHMORE
	
	NOTEXTSEARCH:
		SET @sqlstmt = 'INSERT INTO #tproducts Select P.uid FROM Products P'
		SET @wherestmt = ' WHERE P.uid not in (SELECT uid FROM #tproducts) AND isActive = 1'
		--modified to reduce overhead
		--Category Search
		IF @catid &gt;= 0 
		BEGIN
			SET @vcatanswer=''
			EXEC usp_categorysearch @catid, @vcatanswer OUTPUT
			WHILE CHARINDEX(',',@vcatanswer) &gt; 0 OR LEN(@vcatanswer) &gt; 0
			BEGIN
				 IF CHARINDEX(',',@vcatanswer) &gt; 0	
				 SET @tempcatid = SUBSTRING(@vcatanswer,1,CHARINDEX(',',@vcatanswer)-1)
				  ELSE
				 SET @tempcatid = @vcatanswer
			   INSERT INTO #tcategory (uid) VALUES (@tempcatid)
				IF CHARINDEX(',',@vcatanswer) &gt; 0 
				 SET @vcatanswer =  SUBSTRING(@vcatanswer,CHARINDEX(',',@vcatanswer)+1,LEN(@vcatanswer))
				ELSE
				 SET @vcatanswer =''	
				END
	
				SET @joinstmt = ' INNER JOIN productcategory PC ON (P.uid = PC.productid AND PC.categoryid in (SELECT uid FROM #tcategory))'	                             
				SET @catid = -1
			END
		--Search by Sale Price
		ELSE IF @onlyforsale &gt;= 0 
			BEGIN
				SET @wherestmt = @wherestmt + ' AND isonsale = ' + CAST(@onlyforsale as nvarchar(5))
				SET @onlyforsale = -1
			END
		--Search by Manufacturer
		ELSE IF @mfgrid &gt;= 0  
			BEGIN
				SET @wherestmt = @wherestmt + ' AND manufacturerId = ' + CAST(@mfgrid as nvarchar(100))
			END
		--Search by Vendor
		ELSE IF @vendorid &gt;= 0  
			BEGIN
				SET @wherestmt = @wherestmt + ' AND VendorId = ' + CAST(@vendorid as nvarchar(100))
				SET @vendorid = -1
			END
		--Search by Price
		ELSE IF @upperprice &gt; 0  and @lowerprice &gt;= 0
			BEGIN
				SET @wherestmt = @wherestmt + ' AND ((CAST(price AS decimal(18,5)) BETWEEN ' + CAST(@lowerprice as nvarchar(100)) + ' AND ' + CAST(@upperprice as nvarchar(100)) + ')'
				SET @wherestmt = @wherestmt + ' OR (CAST(saleprice AS decimal(18,5)) BETWEEN ' + CAST(@lowerprice as nvarchar(100)) + ' AND ' + CAST(@upperprice as nvarchar(100)) + ') AND isonsale = 1)'
				SET @upperprice = -1
				SET @lowerprice = -1
			END
		--Search by Date Added -- changed for SP8
		ELSE IF len(@todate) &gt; 0 and len(@fromdate) &gt; 0 
			BEGIN
				SET @wherestmt = @wherestmt + ' AND CAST(dateadded AS datetime) BETWEEN CAST(''' + @fromdate + ''' AS datetime) AND CAST(''' + @todate + ''' AS datetime)'
				SET @todate = ''
				SET @fromdate = ''
			END
		SET @sqlstmt = @sqlstmt + ISNULL(@joinstmt,'') + ISNULL(@wherestmt,'') + ' Order by ' + @vorderby
	  	--select @sqlstmt
		exec sp_executesql @sqlstmt	

		GOTO SEARCHMORE
		   

	SEARCHMORE:

		-- if category is there, delete the products from the temp table which are not in category
		IF @catid &gt;= 0 
		BEGIN
			SET @vcatanswer=''
			EXEC usp_categorysearch @catid, @vcatanswer OUTPUT
			WHILE CHARINDEX(',',@vcatanswer) &gt; 0 OR LEN(@vcatanswer) &gt; 0
			BEGIN
			      IF CHARINDEX(',',@vcatanswer) &gt; 0	
				  SET @tempcatid = SUBSTRING(@vcatanswer,1,CHARINDEX(',',@vcatanswer)-1)
			       ELSE
				  SET @tempcatid = @vcatanswer
				INSERT INTO #tcategory (uid) VALUES (@tempcatid)
				 IF CHARINDEX(',',@vcatanswer) &gt; 0 
				   SET @vcatanswer =  SUBSTRING(@vcatanswer,CHARINDEX(',',@vcatanswer)+1,LEN(@vcatanswer))
				  ELSE
				   SET @vcatanswer =''	
			END
			                             
	          DELETE FROM #tproducts
			WHERE uid NOT IN (SELECT P.uid 
   			FROM products P INNER JOIN productcategory PC ON (P.uid = PC.productid AND PC.categoryid in (SELECT uid FROM #tcategory)))
		END
		
		IF @onlyforsale &gt;= 0 
		BEGIN
		  DELETE FROM #tproducts
		  WHERE uid NOT IN (SELECT uid FROM products WHERE isonsale = @onlyforsale)
		END
		 
		IF @mfgrid &gt;= 0  
		BEGIN
		  DELETE FROM #tproducts
		  WHERE uid NOT IN (SELECT uid FROM products WHERE manufacturerId = @mfgrid)
		END 
	
		IF @vendorid &gt;= 0  
		BEGIN
		  DELETE FROM #tproducts
			  WHERE uid NOT IN (SELECT uid FROM products WHERE VendorId = @vendorid)
		END 
	
		IF @upperprice &gt; 0  and @lowerprice &gt;= 0
		BEGIN
		  DELETE FROM #tproducts
			  WHERE uid NOT IN (SELECT uid FROM products WHERE (CAST(price AS decimal(18,5)) BETWEEN @lowerprice AND @upperprice )
						OR (CAST(saleprice AS decimal(18,5)) BETWEEN @lowerprice  AND @upperprice ) AND isonsale = 1)
		END
	
		IF len(@todate) &gt; 0 and len(@fromdate) &gt; 0 
		BEGIN
		  DELETE FROM #tproducts
		  WHERE uid NOT IN (SELECT uid FROM products WHERE 
			CAST(dateadded AS datetime) BETWEEN CAST(@fromdate AS datetime) AND CAST(@todate AS datetime))
		END
		
		-- Tee 7/13/2007 remove products with inactive manufacturer
		DELETE FROM #tproducts
		WHERE uid IN (SELECT Products.uid FROM Products, Manufacturers WHERE Products.ManufacturerId = Manufacturers.uid AND Manufacturers.Active &lt;&gt; 1)
		-- Tee 8/15/2007 Product Configurator, remove merchant bundle without any component
		DELETE FROM #tproducts
		WHERE uid IN (SELECT Products.uid FROM Products, ProductsBundle WHERE ProductType IN (2,3) AND Products.uid NOT IN (SELECT ProductID FROM ProductsBundle))
		-- Tee 8/15/2007 Product Configurator, remove customer defined bundle without any steps with component
		DELETE FROM #tproducts
		WHERE uid IN (SELECT uid FROM Products WHERE ProductType IN (4,5) AND uid NOT IN(
		SELECT ProductID FROM BundleTemplateDetail WHERE uid IN(
		SELECT td.uid FROM BundleTemplateDetail td, BundleProductDetail pd WHERE td.uid = pd.StepID AND td.SelectableQty > 0)))
		-- end Tee

		-- begin: JDB - Search Filters
		IF @SearchFilterCount > 0
		BEGIN
			DECLARE @SearchFilterCountString VARCHAR(100)
			SET @SearchFilterCountString = CAST(@SearchFilterCount AS VARCHAR(100))
			EXEC('DELETE FROM #tproducts
			WHERE uid NOT IN (
			SELECT DISTINCT Attributes.ProductId
			FROM
				Attributes
				INNER JOIN AttributeDetail ON Attributes.uid = AttributeDetail.AttributeId
			WHERE' +
			@SearchFilterCondition +
			'GROUP BY Attributes.ProductId
			HAVING COUNT(Attributes.ProductId) = ' +
			@SearchFilterCountString +
			')')
		END
		-- end: JDB - Search Filters

		INSERT INTO #tproducts2
			SELECT DISTINCT uid FROM #tproducts
		SELECT @numrecs = COUNT(uid) FROM #tproducts2
		-- since distinct causes the sort order to be lost we have to do a select stmt
		-- SELECT uid FROM #tproducts2 
		SET @sqlstmt= 'select products.uid from products inner join #tproducts2 on (products.uid = #tproducts2.uid) Order by ' + @vorderby
		exec sp_executesql @sqlstmt

		-- begin: JDB - Search Filters
		SELECT DISTINCT A.[Name] AS AttributeName, SR.GlobalSelectorName, AD.[Name] AS AttributeValue
		FROM
			#tproducts P
			INNER JOIN Attributes A ON  P.uid = A.ProductId
			INNER JOIN SearchFilters SR ON A.[Name] = SR.AttributeName
			INNER JOIN AttributeDetail AD ON A.uid = AD.AttributeId
		WHERE A.Type = 0
		ORDER BY A.[Name], AD.[Name]
		-- end: JDB - Search Filters

		DROP TABLE #tproducts
		DROP TABLE #tproducts2
		DROP TABLE #tcategory]]></SQLServer>
  <ProcError1><![CDATA[CREATE  PROC usp_prodinitialsearch
  		@searchkey varchar(255),
		@catid integer,
		@searchtype smallint,
		@searchon varchar(255),
		@onlyforsale smallint,
		@mfgrid int,
		@vendorid int,
		@lowerprice decimal(18,5),
		@upperprice decimal(18,5),
		@fromdate varchar(255),
		@todate varchar(255),
		@SearchFilterCondition VARCHAR(4000),
		@SearchFilterCount INT,
		@numrecs as int OUTPUT
	
	AS 

	DECLARE @vkey varchar(255)
	DECLARE @vdbname varchar(128), @vcatanswer  varchar(8000), @tempcatid int
	DECLARE @vcolname varchar(100)
	DECLARE @sqlstmt nvarchar(4000)
	DECLARE @joinstmt nvarchar(4000)
	DECLARE @wherestmt nvarchar(4000)
	DECLARE @vorderby varchar(100)
	CREATE TABLE #tproducts(uid INT)
	CREATE TABLE #tproducts2(uid INT)
	CREATE TABLE #tcategory(uid INT PRIMARY KEY)
	SELECT @vdbname = DB_NAME()
	
	SELECT @searchkey = LTRIM(RTRIM(@searchkey))
	SELECT @vorderby = ProductSort FROM Admin
	
	IF LEN(LTRIM(RTRIM(@searchkey))) &lt;= 0 
		GOTO NOTEXTSEARCH	

	IF @searchtype = 0 -- allwords 
		SET @searchkey = '@ LIKE '+ char(39)  + '%' + replace(@searchkey,' ','%' + char(39) + ' AND @ LIKE ' + char(39)+ '%') + '%' +char(39)
	ELSE IF @searchtype = 1 -- 	any word search
		SET @searchkey = '@ LIKE '+ char(39) + '%' + replace(@searchkey,' ','%' + char(39) + ' OR @ LIKE ' + char(39)+ '%') + '%' +char(39)
	ELSE IF @searchtype = 2 -- Exact phrase
		SET @searchkey = '@ LIKE ' + char(39) + '%' + @searchkey + '%' + char(39)
	
	-- collect all the column names in temp table ( so that we can scroll through it)
			
	WHILE CHARINDEX(',',@searchon) &gt; 0 OR LEN(@searchon) &gt; 0
	BEGIN
	   IF CHARINDEX(',',@searchon) &gt; 0	
		  SET @vcolname = SUBSTRING(@searchon,1,CHARINDEX(',',@searchon)-1)
	   ELSE
		  SET @vcolname = @searchon
	-- the loop on the search runs here
	  SET @sqlstmt = 'INSERT INTO #tproducts Select uid FROM Products' 
	  SET @wherestmt = ' WHERE uid  not in (SELECT uid FROM #tproducts) AND isActive = 1 AND (' + @searchkey + ')'
	  
	  SET @wherestmt = replace(@wherestmt,'@',@vcolname)
	  
	  SET @sqlstmt = @sqlstmt + ISNULL(@wherestmt,'') + ' Order by ' + @vorderby
	  
	  exec sp_executesql @sqlstmt	
	  
	   IF CHARINDEX(',',@searchon) &gt; 0 
		   SET @searchon =  SUBSTRING(@searchon,CHARINDEX(',',@searchon)+1,LEN(@searchon))
	   ELSE
		   SET @searchon =''	
	END
	GOTO SEARCHMORE

	NOTEXTSEARCH:
		SET @sqlstmt = 'INSERT INTO #tproducts Select P.uid FROM Products P'
		SET @wherestmt = ' WHERE P.uid not in (SELECT uid FROM #tproducts) AND isActive = 1'
		--modified to reduce overhead
		--Category Search
		IF @catid &gt;= 0 
			BEGIN
				SET @vcatanswer=''
				EXEC usp_categorysearch @catid, @vcatanswer OUTPUT
				WHILE CHARINDEX(',',@vcatanswer) &gt; 0 OR LEN(@vcatanswer) &gt; 0
				BEGIN
				      IF CHARINDEX(',',@vcatanswer) &gt; 0	
					  SET @tempcatid = SUBSTRING(@vcatanswer,1,CHARINDEX(',',@vcatanswer)-1)
				       ELSE
					  SET @tempcatid = @vcatanswer
					INSERT INTO #tcategory (uid) VALUES (@tempcatid)
					 IF CHARINDEX(',',@vcatanswer) &gt; 0 
					   SET @vcatanswer =  SUBSTRING(@vcatanswer,CHARINDEX(',',@vcatanswer)+1,LEN(@vcatanswer))
					  ELSE
					   SET @vcatanswer =''	
				END
	
				SET @joinstmt = ' INNER JOIN productcategory PC ON (P.uid = PC.productid AND PC.categoryid in (SELECT uid FROM #tcategory))'	                             
				SET @catid = -1
			END
		--Search by Sale Price
		ELSE IF @onlyforsale &gt;= 0 
			BEGIN
				SET @wherestmt = ISNULL(@wherestmt,'') + ' AND isonsale = ' + CAST(@onlyforsale as nvarchar(5))
				SET @onlyforsale = -1
			END
		--Search by Manufacturer
		ELSE IF @mfgrid &gt;= 0  
			BEGIN
				SET @wherestmt = @wherestmt + ' AND manufacturerId = ' + CAST(@mfgrid as nvarchar(100))
			END
		--Search by Vendor
		ELSE IF @vendorid &gt;= 0  
			BEGIN
				SET @wherestmt = @wherestmt + ' AND VendorId = ' + CAST(@vendorid as nvarchar(100))
				SET @vendorid = -1
			END
		--Search by Price
		ELSE IF @upperprice &gt; 0  and @lowerprice &gt;= 0
			BEGIN
				SET @wherestmt = @wherestmt + ' AND ((CAST(price AS decimal(18,5)) BETWEEN ' + CAST(@lowerprice as nvarchar(100)) + ' AND ' + CAST(@upperprice as nvarchar(100)) + ')'
				SET @wherestmt = @wherestmt + ' OR (CAST(saleprice AS decimal(18,5)) BETWEEN ' + CAST(@lowerprice as nvarchar(100)) + ' AND ' + CAST(@upperprice as nvarchar(100)) + ') AND isonsale = 1)'
				SET @upperprice = -1
				SET @lowerprice = -1
			END
		--Search by Date Added
		ELSE IF len(@todate) &gt; 0 and len(@fromdate) &gt; 0 
			BEGIN
				SET @wherestmt = @wherestmt + ' AND CAST(dateadded AS datetime) BETWEEN CAST(''' + @fromdate + ''' AS datetime) AND CAST(''' + @todate + ''' AS datetime)'
				SET @todate = ''
				SET @fromdate = ''
			END
		SET @sqlstmt = @sqlstmt + ISNULL(@joinstmt,'') + ISNULL(@wherestmt,'') + ' Order by ' + @vorderby
	  	--select @sqlstmt
		exec sp_executesql @sqlstmt	

		GOTO SEARCHMORE
		   

	SEARCHMORE:

		-- if category is there, delete the products from the temp table which are not in category
		IF @catid &gt;= 0 
		BEGIN
			SET @vcatanswer=''
			EXEC usp_categorysearch @catid, @vcatanswer OUTPUT
			WHILE CHARINDEX(',',@vcatanswer) &gt; 0 OR LEN(@vcatanswer) &gt; 0
			BEGIN
			      IF CHARINDEX(',',@vcatanswer) &gt; 0	
				  SET @tempcatid = SUBSTRING(@vcatanswer,1,CHARINDEX(',',@vcatanswer)-1)
			       ELSE
				  SET @tempcatid = @vcatanswer
				INSERT INTO #tcategory (uid) VALUES (@tempcatid)
				 IF CHARINDEX(',',@vcatanswer) &gt; 0 
				   SET @vcatanswer =  SUBSTRING(@vcatanswer,CHARINDEX(',',@vcatanswer)+1,LEN(@vcatanswer))
				  ELSE
				   SET @vcatanswer =''	
			END
			                             
	          DELETE FROM #tproducts
			WHERE uid NOT IN (SELECT P.uid 
   			FROM products P INNER JOIN productcategory PC ON (P.uid = PC.productid AND PC.categoryid in (SELECT uid FROM #tcategory)))
		END
		
		IF @onlyforsale &gt;= 0 
		BEGIN
		  DELETE FROM #tproducts
		  WHERE uid NOT IN (SELECT uid FROM products WHERE isonsale = @onlyforsale)
		END
		 
		IF @mfgrid &gt;= 0  
		BEGIN
		  DELETE FROM #tproducts
		  WHERE uid NOT IN (SELECT uid FROM products WHERE manufacturerId = @mfgrid)
		END 
	
		IF @vendorid &gt;= 0  
		BEGIN
		  DELETE FROM #tproducts
			  WHERE uid NOT IN (SELECT uid FROM products WHERE VendorId = @vendorid)
		END 
	
		IF @upperprice &gt; 0  and @lowerprice &gt;= 0
		BEGIN
		  DELETE FROM #tproducts
			  WHERE uid NOT IN (SELECT uid FROM products WHERE (CAST(price AS decimal(18,5)) BETWEEN @lowerprice AND @upperprice )
						OR (CAST(saleprice AS decimal(18,5)) BETWEEN @lowerprice  AND @upperprice ) AND isonsale = 1)
		END
	
		IF len(@todate) &gt; 0 and len(@fromdate) &gt; 0 
		BEGIN
		  DELETE FROM #tproducts
		  WHERE uid NOT IN (SELECT uid FROM products WHERE 
			CAST(dateadded AS datetime) BETWEEN CAST(@fromdate AS datetime) AND CAST(@todate AS datetime))
		END
		
		-- Tee 7/13/2007 remove products with inactive manufacturer
		DELETE FROM #tproducts
		WHERE uid IN (SELECT Products.uid FROM Products, Manufacturers WHERE Products.ManufacturerId = Manufacturers.uid AND Manufacturers.Active &lt;&gt; 1)
		-- Tee 8/15/2007 Product Configurator, remove merchant bundle without any component
		DELETE FROM #tproducts
		WHERE uid IN (SELECT Products.uid FROM Products, ProductsBundle WHERE ProductType IN (2,3) AND Products.uid NOT IN (SELECT ProductID FROM ProductsBundle))
		-- Tee 8/15/2007 Product Configurator, remove customer defined bundle without any steps with component
		DELETE FROM #tproducts
		WHERE uid IN (SELECT uid FROM Products WHERE ProductType IN (4,5) AND uid NOT IN(
		SELECT ProductID FROM BundleTemplateDetail WHERE uid IN(
		SELECT td.uid FROM BundleTemplateDetail td, BundleProductDetail pd WHERE td.uid = pd.StepID AND td.SelectableQty > 0)))
		-- end Tee

		-- begin: JDB - Search Filters
		IF @SearchFilterCount > 0
		BEGIN
			DECLARE @SearchFilterCountString VARCHAR(100)
			SET @SearchFilterCountString = CAST(@SearchFilterCount AS VARCHAR(100))
			EXEC('DELETE FROM #tproducts
			WHERE uid NOT IN (
			SELECT DISTINCT Attributes.ProductId
			FROM
				Attributes
				INNER JOIN AttributeDetail ON Attributes.uid = AttributeDetail.AttributeId
			WHERE' +
			@SearchFilterCondition +
			'GROUP BY Attributes.ProductId
			HAVING COUNT(Attributes.ProductId) = ' +
			@SearchFilterCountString +
			')')
		END
		-- end: JDB - Search Filters

		INSERT INTO #tproducts2
			SELECT DISTINCT uid FROM #tproducts
		SELECT @numrecs = COUNT(uid) FROM #tproducts2
		-- since distinct causes the sort order to be lost we have to do a select stmt
		-- SELECT uid FROM #tproducts2 
		SET @sqlstmt= 'select products.uid from products inner join #tproducts2 on (products.uid = #tproducts2.uid) Order by ' + @vorderby
		exec sp_executesql @sqlstmt

		-- begin: JDB - Search Filters
		SELECT DISTINCT A.[Name] AS AttributeName, SR.GlobalSelectorName, AD.[Name] AS AttributeValue
		FROM
			#tproducts P
			INNER JOIN Attributes A ON  P.uid = A.ProductId
			INNER JOIN SearchFilters SR ON A.[Name] = SR.AttributeName
			INNER JOIN AttributeDetail AD ON A.uid = AD.AttributeId
		WHERE A.Type = 0
		ORDER BY A.[Name], AD.[Name]
		-- end: JDB - Search Filters

		DROP TABLE #tproducts
		DROP TABLE #tproducts2
		DROP TABLE #tcategory]]></ProcError1>
  <!-- SP8 Ends -->
  <SQLServer><![CDATA[if exists (select * from sysobjects where id = object_id(N'[usp_producttables]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
			drop procedure [usp_producttables]]]></SQLServer>
  <SQLServer><![CDATA[CREATE PROC usp_producttables
							@prodIds varchar(8000)
						
						AS
							DECLARE @vuid integer
							CREATE TABLE #tproducts (uid integer)
							-- collect al the column names in temp table ( so that we can scroll through it)
									
							WHILE CHARINDEX(',',@prodIds) &gt; 0 OR LEN(@prodIds) &gt; 0
							BEGIN
							   IF CHARINDEX(',',@prodIds) &gt; 0	
								  SET @vuid = CONVERT(integer,SUBSTRING(@prodIds,1,CHARINDEX(',',@prodIds)-1))
							   ELSE
								  SET @vuid = CONVERT(integer,@prodIds)
								
							INSERT INTO #tproducts(uid) VALUES(@vuid)
						
							IF CHARINDEX(',',@prodIds) &gt; 0 
									SET @prodIds =  SUBSTRING(@prodIds,CHARINDEX(',',@prodIds)+1,LEN(@prodIds))
							ELSE
								   SET @prodIds =''	
							END
						
							SELECT  uid,ParentLevel,ParentID,Name 
								FROM Categories WHERE isActive = 1 
						
							SELECT p.* FROM PRODUCTS p inner join #tproducts tp on (p.uid=tp.uid) ORDER BY p.&lt;%Param1%&gt;
							
							select distinct a.* from attributes a inner join #tproducts tp on (a.productid = tp.uid)
							
							SELECT distinct ad.* FROM attributedetail ad INNER JOIN attributes a ON
								(ad.attributeid = a.uid)
								inner join #tproducts tp on (a.productid = tp.uid)
								ORDER BY ad.AttributeOrder
							
							SELECT distinct pc.* FROM productcategory pc inner join #tproducts tp on (pc.productid = tp.uid)
							
							SELECT distinct V.*, A.company FROM
								vendors V INNER JOIN addresses A ON (V.addressid = A.uid)
								  INNER JOIN products P on (V.uid = P.vendorid) INNER JOIN #tproducts tp
									ON (p.uid = tp.uid)
							
							SELECT distinct M.* , A.company FROM 
							manufacturers M INNER JOIN addresses A ON (M.addressid  = A.uid)
									INNER JOIN products P ON (P.manufacturerid = M.uid)
									INNER JOIN #tproducts tp ON (p.uid = tp.uid)
							
							SELECT distinct vp.*, P.Price as ProductPrice FROM volumepricing vp
							INNER JOIN #tproducts tp ON (vp.productid = tp.uid)
							INNER JOIN products P ON (P.uid = tp.uid)
							
							SELECT gw.* FROM giftwrap gw
							INNER JOIN #tproducts tp ON (gw.productid=tp.uid)
							
							--Tee 7/13/2007 commented out, exclude products with deactivated manufacturers
							--SELECT distinct rp.* FROM relatedproducts rp
							--INNER JOIN #tproducts tp ON (rp.parentid = tp.uid)
							SELECT distinct rp.* FROM relatedproducts rp, #tproducts tp, manufacturers m, products p WHERE
							p.manufacturerId = m.uid and m.active = 1 and rp.relatedId = p.uid and rp.parentid = tp.uid
							--end Tee
							
							-- begin: JDB - 7/10/2007 - Customer Price Groups
							SELECT DISTINCT
								CP.uid AS GroupID,
								CP.GroupName,
								CP.Amount,
								CP.GroupTypeID,
								ISNULL(ISNULL(ISNULL(ISNULL(C.ProductID, CPGC.ProductId), CPGM.ProductID), CPGV.ProductID), P.uid) AS ProductID
							FROM
								CustomerPriceGroups CP
								LEFT OUTER JOIN CustomerSpecificPricing C ON CP.uid = C.GroupID
								LEFT OUTER JOIN
									(
									SELECT
										CPGC.CustomerPriceGroupId,
										CP.ProductID
									FROM
										CustomerPriceGroupCategories CPGC
										INNER JOIN Categories C ON CPGC.CategoryId = C.uid
										INNER JOIN ProductCategory CP ON C.uid = CP.CategoryID
									)CPGC ON CP.uid = CPGC.CustomerPriceGroupId
								LEFT OUTER JOIN
									(
									SELECT
										CPGM.CustomerPriceGroupId,
										P.uid AS ProductID
									FROM
										CustomerPriceGroupManufacturers CPGM
										INNER JOIN Products P ON CPGM.ManufacturerID = P.ManufacturerID
									) CPGM ON CP.uid = CPGM.CustomerPriceGroupId
								LEFT OUTER JOIN
									(
									SELECT
										CPGV.CustomerPriceGroupId,
										P.uid AS ProductID
									FROM
										CustomerPriceGroupVendors CPGV
										INNER JOIN Products P ON CPGV.VendorID= P.VendorID
									) CPGV ON CP.uid = CPGV.CustomerPriceGroupId
								LEFT OUTER JOIN Products P ON CP.AllProducts = 1
								INNER JOIN #tproducts tp ON (C.productID = tp.uid OR CPGC.ProductID = tp.uid OR CPGM.ProductID = tp.uid OR CPGV.ProductID = tp.uid OR P.uid = tp.uid)
							WHERE
								ISNULL(ISNULL(ISNULL(ISNULL(C.ProductID, CPGC.ProductId), CPGM.ProductID), CPGV.ProductID), P.uid) IS NOT NULL
							-- end: JDB - 7/10/2007 - Customer Price Groups

							SELECT ii.* FROM InventoryInfo ii
							INNER JOIN #tproducts tp ON (ii.ProdID = tp.uid)
							
							SELECT ProductsBundle.* FROM ProductsBundle INNER JOIN #tproducts ON (ProductsBundle.ProductId = #tproducts.uid) INNER JOIN Products ON (Products.uid = #tproducts.uid) ORDER BY DisplayOrder, Name
							
							SELECT Products.* FROM Products 
								INNER JOIN (ProductsBundle INNER JOIN #tproducts 
									ON (ProductsBundle.ProductId = #tproducts.uid))
										ON (Products.uid = ProductsBundle.BundleId)
							]]></SQLServer>
  <SQLServer><![CDATA[if exists (select * from sysobjects where id = object_id(N'[usp_productcattables]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
			drop procedure [usp_productcattables]]]></SQLServer>
  <SQLServer><![CDATA[CREATE PROC usp_productcattables
							@prodIds varchar(8000),
							@prodcatIds varchar(8000)
							
						
						AS
							DECLARE @vuid integer
							DECLARE @vprodcatIds varchar(8000)
							CREATE TABLE #tproducts (uid integer)
							CREATE TABLE #tcatproducts (uid integer)

							-- collect al the column names in temp table ( so that we can scroll through it)
									
							WHILE CHARINDEX(',',@prodIds) &gt; 0 OR LEN(@prodIds) &gt; 0
							BEGIN
							   IF CHARINDEX(',',@prodIds) &gt; 0	
								  SET @vuid = CONVERT(integer,SUBSTRING(@prodIds,1,CHARINDEX(',',@prodIds)-1))
							   ELSE
								  SET @vuid = CONVERT(integer,@prodIds)
								
							INSERT INTO #tproducts(uid) VALUES(@vuid)
						
							IF CHARINDEX(',',@prodIds) &gt; 0 
									SET @prodIds =  SUBSTRING(@prodIds,CHARINDEX(',',@prodIds)+1,LEN(@prodIds))
							ELSE
								   SET @prodIds =''	
							END


							WHILE CHARINDEX(',',@prodcatIds) &gt; 0 OR LEN(@prodcatIds) &gt; 0
							BEGIN
							   IF CHARINDEX(',',@prodcatIds) &gt; 0	
								  SET @vprodcatIds = CONVERT(integer,SUBSTRING(@prodcatIds,1,CHARINDEX(',',@prodcatIds)-1))
							   ELSE
								  SET @vprodcatIds = CONVERT(integer,@prodcatIds)
								
							INSERT INTO #tcatproducts(uid) VALUES(@vprodcatIds)
						
							IF CHARINDEX(',',@prodcatIds) &gt; 0 
									SET @prodcatIds =  SUBSTRING(@prodcatIds,CHARINDEX(',',@prodcatIds)+1,LEN(@prodcatIds))
							ELSE
								   SET @prodcatIds =''	
							END

						
							SELECT  uid,ParentLevel,ParentID,Name 
								FROM Categories WHERE isActive = 1 
						
							SELECT p.* FROM PRODUCTS p inner join #tproducts tp on (p.uid=tp.uid) ORDER BY p.&lt;%Param1%&gt;
							
							select distinct a.* from attributes a inner join #tproducts tp on (a.productid = tp.uid) ORDER BY a.name
							
							SELECT distinct ad.* FROM attributedetail ad INNER JOIN attributes a ON
								(ad.attributeid = a.uid)
								inner join #tproducts tp on (a.productid = tp.uid)
								ORDER BY ad.AttributeOrder
							
							SELECT distinct pc.* FROM productcategory pc inner join #tproducts tp on (pc.productid = tp.uid)  inner join #tcatproducts ct on (pc.categoryid = ct.uid)
							
							SELECT distinct V.*, A.company FROM
								vendors V INNER JOIN addresses A ON (V.addressid = A.uid)
								  INNER JOIN products P on (V.uid = P.vendorid) INNER JOIN #tproducts tp
									ON (p.uid = tp.uid)
							
							SELECT distinct M.* , A.company FROM 
							manufacturers M INNER JOIN addresses A ON (M.addressid  = A.uid)
									INNER JOIN products P ON (P.manufacturerid = M.uid)
									INNER JOIN #tproducts tp ON (p.uid = tp.uid)
							
							SELECT distinct vp.*, P.Price as ProductPrice FROM volumepricing vp
							INNER JOIN #tproducts tp ON (vp.productid = tp.uid)
							INNER JOIN products P ON (P.uid = tp.uid)
							
							SELECT gw.* FROM giftwrap gw
							INNER JOIN #tproducts tp ON (gw.productid=tp.uid)
							
							--Tee 7/13/2007 commented out, exclude products with deactivated manufacturers
							--SELECT distinct rp.* FROM relatedproducts rp
							--INNER JOIN #tproducts tp ON (rp.parentid = tp.uid)
							SELECT distinct rp.* FROM relatedproducts rp, #tproducts tp, manufacturers m, products p WHERE
							p.manufacturerId = m.uid and m.active = 1 and rp.relatedId = p.uid and rp.parentid = tp.uid
							--end Tee
							
							SELECT distinct C.*, CP.groupname,cp.amount, cp.grouptypeid
							FROM customerspecificpricing C INNER JOIN customerpricegroups CP ON (C.groupid = CP.uid)
							INNER JOIN #tproducts tp ON (C.productID = tp.uid)

							SELECT ii.* FROM InventoryInfo ii
							INNER JOIN #tproducts tp ON (ii.ProdID = tp.uid)
							SELECT ProductsBundle.* FROM ProductsBundle INNER JOIN #tproducts ON (ProductsBundle.ProductId = #tproducts.uid)
							SELECT Products.* FROM Products 
								INNER JOIN (ProductsBundle INNER JOIN #tproducts 
									ON (ProductsBundle.ProductId = #tproducts.uid))
										ON (Products.uid = ProductsBundle.BundleId)]]></SQLServer>
  <SQLServer><![CDATA[if exists (select * from sysobjects where id = object_id(N'[usp_getfilteredcategories]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
			drop procedure [usp_getfilteredcategories]]]></SQLServer>
  <SQLServer><![CDATA[create Proc usp_getfilteredcategories
								  @categoryid integer
							 as
							 Select p.Name as Name, p.uid from Categories P inner join Categories C on (c.ParentID = P.uid and p.ParentID = @categoryid)	
							 union 
							 select c.Name as Name, c.uid from Categories c inner join ProductCategory Pc on (c.uid = pc.CategoryID and parentid = @categoryid)
							 Order By Name]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Messages ALTER COLUMN Message varchar(2000)]]></SQLServer>
  <SQLServer><![CDATA[IF (SELECT COUNT(*) FROM Messages WHERE Page = 'Searchresult.aspx' AND Action = 'Suggestion' AND Condition = 'NoResult') &lt;=0 
BEGIN
    INSERT INTO Messages ( Page, Action, Condition, Message) VALUES ('SearchResult.aspx','Suggestion','NoResult','We are sorry, but your search did not yield any results. <a href=search.aspx>Click here</a> to search again. If you think your search may have been too broad, you may wish to try using more descriptive criteria (if you did not specify keywords, try doing so). If you think your search may have been too narrow, try using looser criteria (for example, try performing an "All Words" or "Any Words" search)')
END]]></SQLServer>
  <SQLServer><![CDATA[IF (select count(*) from paymentprocessors where name = 'Orbital') &lt;=0
BEGIN
INSERT INTO PaymentProcessors( Name,MerchantID,UserID,Pass,DeclineMode,AVSIsActive, LiveServerPath,AuthMode, AVSFlags,TestMode) VALUES ('Orbital','','','',0,0,'https://epayhip.paymentech.net/authorize',0,'N',1)
END]]></SQLServer>
  <SQLServer><![CDATA[UPDATE PaymentProcessors SET [name] = 'Terra Payments' WHERE [name] = 'Firepay']]></SQLServer>
  <SQLServer><![CDATA[if exists (select * from sysobjects where id = object_id(N'[usp_periodicdelete]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
			drop procedure [usp_periodicdelete]]]></SQLServer>
  <SQLServer><![CDATA[CREATE PROC usp_periodicdelete
							@LCID int,
							@period int
				AS
							DECLARE @dformat nchar(3)
							SET @dformat = 'mdy'
							(Select @dformat =dateformat From master.dbo.syslanguages Where LCID = @LCID)

							SET dateformat @dformat
							Delete From ShoppingCartGiftWrap Where ShoppingItemID in (Select uid from ShoppingCartItems where CartID in (Select uid from ShoppingCart where DATEDIFF(minute,CreatedDate,GetDate()) > @period))
							Delete From ShoppingCartAttributes Where ShoppingCartItemID in (Select uid from ShoppingCartItems where CartID in (Select uid from ShoppingCart where DATEDIFF(minute,CreatedDate,GetDate()) > @period))
							Delete From ShoppingCartItems where CartID in (Select uid from ShoppingCart where DATEDIFF(minute,CreatedDate,GetDate()) >@period)
							Delete From ShoppingCart where DATEDIFF(minute,CreatedDate,GetDate()) > @period

							Delete From Walkin where DATEDIFF(minute,CreatedDate,GetDate()) > @period]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE OrderPayment Add StartMonth nvarchar(2)]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE OrderPayment Add StartYear nvarchar(4)]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE OrderPayment Add IssueNumber nvarchar(50)]]></SQLServer>
  <!-- Clear Commerce Integration Fields -->
  <SQLServer><![CDATA[ALTER TABLE PaymentProcessors Add PayerAuthSel int ]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE PaymentProcessors Add PayerAuthURL varchar(255) ]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE PaymentProcessors Add service varchar(50) ]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE PaymentProcessors Add ccpaclientid varchar(50) ]]></SQLServer>
  <SQLServer Error="UpdateSQLServerError2459"><![CDATA[insert into PaymentProcessors (AuthMode,AVSFlags,AVSIsActive,ccpaclientid,DeclineMode,LiveServerPath,MerchantID,Name,Pass,PayerAuthSel,PayerAuthURL,service,TestMode,UserID )  
		VALUES (0,'N',0,'',0,'https://test5x.clearcommerce.com','','Clear Commerce','',0,'','',1,'')]]></SQLServer>
  <UpdateSQLServerError2459><![CDATA[Update PaymentProcessors SET LiveServerPath='https://secure4x.clearcommerce.com:11500' WHERE Name='Clear Commerce' AND LiveServerPath <> 'https://secure4x.clearcommerce.com:11500']]></UpdateSQLServerError2459>
  <SQLServer><![CDATA[if (Select count(*) from PaymentProcessors where Name = 'PayFuse') = 0
  insert into PaymentProcessors (AuthMode,AVSFlags,AVSIsActive,DeclineMode,LiveServerPath,MerchantID,Name,Pass,TestMode,UserID )  VALUES (0,'N',0,0,'https://xmlic.payfuse.com','','PayFuse','',1,'')]]></SQLServer>
  <SQLServer><![CDATA[alter table VolumePricing Alter Column BreakLevel int]]></SQLServer>
  <SQLServer><![CDATA[Update PaymentProcessors Set Name = 'Paradata - SF Payments' where Name = 'StoreFront Payment gateway']]></SQLServer>
  <SQLServer><![CDATA[insert into PaymentProcessors (AuthMode,AVSFlags,AVSIsActive,ccpaclientid,DeclineMode,LiveServerPath,MerchantID,Name,Pass,PayerAuthSel,PayerAuthURL,service,TestMode,UserID )  
  		VALUES (0,'N',0,'',0,'https://secure4x.clearcommerce.com','','StoreFront Payments Gateway','',0,'','',1,'')]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Admin ADD AdminGuid nvarchar(50)]]></SQLServer>
  <SQLServer><![CDATA[Update PaymentProcessors SET LiveServerPath='https://secure4x.clearcommerce.com' WHERE Name='Clear Commerce' AND LiveServerPath <> 'https://secure4x.clearcommerce.com']]></SQLServer>
  <SQLServer><![CDATA[UPDATE Admin SET TransMethod=(SELECT uid FROM PaymentProcessors WHERE [Name]='StoreFront Payments Gateway') WHERE CCOnline=0]]></SQLServer>
  <SQLServer><![CDATA[Insert Into Messages(Page, Action, Condition, Message) Values ('ClearCommerce','Error','TransactionFailed','The transaction failed. Please try again or contact store merchant for more information.')]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Admin ADD EncryptionPublicKey TEXT]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Admin ADD ConvertedFrom3DES bit default 0]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE OrderPayment ADD Last4Digits char(4)]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE OrderPayment ADD IsDirty bit default 0 NOT NULL]]></SQLServer>
  <SQLServer><![CDATA[CREATE TABLE SecurityLog (uid int IDENTITY(0,1) primary key, UserName varchar(100), AccessTime DateTime)]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE ShoppingCartItems Add IsItemEbay bit ]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE ShoppingCartItems Add EbayPrice decimal ]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE OrderItems Add IsItemEbay bit Not Null Default 0 ]]></SQLServer>
  <SQLServer><![CDATA[Alter Table SavedCartItems add IsItemEbay bit ]]></SQLServer>
  <SQLServer><![CDATA[DROP TABLE MerchantToolsMenuHeaders]]></SQLServer>
  <SQLServer><![CDATA[CREATE TABLE [MerchantToolsMenuHeaders] (
	[uid] [int] IDENTITY (1, 1) PRIMARY KEY NOT NULL ,
	[DisplayName] [varchar] (255) NOT NULL ,
	[DisplayOrder] [int] NOT NULL 
	) ON [PRIMARY]]]></SQLServer>
  <SQLServer><![CDATA[DROP TABLE MerchantToolsMenuDetails]]></SQLServer>
  <SQLServer><![CDATA[CREATE TABLE [MerchantToolsMenuDetails] (
	[uid] [int] IDENTITY (1, 1) PRIMARY KEY NOT NULL ,
	[HeaderId] [int] NOT NULL ,
	[DisplayName] [varchar] (255) NOT NULL ,
	[Link] [varchar] (255) NOT NULL ,
	[DisplayOrder] [int] NOT NULL ,
	[Version] Bit NOT NULL
) ON [PRIMARY]]]></SQLServer>
  <SQLServer><![CDATA[INSERT INTO MerchantToolsMenuHeaders Values('Store Management',0)]]></SQLServer>
  <SQLServer><![CDATA[INSERT INTO MerchantToolsMenuHeaders Values('Marketing & Promotions',1)]]></SQLServer>
  <SQLServer><![CDATA[INSERT INTO MerchantToolsMenuHeaders Values('Store Inventory',2)]]></SQLServer>
  <SQLServer><![CDATA[INSERT INTO MerchantToolsMenuHeaders Values('Store Settings',3)]]></SQLServer>
  <SQLServer><![CDATA[INSERT into MerchantToolsMenuDetails Values(1,'Sales Reports','StoreReports.aspx',0,0)]]></SQLServer>
  <SQLServer><![CDATA[INSERT into MerchantToolsMenuDetails Values(1,'Orders','orderfulfillment.aspx',1,0)]]></SQLServer>
  <SQLServer><![CDATA[INSERT into MerchantToolsMenuDetails Values(1,'Affiliates','affiliatepayments.aspx',2,0)]]></SQLServer>
  <SQLServer><![CDATA[INSERT into MerchantToolsMenuDetails Values(1,'Customers','customers.aspx',3,0)]]></SQLServer>
  <SQLServer><![CDATA[INSERT into MerchantToolsMenuDetails Values(1,'Price Groups','managepricegroups.aspx',4,1)]]></SQLServer>
  <SQLServer><![CDATA[INSERT into MerchantToolsMenuDetails Values(1,'Gift Certificates','managegiftcertificates.aspx',5,0)]]></SQLServer>
  <SQLServer><![CDATA[INSERT into MerchantToolsMenuDetails Values(2,'Storewide Discounts','storediscounts.aspx',0,0)]]></SQLServer>
  <SQLServer><![CDATA[INSERT into MerchantToolsMenuDetails Values(2,'Coupons','storecoupons.aspx',1,0)]]></SQLServer>
  <SQLServer><![CDATA[INSERT into MerchantToolsMenuDetails Values(2,'Promotional Mail','PromotionalMail.aspx',2,0)]]></SQLServer>
  <SQLServer><![CDATA[INSERT into MerchantToolsMenuDetails Values(2,'Search Engines','SearchEngineSubmission.aspx',3,0)]]></SQLServer>
  <SQLServer><![CDATA[INSERT into MerchantToolsMenuDetails Values(2,'Marketplaces','marketplaces.aspx',4,0)]]></SQLServer>
  <SQLServer><![CDATA[INSERT into MerchantToolsMenuDetails Values(3,'Import Products','productimport.aspx',0,0)]]></SQLServer>
  <SQLServer><![CDATA[INSERT into MerchantToolsMenuDetails Values(3,'Products','manageproducts.aspx',1,0)]]></SQLServer>
  <SQLServer><![CDATA[INSERT into MerchantToolsMenuDetails Values(3,'Attributes','attributestemplate.aspx',2,0)]]></SQLServer>
  <SQLServer><![CDATA[INSERT into MerchantToolsMenuDetails Values(3,'Categories','managecategories.aspx',3,0)]]></SQLServer>
  <SQLServer><![CDATA[INSERT into MerchantToolsMenuDetails Values(3,'Manufacturers','managemanufacturers.aspx',4,0)]]></SQLServer>
  <SQLServer><![CDATA[INSERT into MerchantToolsMenuDetails Values(3,'Vendors','managevendors.aspx',5,0)]]></SQLServer>
  <SQLServer><![CDATA[INSERT into MerchantToolsMenuDetails Values(4,'General','general.aspx',0,0)]]></SQLServer>
  <SQLServer><![CDATA[INSERT into MerchantToolsMenuDetails Values(4,'Online Chat','onlinechat.aspx',1,0)]]></SQLServer>
  <SQLServer><![CDATA[INSERT into MerchantToolsMenuDetails Values(4,'E-Mail','ManageEmail.aspx',2,0)]]></SQLServer>
  <SQLServer><![CDATA[INSERT into MerchantToolsMenuDetails Values(4,'Shipping','shippinghandling.aspx',3,0)]]></SQLServer>
  <SQLServer><![CDATA[INSERT into MerchantToolsMenuDetails Values(4,'Payments','paymentmethods.aspx',4,0)]]></SQLServer>
  <SQLServer><![CDATA[INSERT into MerchantToolsMenuDetails Values(4,'Localization','geography.aspx',5,0)]]></SQLServer>
  <SQLServer><![CDATA[INSERT into MerchantToolsMenuDetails Values(4,'Tax','tax.aspx',6,0)]]></SQLServer>
  <SQLServer><![CDATA[  CREATE TABLE [OrderGiftCertificates] (
	[uid] [int] IDENTITY (1, 1) NOT NULL PRIMARY KEY,
	[OrderId] [int] NOT NULL ,
	[GiftCertificateId] [int] NOT NULL ,
	[Name] [nvarchar] (50) NULL ,
	[Expires] [nvarchar] (50) NULL ,
	[Code] [nvarchar] (50) NULL ,
	[AmountUsed] [nvarchar] (50) NULL )]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Discounts ADD ApplyOnce BIT DEFAULT 0 NOT NULL]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE PaymentProcessors ADD ProcessorID varchar(50) DEFAULT '' NOT NULL ]]></SQLServer>
  <SQLServer><![CDATA[IF (SELECT COUNT(*) FROM PaymentProcessors WHERE NAME ='VeriSignPayFlowLink') <=0
				BEGIN
				 INSERT INTO PaymentProcessors ([Name], [MerchantID], [UserID], [Pass], [DeclineMode], [AVSIsActive], [LiveServerPath], [AuthMode], [AVSFlags]) VALUES ('VeriSignPayFlowLink', '', '', '', 0, 0, 'https://payments.verisign.com/payflowlink', 0, 'N')
				END]]></SQLServer>
  <SQLServer><![CDATA[alter table Admin Add StoreFrontLinkValue int ]]></SQLServer>
  <!-- SP7 -->
  <!-- Verisign Recurring Billing-UP -->
  <SQLServer><![CDATA[ALTER TABLE Labels ADD [SubscriptionPrice] nvarchar(50), [RecurringPrice] nvarchar(50)]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Products ADD [ProductType] int DEFAULT 0 NOT NULL, [RecurringSubscriptionPrice] nvarchar(20) DEFAULT 0 NOT NULL, [PaymentPeriod] int DEFAULT -1 NOT NULL, [Term] int DEFAULT 0 NOT NULL, [BillingDelay] int DEFAULT 0 NOT NULL]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE OrderItems ADD [ProductType] int DEFAULT 0 NOT NULL, [RecurringSubscriptionPrice] nvarchar(20) DEFAULT 0 NOT NULL, [PaymentPeriod] int DEFAULT -1 NOT NULL, [Term] int DEFAULT 0 NOT NULL, [BillingStartDate] datetime]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE PaymentProcessors ADD RecurringBillingIsActive bit DEFAULT 0 NOT NULL]]></SQLServer>
  <SQLServer><![CDATA[CREATE TABLE [RecurringTransactionResponse] (
	[uid] [int] IDENTITY (1, 1) PRIMARY KEY NOT NULL ,
	[OrderItemID] [int] NOT NULL ,
	[ProfileID] [nvarchar] (50) NOT NULL ,
	[RPRef] [nvarchar] (20) NOT NULL ,
	[Result] [int] NOT NULL ,
	[Message] [text] NOT NULL,
	[TransactionDate] [datetime] NOT NULL 
) ON [PRIMARY]]]></SQLServer>
  <!-- Verisign Recurring Billing-UP -->
  <!--  PayPal -->
  <SQLServer><![CDATA[alter table Admin Add AcceptPayPalExpress int DEFAULT 0]]></SQLServer>
  <SQLServer><![CDATA[CREATE TABLE [PayPalUsers] (
	[uid] [int] IDENTITY (1, 1) PRIMARY KEY NOT NULL ,
	[CustomerID] [int] NOT NULL ,
	[PayPalEMail] [nvarchar] (255)) ON [PRIMARY]]]></SQLServer>
  <SQLServer><![CDATA[UPDATE PaymentProcessors SET TestMode = '0' WHERE NAME='PayPal']]></SQLServer>
  <SQLServer><![CDATA[UPDATE Instructions Set Instruction = 'If you''ve placed an order here before, simply enter your e-mail address and password and Sign In. If this is your first time shopping with us, please supply the required information and click Continue. <br> For PayPal Users: This is different than your PayPal Account.' where PageName = 'CustSignInCheckout.aspx']]></SQLServer>
  <SQLServer><![CDATA[alter table Admin Add PayPalFirstPartyCertificate int DEFAULT 0]]></SQLServer>
  <SQLServer><![CDATA[DELETE FROM Messages WHERE [Page]='ShoppingCart.aspx' AND [Action]='Error' AND [Condition]='PayPalError']]></SQLServer>
  <SQLServer><![CDATA[INSERT INTO [Messages] ([Page], [Action], [Condition], [Message]) values('ShoppingCart.aspx', 'Error', 'PayPalError', 'An Error occurred while processing your order with PayPal. Please use the default site CheckOut process to complete your order or you may contact the store administrator for assistance.')]]></SQLServer>
  <SQLServer><![CDATA[ ALTER TABLE Inventory Add Sku nvarchar(255)]]></SQLServer>
  <!--  PayPal -->
  <!-- SP7 HotFix -->
  <SQLServer><![CDATA[update OrderItems set BillingStartDate = '01/01/1990' where BillingStartDate IS NULL]]></SQLServer>
  <SQLServer><![CDATA[update Products set BillingDelay = 0 where BillingDelay IS NULL]]></SQLServer>
  <!-- SP8 -->
  <SQLServer><![CDATA[update paymentprocessors Set LiveServerPath='https://payments.verisign.com/payflowlink' where Name='VeriSignPayFlowLink']]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Admin Add PromoMailServer varchar(50)]]></SQLServer>
  <SQLServer><![CDATA[UPDATE Admin SET PromoMailServer = EmailServer WHERE PromoMailServer IS NULL]]></SQLServer>
  <!-- Tee 7/13/2007 manufacturer activation feature -->
  <SQLServer><![CDATA[ALTER TABLE Manufacturers Add Active INT NOT NULL DEFAULT 1 WITH VALUES]]></SQLServer>
  <SQLServer><![CDATA[UPDATE Manufacturers SET Active = 1 WHERE AddressID = 1]]></SQLServer>
  <!-- Tee 7/16/2007 clearance feature -->
  <SQLServer><![CDATA[ALTER TABLE Products Add IsOnClearance INT DEFAULT 0]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Products Add SaleType INT DEFAULT 0]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Labels ADD [ClearancePrice] nvarchar(50)]]></SQLServer>
  <SQLServer><![CDATA[UPDATE Labels SET ClearancePrice = 'Clearance Price' WHERE uid = 1]]></SQLServer>
  <!-- Tee 7/17/2007 SF69 Product Configurator -->
  <SQLServer><![CDATA[INSERT into MerchantToolsMenuDetails Values(3,'Merchant Bundles','ManageProducts.aspx?ProdType=2',6,0)]]></SQLServer>
  <SQLServer><![CDATA[INSERT into MerchantToolsMenuDetails Values(3,'Customer Defined Bundles','ManageProducts.aspx?ProdType=4',7,0)]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Products ADD ProductType INT DEFAULT 0 NOT NULL]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Products Add BundleGroupID INT DEFAULT 0 NULL]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Products Add BundleDisplayName NVARCHAR(50) NULL]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Products Add ComputePrice INT DEFAULT 0]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Products Add PriceUp INT DEFAULT 0]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Products Add PriceChangedAmount NVARCHAR(20) NULL]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Products Add PriceChangedType INT DEFAULT 0]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE ShoppingCartItems ADD BLOB IMAGE]]></SQLServer>
  <SQLServer><![CDATA[CREATE TABLE BundleGroups ([uid] [int] IDENTITY(1,1) PRIMARY KEY NOT NULL, [BundleGroupName] nvarchar(100) NOT NULL)]]></SQLServer>
  <SQLServer><![CDATA[CREATE TABLE ProductsBundle (uid INT PRIMARY KEY IDENTITY NOT NULL, ProductID int NOT NULL, BundleID int NOT NULL, Qty int NOT NULL DEFAULT 1, DisplayOrder INT NOT NULL DEFAULT 1)]]></SQLServer>
  <SQLServer><![CDATA[CREATE TABLE [BundleTemplateDetail] (
	[uid] [int] IDENTITY (1, 1) NOT NULL PRIMARY KEY,
	[ProductID] [int] NOT NULL,
	[StepName] [nvarchar] (50) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL DEFAULT '',
	[SelectableQty] [int] NOT NULL DEFAULT 1,
	[DisplayOrder] [int] NOT NULL DEFAULT 0
	) ON [PRIMARY]
  ]]></SQLServer>
  <SQLServer><![CDATA[CREATE TABLE [BundleProductDetail] (
	[uid] [int] IDENTITY (1, 1) NOT NULL PRIMARY KEY,
	[StepID] [int] NOT NULL DEFAULT 0,
	[ProductID] [int] NOT NULL DEFAULT 0,
	[Quantity] [int] NOT NULL DEFAULT 1,
	[DisplayOrder] [INT] NOT NULL DEFAULT 1
	) ON [PRIMARY]
  ]]></SQLServer>
  <SQLServer><![CDATA[CREATE TABLE [BundleOrderItems] (
	[uid] [int] IDENTITY (1, 1) NOT NULL PRIMARY KEY,
	[OrderItemID] [int] NOT NULL DEFAULT 0,
	[ProductID] [int] NOT NULL DEFAULT 0,
	[Quantity] [int] NULL
  ) ON [PRIMARY]]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE OrderItemsAttributes ADD BundleOrderItemID INT DEFAULT 0]]></SQLServer>
  <!-- Tee 9/19/2007 bug 367, change categories description size to 2000-->
  <SQLServer><![CDATA[ALTER TABLE Categories ALTER COLUMN Description NVARCHAR(2000)]]></SQLServer>
  <!-- end Tee -->
  <!-- Begin Mod Anonymous CheckOut -->
  <SQLServer><![CDATA[ALTER TABLE Admin Add AllowAnonymous bit not null default 0]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Admin Add AccountCreationAllowed bit not null default 0]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Walkin Add AnonymousSignIn bit]]></SQLServer>
  <!-- End Mod Anonymous Checkout -->
  <!-- Begin Mod Admin user management -->
  <!-- note some of the links have to be updated later ex return policy, privacypolicy, contactus -->
  <SQLServer><![CDATA[if not exists (select Uid from MerchantToolsMenuDetails where DisplayName='Manage Roles') Insert into MerchantToolsMenuDetails values(1,'Manage Roles','ManageUserRoles.aspx', 10,0)]]></SQLServer>
  <SQLServer><![CDATA[if not exists (select Uid from MerchantToolsMenuDetails where DisplayName='Manage Administrators') Insert into MerchantToolsMenuDetails values(1,'Manage Administrators','ManageAdministrators.aspx', 11,0)]]></SQLServer>
  <SQLServer><![CDATA[
  CREATE TABLE [UserRoles] (
	[uid] [int] IDENTITY (1, 1) PRIMARY KEY NOT NULL ,
	[Name] varchar(100) NOT NULL ,
	[IsSuper] bit not null default 0
) ON [PRIMARY]
]]></SQLServer>
  <SQLServer><![CDATA[
CREATE TABLE [Administrators] (
	[uid] [int] IDENTITY (1, 1) PRIMARY KEY NOT NULL ,
	[FirstName] varchar(50) NOT NULL ,
	[LastName] varchar(50) not null,
	[UserName] varchar(100) not null,
	[Password] varchar(500) not null,
	[RoleId] [int] not null,
	[IsSuperUser] bit not null default 0
	) ON [PRIMARY]
]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Administrators ADD NumFailedAttempt INT NOT NULL DEFAULT(0) WITH VALUES]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Administrators ADD isLocked BIT NOT NULL DEFAULT(0) WITH VALUES]]></SQLServer>
  <SQLServer><![CDATA[
CREATE TABLE [RoleTasks] (
	[uid] [int] IDENTITY (1, 1) PRIMARY KEY NOT NULL ,
	[RoleId] int not null,
	[TaskID] int not null,
	[TaskName] varchar(100) not null	
) ON [PRIMARY]
  ]]></SQLServer>
  <SQLServer><![CDATA[if exists (select * from sysobjects where id = object_id(N'[usp_UpdateUser]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
						drop procedure [usp_UpdateUser]
 ]]></SQLServer>
  <SQLServer><![CDATA[
create proc [usp_UpdateUser]
	@uid int,
	@Firstname varchar(50),
	@Lastname varchar(50),
	@Username varchar(100),
	@password varchar(500),
	@roleid int,
	@NumFailedAttempt int,
	@IsLocked int
as
begin
 declare @Issuper bit
 select @issuper = isSuper from  userroles where uid =@roleId
	if @uid =0 -- new Admin - check if admin does not exists create one else return 0 for error check
	begin
		if not exists (select uid from administrators where username=@username )
		begin		
			insert into Administrators
			values(@Firstname,@Lastname,@Username,@password,@roleId,isnull(@isSuper,0), @NumFailedAttempt, @IsLocked )
			if @@error <> 0
				set @uid = -1
			else
				set @Uid= @@identity 			
		end
		else set @Uid=0
		 
	end
	else if @uid >0 --Existing Admin - check if username/password is unique, update data else return 0
	begin
	    if not exists(select uid from administrators where username=@username and uid <> @uid)
		begin	    
		   update Administrators
		    set Firstname = @Firstname,
		    lastname = @Lastname,
		    username =@Username,
		    password = @password,
		    roleid= @roleId,
		    IsSuperUser = isnull(@isSuper,0),
		    NumFailedAttempt = @NumFailedAttempt,
		    IsLocked = @IsLocked
		    where uid =@uid
		    if @@error <> 0
			set @uid = -1
		  end
	     else set @Uid=0 
	end
	select @Uid
end
]]></SQLServer>
  <!-- End Mod Admin user management -->
  <!-- begin: JDB - 7/10/2007 - Customer Price Groups -->
  <SQLServer><![CDATA[
CREATE TABLE [CustomerPriceGroupCategories] (
	[uid] [int] IDENTITY (1, 1) PRIMARY KEY NOT NULL ,
	[CustomerPriceGroupId] [int] NOT NULL ,
	[CategoryId] [int] NOT NULL 
) ON [PRIMARY]
]]></SQLServer>
  <SQLServer><![CDATA[
CREATE TABLE [CustomerPriceGroupManufacturers] (
	[uid] [int] IDENTITY (1, 1) PRIMARY KEY NOT NULL ,
	[CustomerPriceGroupId] [int] NOT NULL ,
	[ManufacturerId] [int] NOT NULL 
) ON [PRIMARY]
]]></SQLServer>
  <SQLServer><![CDATA[
CREATE TABLE [CustomerPriceGroupVendors] (
	[uid] [int] IDENTITY (1, 1) PRIMARY KEY NOT NULL ,
	[CustomerPriceGroupId] [int] NOT NULL ,
	[VendorId] [int] NOT NULL 
) ON [PRIMARY]
]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE CustomerPriceGroups ADD AllProducts BIT NOT NULL DEFAULT(0) WITH VALUES]]></SQLServer>
  <!-- end: JDB - 7/10/2007 - Customer Price Groups -->
  <SQLServer><![CDATA[ALTER TABLE Categories Add SortOrder INT NULL]]></SQLServer>
  <!-- begin: GJV - 7/30/2007 - CSR -->
  <SQLServer><![CDATA[
  	if not exists (select Uid from MerchantToolsMenuDetails where DisplayName='Manage CSR Options') INSERT into MerchantToolsMenuDetails Values(1,'Manage CSR Options','employees.aspx',255,0)
  ]]></SQLServer>
  <SQLServer><![CDATA[
  	CREATE TABLE [Employees] (
	[uid] [int] PRIMARY KEY IDENTITY (1, 1) NOT NULL ,
	[UserName] [nvarchar] (255) NULL ,
	[PassWord] [nvarchar] (255) NULL ,
	) ON [PRIMARY]
  ]]></SQLServer>
  <SQLServer><![CDATA[
  	CREATE TABLE [CSROrders] (
	[uid] [int] IDENTITY (1, 1) PRIMARY KEY NOT NULL ,
	[OrderID] [int] NOT NULL ,
	[CSRID]  [int] NOT NULL 
	) ON [PRIMARY]
  ]]></SQLServer>
  <SQLServer><![CDATA[
    ALTER TABLE [Employees] ADD [OverridePricing] [BIT] NULL
  ]]></SQLServer>
  <SQLServer><![CDATA[
    ALTER TABLE [Employees] ADD [OverrideShippingCharges] [BIT] NULL
  ]]></SQLServer>
  <SQLServer><![CDATA[
    ALTER TABLE [Employees] ADD [OverrideTaxes] [BIT] NULL
  ]]></SQLServer>
  <!-- end: GJV - 7/30/2007 - CSR -->
  <!-- begin: JDB - Search Filters -->
  <SQLServer><![CDATA[
  	if not exists (select uid from MerchantToolsMenuDetails where DisplayName='Search Result Filters')
  	insert into MerchantToolsMenuDetails Values(3, 'Search Result Filters', 'SearchFilters.aspx', 8, 0)
  ]]></SQLServer>
  <SQLServer><![CDATA[
  CREATE TABLE [SearchFilters] (
    [uid] [int] IDENTITY (1, 1) PRIMARY KEY NOT NULL,
    [AttributeName] [nvarchar] (200) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
    [GlobalSelectorName] [nvarchar] (200) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL 
  ) ON [PRIMARY]
  ]]></SQLServer>
  <SQLServer><![CDATA[
  INSERT INTO Images(DesignId, [Name], [FileName])
  SELECT Designs.uid, 'FilterResults', 'filter_results.gif' FROM Designs
  LEFT OUTER JOIN Images ON Designs.uid = Images.DesignId AND Images.[Name] = 'FilterResults' WHERE Images.uid IS NULL
  ]]></SQLServer>
  <!-- end: JDB - Search Filters -->
  <!-- Start: Integration -->
  <SQLServer><![CDATA[CREATE TABLE Integration (uid int IDENTITY(0,1) primary key, LastExport datetime, LastOrderIDExported int)]]></SQLServer>
  <SQLServer><![CDATA[IF NOT EXISTS(SELECT * FROM Integration)INSERT INTO Integration (LastExport, LastOrderIDExported)VALUES('1/1/2000',0)]]></SQLServer>
  <SQLServer><![CDATA[CREATE TABLE IntegrationCustomers (uid int IDENTITY(0,1) primary key, CustomerUID int, AccountingNumber [nvarchar] (200))]]></SQLServer>
  <SQLServer><![CDATA[IF  EXISTS (SELECT * FROM sysobjects WHERE id = OBJECT_ID(N'[ufn_GetOrderItemSKU]') AND xtype in (N'FN', N'IF', N'TF'))
			DROP FUNCTION [ufn_GetOrderItemSKU]]]></SQLServer>
  <SQLServer><![CDATA[
CREATE FUNCTION [ufn_GetOrderItemSKU](@OrderItemId int)
	RETURNS varchar(50)
AS
BEGIN
	DECLARE
		@attributeId int,
		@AttributeIds varchar(1000),
		@ItemCode varchar(50)
		
	SET @ItemCode=''
	SET @AttributeIds= ''
	DECLARE crs_Attributes CURSOR READ_ONLY FOR 
		SELECT AttributeDetailId FROM orderitemsattributes WHERE OrderItemId = @OrderItemID 
		order by AttributeDetailId asc
	
	OPEN crs_Attributes
	
	FETCH NEXT FROM crs_Attributes INTO @attributeId
	WHILE @@FETCH_STATUS = 0
	BEGIN
		SET @AttributeIds = @AttributeIds + CONVERT(varchar,@attributeId) + ','
		FETCH NEXT FROM crs_Attributes INTO @attributeId
	END
	
	CLOSE crs_Attributes
	DEALLOCATE crs_Attributes
	
	IF LEN(@AttributeIds) > 0 
		SET @AttributeIds = SUBSTRING(@AttributeIds,0,LEN(@AttributeIds))
	
	SELECT @ItemCode  = SKU FROM Inventory WHERE AttributeDetailId =  @AttributeIds
	
	IF(@ItemCode IS NULL OR LEN(@ItemCode) <=0)
	BEGIN
		SELECT @ItemCode = ProductCode FROM OrderItems WHERE uid = @OrderItemId
	END
	RETURN(@ItemCode)
END	
		]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Integration ADD SubmitOrderToWebService BIT NULL DEFAULT 0]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Integration ADD NewOrderWebServiceUrl nvarchar(1000) NULL]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Integration ADD CheckInvOnAddToCart BIT NULL DEFAULT 0]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Integration ADD CheckInvOnOrderPlaced BIT NULL DEFAULT 0]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Integration ADD ProductCheckWebServiceUrl nvarchar(1000) NULL]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Integration ADD OutboundUsername nvarchar(255) NULL]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Integration ADD OutboundPassword nvarchar(255) NULL]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Integration ADD InboundUsername nvarchar(255) NULL]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Integration ADD InboundPassword nvarchar(255) NULL]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Integration ADD ErrorEmail nvarchar(255) NULL]]></SQLServer>
  <SQLServer><![CDATA[IF NOT EXISTS(SELECT * FROM MerchantToolsMenuDetails WHERE DisplayName = 'StoreFront Connector' )INSERT into MerchantToolsMenuDetails Values(4,'StoreFront Connector','wsmanagement.aspx',7,0)]]></SQLServer>
  <SQLServer><![CDATA[IF NOT EXISTS(SELECT * FROM Messages WHERE Page='ShoppingCart.aspx' AND Condition='OrderError') INSERT INTO [Messages] ([Page], [Action], [Condition], [Message]) values('ShoppingCart.aspx', 'OrderError', 'OrderError', 'Not all items could be ordered at this time, please review your order and try again.')]]></SQLServer>
  <SQLServer><![CDATA[IF NOT EXISTS(SELECT * FROM Messages WHERE Page='AddToCart' AND Condition='InventoryCheck') INSERT INTO [Messages] ([Page], [Action], [Condition], [Message]) values('AddToCart', 'InventoryCheck', 'InventoryCheck', 'The item cannot be ordered at this time, please try again later')]]></SQLServer>
  <SQLServer><![CDATA[IF NOT EXISTS(SELECT * FROM Messages WHERE Page='Payment.aspx' AND Condition='InventoryCheck') INSERT INTO [Messages] ([Page], [Action], [Condition], [Message]) values('Payment.aspx', 'InventoryCheck', 'InventoryCheck', 'The item(s) cannot be ordered at this time, please try again later')]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Orders ADD IntegrationExported bit NULL]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Orders ADD IntegrationComment text NULL]]></SQLServer>
  <!-- Start: RMS -->
  <SQLServer><![CDATA[CREATE Table TaxTypes (uid int PRIMARY KEY IDENTITY NOT NULL, TaxType nvarchar(25) NOT NULL, SFTaxType nvarchar(25) NOT NULL)]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Orders ADD RMSStatus int NULL]]></SQLServer>
  <SQLServer><![CDATA[
		CREATE TABLE [ImportXMLLog] (
		[uid] [int] IDENTITY (1, 1) NOT NULL PRIMARY KEY,
		[Action] [varchar] (50) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL ,
		[Date] [datetime] NOT NULL ,
		[XML] [ntext] COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL ,
	) ON [PRIMARY]
	]]></SQLServer>
  <!-- End: RMS -->
  <!-- End: Integration -->
  <!-- begin: JDB - CR 010 -->
  <SQLServer><![CDATA[
  IF NOT EXISTS(SELECT * FROM Messages WHERE [Page] = 'Help.aspx' AND [Action] = 'PageTitle' AND [Condition] = 'Title')
	INSERT INTO [Messages]  ([Page], [Action], [Condition], [Message]) VALUES ('Help.aspx', 'PageTitle', 'Title', 'Help')
  ]]></SQLServer>
  <SQLServer><![CDATA[
  UPDATE Instructions SET Instruction = 'Need HELP with this page?  <a href="help.aspx#' + CAST(uid AS VARCHAR(2)) + '">Click here</a>' WHERE PageName NOT IN ('Confirm.aspx', 'Confirm.aspx(PF)')
  ]]></SQLServer>
  <!-- end: JDB - CR 010 -->
  <!-- begin: GJV - 9/7/2007 - Component License -->
  <SQLServer><![CDATA[ALTER TABLE Admin ADD ComponentLicense ntext NULL]]></SQLServer>
  <!-- end: GJV - 9/7/2007 - Component License -->
  <!-- begin: JDB - Dynamic Image Suite -->
  <SQLServer><![CDATA[ALTER TABLE Inventory ADD Valid BIT NOT NULL DEFAULT(1) WITH VALUES]]></SQLServer>
  <SQLServer><![CDATA[
IF  EXISTS (SELECT * FROM sysobjects WHERE id = OBJECT_ID(N'[Swatch]') AND type in (N'U'))
	BEGIN
	ALTER TABLE [Swatch] ADD [Name] [nvarchar] (1000) NULL
	ALTER TABLE [Swatch] ADD [Thumbnail] [nvarchar] (255) NULL
	ALTER TABLE [Swatch] ADD [AttributeNames] [nvarchar] (1000) NULL
	END
ELSE
	BEGIN
	CREATE TABLE [Swatch] (
		[uid] [int] IDENTITY (1, 1) NOT NULL ,
		[ProductID] [int] NULL ,
		[Name] [nvarchar] (1000) NULL,
		[LittleImage] [nvarchar] (255) NULL,
		[LargeImage] [nvarchar] (255) NULL,
		[ThumbnailImage] [nvarchar] (255) NULL,
		[CloseUpImage] [nvarchar] (255) NULL,
		[ShowDescription] [int]  NULL,
		[ShowSelectedDescription] [int]  NULL,
		[ShowImage] [int]  NULL,
		[SortOrder] [int]  NULL,
		[Description] [nvarchar] (255) NULL,
		[AttributeNames] [nvarchar] (1000) NULL
	) ON [PRIMARY]
	END
]]></SQLServer>
  <SQLServer><![CDATA[
ALTER TABLE [Swatch] WITH NOCHECK ADD 
	CONSTRAINT [PK_Swatch] PRIMARY KEY  CLUSTERED 
	(
		[uid]
	)  ON [PRIMARY] 
]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Products ADD SwatchesPerRow Integer NULL]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Products ADD RelatedImage nvarchar(50) NULL]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Products ADD CloseUpImage nvarchar(255) NULL]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Products ADD CloseUpLinkText nvarchar(255) NULL]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Products ADD ChangeOnClick Integer NULL]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Products ADD ChangeOnMouseover Integer NULL]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Products ADD ShowCloseUpLink Integer NULL]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Products ADD LinkBigImage Integer NULL]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Products ADD SwatchAllignment Integer NULL]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE Products ADD DescriptionAllignment Integer NULL]]></SQLServer>
  <!-- end: JDB - Dynamic Image Suite -->
  <!-- begin: JDB - Advanced Coupon Functionality -->
  <SQLServer><![CDATA[
CREATE TABLE [OrderDiscounts] (
	[uid] [int] IDENTITY (1, 1) NOT NULL PRIMARY KEY,
	[DiscountID] [int] NOT NULL,
	[Name] [nvarchar] (50) NOT NULL,
	[Description] [nvarchar] (100) NOT NULL,
	[Code] [nvarchar] (100) NULL
)
]]></SQLServer>
  <SQLServer><![CDATA[
CREATE TABLE [OrderItemDiscounts] (
	[uid] [int] IDENTITY (1, 1) NOT NULL PRIMARY KEY,
	[OrderDiscountID] [int] NOT NULL ,
	[OrderItemID] [int] NOT NULL ,
	[DiscountAmount] [decimal](19, 2) NOT NULL 
)
]]></SQLServer>
  <!-- end: JDB - Advanced Coupon Functionality -->
  <!-- begin: GJV - 9/7/2007 - OSP merge -->
  <!-- START OSP -->
  <SQLServer><![CDATA[CREATE TABLE [LayoutPreview] (
	[uid] [int] IDENTITY (1, 1) NOT NULL ,
	[DesignID] [int] NULL ,
	[Name] [nvarchar] (50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL ,
	[TableWidth] [nvarchar] (50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL ,
	[CellPadding] [nvarchar] (50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL ,
	[CellSpacing] [nvarchar] (50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL ,
	[BorderSize] [nvarchar] (50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL ,
	[BorderColor] [nvarchar] (10) COLLATE SQL_Latin1_General_CP1_CI_AS NULL ,
	[HorizontalAlignment] [nvarchar] (50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL ,
	[VerticalAlignment] [nvarchar] (50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL ,
	[TopMargin] [int] NULL ,
	[RightMargin] [int] NULL ,
	[BottomMargin] [int] NULL ,
	[LeftMargin] [int] NULL ,
	[BackgroundImageURL] [nvarchar] (255) COLLATE SQL_Latin1_General_CP1_CI_AS NULL ,
	[BackgroundColor] [nvarchar] (10) COLLATE SQL_Latin1_General_CP1_CI_AS NULL ,
	[FontFace] [nvarchar] (50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL ,
	[FontSize] [int] NULL ,
	[FontColor] [nvarchar] (10) COLLATE SQL_Latin1_General_CP1_CI_AS NULL ,
	[FontStyle] [nvarchar] (50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL ,
	[ImageURL] [nvarchar] (255) COLLATE SQL_Latin1_General_CP1_CI_AS NULL ,
	[DisplayStyle] [int] NULL ,
	[Visible] [int] NULL ,
	 PRIMARY KEY  CLUSTERED 
	(
		[uid]
	)  ON [PRIMARY] 
) ON [PRIMARY]]]></SQLServer>
  <SQLServer><![CDATA[CREATE TABLE [MenuBarPreview] (
	[uid] [int] IDENTITY (1, 1) NOT NULL ,
	[DesignID] [int] NULL ,
	[PageName] [nvarchar] (50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL ,
	[MenuText] [nvarchar] (50) COLLATE SQL_Latin1_General_CP1_CI_AS NULL ,
	[MenuImage] [nvarchar] (255) COLLATE SQL_Latin1_General_CP1_CI_AS NULL ,
	[MenuOffImage] [nvarchar] (255) COLLATE SQL_Latin1_General_CP1_CI_AS NULL ,
	[Link] [nvarchar] (255) COLLATE SQL_Latin1_General_CP1_CI_AS NULL ,
	[MenuPosition] [int] NULL ,
	[LinkVisibility] [int] NULL ,
	[OrderPosition] [int] NULL ,
	 PRIMARY KEY  CLUSTERED 
	(
		[uid]
	)  ON [PRIMARY] 
) ON [PRIMARY]]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE ProductDetail ADD DisplayAddToCart integer NOT NULL DEFAULT 1]]></SQLServer>
  <SQLServer><![CDATA[INSERT INTO MerchantToolsMenuHeaders Values('Store Design',4)]]></SQLServer>
  <SQLServer><![CDATA[INSERT into MerchantToolsMenuDetails Values(5,'Layout Templates','CatalogGeneral.aspx',2,0)]]></SQLServer>
  <SQLServer><![CDATA[INSERT into MerchantToolsMenuDetails Values(5,'Themes','ManageThemes.aspx',3,0)]]></SQLServer>
  <!-- END OSP -->
  <SQLServer><![CDATA[ALTER TABLE [Designs] ADD [Path] NVARCHAR(255) NULL DEFAULT N'~/' WITH VALUES]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE [Designs] ADD [Group] NVARCHAR(100) NULL]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE [Designs] ADD [Thumbnail] NVARCHAR(255) NULL]]></SQLServer>
  <SQLServer><![CDATA[ALTER TABLE [Designs] ADD [Categories] NVARCHAR(50) NULL]]></SQLServer>
  <SQLServer><![CDATA[  
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[sp_AddStoreFrontDesign]') AND type in (N'P', N'PC'))
BEGIN
	DROP PROCEDURE [sp_AddStoreFrontDesign]
END
  ]]></SQLServer>
  <SQLServer><![CDATA[ 
CREATE PROCEDURE [sp_AddStoreFrontDesign] 
	@name		NVARCHAR(100),
	@theme		NVARCHAR(50),
	@subTheme	NVARCHAR(50),
	@categories NVARCHAR(50),
	@id			INT OUTPUT
AS
BEGIN

	DECLARE @path		NVARCHAR(255)

	IF @theme IS NULL
	BEGIN
		SET @subTheme = NULL
	END

	SET @path = '~/themes/StoreFront/' + 
		CASE WHEN @theme IS NULL THEN N'' ELSE @theme + N'/' END + 
		CASE WHEN @subTheme IS NULL THEN N'' ELSE @subTheme + N'/' END

	EXEC sp_AddDesign @name, @path, @theme, @categories, @id OUT

END
  ]]></SQLServer>
  <SQLServer><![CDATA[ 
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[sp_AddCustomDesign]') AND type in (N'P', N'PC'))
BEGIN
	DROP PROCEDURE [sp_AddCustomDesign]
END
  ]]></SQLServer>
  <SQLServer><![CDATA[ 
CREATE PROCEDURE [sp_AddCustomDesign] 
	@name		NVARCHAR(100),
	@theme		NVARCHAR(50),
	@subTheme	NVARCHAR(50),
	@categories NVARCHAR(50),
	@id			INT OUTPUT
AS
BEGIN

	DECLARE @path		NVARCHAR(255)

	IF @theme IS NULL
	BEGIN
		SET @subTheme = NULL
	END

	SET @path = '~/themes/Custom/' + 
		CASE WHEN @theme IS NULL THEN N'' ELSE @theme + N'/' END + 
		CASE WHEN @subTheme IS NULL THEN N'' ELSE @subTheme + N'/' END

	EXEC sp_AddDesign @name, @path, @theme, @categories, @id OUT

END
  ]]></SQLServer>
  <SQLServer><![CDATA[ 
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[sp_AddDesign]') AND type in (N'P', N'PC'))
	DROP PROCEDURE [sp_AddDesign]
  ]]></SQLServer>
  <SQLServer><![CDATA[ 
CREATE PROCEDURE [sp_AddDesign]
	@name		NVARCHAR(100),
	@path		NVARCHAR(255),
	@group		NVARCHAR(100),
	@categories	NVARCHAR(50),
	@id			INT	OUTPUT
AS
BEGIN

	DECLARE @thumbnail	NVARCHAR(255)

	SET @thumbnail = @path + 'thumbnail.jpg'

	-- check for the records existance
	SELECT	@id = [uid] 
	FROM	[Designs] 
	WHERE	UPPER([Name]) = UPPER(@name)

	IF @id IS NULL
	BEGIN

		-- this record does not exist; insert it and retrieve its identity
		INSERT INTO	[Designs] ([Name], [IsActive], [Path], [Thumbnail], [Group], [Categories]) 
		VALUES		(@name, 0, @path, @thumbnail, @group, @categories)

		SET @id = scope_identity()

	END
	ELSE
	BEGIN

		-- the record exists; update it
		UPDATE	[Designs] 
		SET		[Name] = @name, [Path] = @path, [Thumbnail] = @Thumbnail, [Group] = @group, [Categories] = @categories
		WHERE	[uid] = @id

	END

END
  ]]></SQLServer>
  <SQLServer><![CDATA[ 
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[sp_AddImage]') AND type in (N'P', N'PC'))
	DROP PROCEDURE [sp_AddImage]
  ]]></SQLServer>
  <SQLServer><![CDATA[ 
CREATE PROCEDURE [sp_AddImage]
		@designId	INT,
		@name		NVARCHAR(50),
		@filename	NVARCHAR(50)
AS
BEGIN

	DECLARE @id	INT

	-- check for the records existance
	SELECT	@id = [uid] 
	FROM	[Images] 
	WHERE	[DesignId] = @designId AND UPPER([Name]) = UPPER(@name)

	IF @id IS NULL
	BEGIN

		-- this record does not exist; insert it and retrieve its identity
		INSERT INTO	[Images] ([DesignId], [Name], [FileName]) 
		VALUES		(@designId, @name, @filename)

	END
	ELSE
	BEGIN

		-- the record exists; update it
		UPDATE	[Images] 
		SET		[DesignId] = @designId, [Name] = @name, [FileName] = @filename
		WHERE	[uid] = @id

	END

END
  ]]></SQLServer>
  <SQLServer><![CDATA[ 
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[sp_AddLayout]') AND type in (N'P', N'PC'))
	DROP PROCEDURE [sp_AddLayout]
  ]]></SQLServer>
  <SQLServer><![CDATA[ 
CREATE PROCEDURE [sp_AddLayout]
	@designId				INT,
	@name					NVARCHAR(50),
	@tableWidth				NVARCHAR(50),
	@cellPadding			NVARCHAR(50),
	@cellSpacing			NVARCHAR(50),
	@borderSize				NVARCHAR(50),
	@borderColor			NVARCHAR(10),
	@horizontalAlignment	NVARCHAR(50),
	@verticalAlignment		NVARCHAR(50),
	@topMargin				INT,
	@rightMargin			INT,
	@bottomMargin			INT,
	@leftMargin				INT,
	@backgroundImageUrl		NVARCHAR(255),
	@backgroundColor		NVARCHAR(10),
	@fontFace				NVARCHAR(50),
	@fontSize				INT,
	@fontColor				NVARCHAR(10),
	@fontStyle				NVARCHAR(50),
	@imageUrl				NVARCHAR(255),
	@displayStyle			INT,
	@visible				INT
AS
BEGIN

	DECLARE @id	INT

	-- check for the records existance
	SELECT	@id = [uid] 
	FROM	[Layout] 
	WHERE	[DesignId] = @designId AND UPPER([Name]) = UPPER(@name)

	IF @id IS NULL
	BEGIN

		-- this record does not exist; insert it and retrieve its identity
		INSERT INTO	[Layout] ([DesignId], [Name], [TableWidth], [CellPadding],
			[CellSpacing], [BorderSize], [BorderColor], [HorizontalAlignment],
			[VerticalAlignment], [TopMargin], [RightMargin], [BottomMargin], 
			[LeftMargin], [BackgroundImageUrl], [BackgroundColor], [FontFace], 
			[FontSize], [FontColor], [FontStyle], [ImageUrl], [DisplayStyle], 
			[Visible]) 
		VALUES		(@designId, @name, @tableWidth, @cellPadding, 
			@cellSpacing, @borderSize, @borderColor, @horizontalAlignment, 
			@verticalAlignment, @topMargin, @rightMargin, @bottomMargin, 
			@leftMargin, @backgroundImageUrl, @backgroundColor, @fontFace, 
			@fontSize, @fontColor, @fontStyle, @imageUrl, @DisplayStyle, 
			@visible)

	END
	ELSE
	BEGIN

		-- the record exists; update it
		UPDATE	[Layout] 
		SET		[DesignId] = @designId, [Name] = @name, 
			[TableWidth] = @tableWidth, [CellPadding] = @cellPadding, 
			[CellSpacing] = @cellSpacing, [BorderSize] = @borderSize, 
			[BorderColor] = @borderColor, 
			[HorizontalAlignment] = @horizontalAlignment, 
			[VerticalAlignment] = @verticalAlignment, [TopMargin] = @topMargin,
			[RightMargin] = @rightMargin, [BottomMargin] = @bottomMargin, 
			[LeftMargin] = @leftMargin, 
			[BackgroundImageURL] = @backgroundImageUrl, 
			[BackgroundColor] = @backgroundColor, [FontFace] = @fontFace, 
			[FontStyle] = @fontStyle, [ImageURL] = @imageUrl, 
			[DisplayStyle] = @displayStyle, [Visible] = @visible
		WHERE	[uid] = @id

	END

END
  ]]></SQLServer>
  <SQLServer><![CDATA[ 
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[sp_AddMenuBar]') AND type in (N'P', N'PC'))
	DROP PROCEDURE [sp_AddMenuBar]
  ]]></SQLServer>
  <SQLServer><![CDATA[ 
CREATE PROCEDURE [sp_AddMenuBar]
	@designId		INT,
	@pageName		NVARCHAR(50),
	@menuText		NVARCHAR(50),
	@menuImage		NVARCHAR(255),
	@menuOffImage	NVARCHAR(255),
	@link			NVARCHAR(255),
	@menuPosition	INT,
	@linkVisibility	INT,
	@orderPosition	INT
AS
BEGIN

	DECLARE @id	INT

	-- check for the records existance
	SELECT	@id = [uid] 
	FROM	[MenuBar] 
	WHERE	[DesignId] = @designId AND 
			UPPER([PageName]) = UPPER(@pageName) AND 
			UPPER([MenuText]) = UPPER(@menuText)

	IF @id IS NULL
	BEGIN

		IF	(UPPER(@menuText) <> N'CATEGORIES' AND UPPER(@menuText) <> N'ALL CATEGORIES') OR
			(UPPER(@menuText) = N'CATEGORIES' OR UPPER(@menuText) = N'ALL CATEGORIES' AND 
				NOT EXISTS (
					SELECT	*
					FROM	[MenuBar]
					WHERE	[DesignID] = @designID AND
							[MenuPosition] = @menuPosition AND 
							(UPPER([MenuText]) = N'CATEGORIES' OR UPPER([MenuText]) = N'ALL CATEGORIES')
					)
			)
		BEGIN

			-- this record does not exist; insert it and retrieve its identity
			INSERT INTO	[MenuBar] ([DesignId], [PageName], [MenuText], 
				[MenuImage], [MenuOffImage], [Link], [MenuPosition], 
				[LinkVisibility], [OrderPosition]) 
			VALUES		(@designId, @pageName, @menuText, @menuImage, 
				@menuOffImage, @link, @menuPosition, @linkVisibility, 
				@orderPosition)

		END

	END
	ELSE
	BEGIN

		-- the record exists; update it
		UPDATE	[MenuBar] 
		SET		[DesignId] = @designId, [PageName] = @pageName, 
			[MenuText] = @menuText, [MenuImage] = @menuImage, 
			[MenuOffImage] = @menuOffImage, [Link] = @link, 
			[MenuPosition] = @menuPosition, [LinkVisibility] = @linkVisibility,
			[OrderPosition] = @orderPosition
		WHERE	[uid] = @id

	END

END
  ]]></SQLServer>
  <SQLServer><![CDATA[ 
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[sp_AddStoreFrontDesign]') AND type in (N'P', N'PC'))
	DROP PROCEDURE [sp_AddStoreFrontDesign]
  ]]></SQLServer>
  <SQLServer><![CDATA[ 
CREATE PROCEDURE [sp_AddStoreFrontDesign] 
	@name		NVARCHAR(100),
	@theme		NVARCHAR(50),
	@subTheme	NVARCHAR(50),
	@categories NVARCHAR(50),
	@id			INT OUTPUT
AS
BEGIN

	DECLARE @path		NVARCHAR(255)

	IF @theme IS NULL
	BEGIN
		SET @subTheme = NULL
	END

	SET @path = '~/themes/StoreFront/' + 
		CASE WHEN @theme IS NULL THEN N'' ELSE @theme + N'/' END + 
		CASE WHEN @subTheme IS NULL THEN N'' ELSE @subTheme + N'/' END

	EXEC sp_AddDesign @name, @path, @theme, @categories, @id OUT

END
  ]]></SQLServer>
  <!-- end: GJV - 9/7/2007 - OSP merge -->
  <SQLServer><![CDATA[ 
ALTER TABLE Categories ADD Featured BIT NOT NULL DEFAULT(0) WITH VALUES
]]></SQLServer>
  <SQLServer><![CDATA[ 
CREATE TABLE [CustomerDefinedBundleRules] (
	[uid] [int] IDENTITY (1, 1) NOT NULL PRIMARY KEY,
	[ProductID] [int] NOT NULL ,
	[BundleRuleDetail] [varchar] (1000) NOT NULL 
) ON [PRIMARY]
]]></SQLServer>
  <SQLServer><![CDATA[ 
CREATE TABLE [HomePage] (
	[uid] [int] IDENTITY (1, 1) NOT NULL PRIMARY KEY,
	[IsActive] [bit] NOT NULL 
) ON [PRIMARY]
]]></SQLServer>
  <SQLServer><![CDATA[ 
SET IDENTITY_INSERT [HomePage] ON
IF NOT EXISTS(SELECT * FROM HomePage WHERE uid = 1)
	INSERT INTO [HomePage] ([uid], [IsActive]) VALUES (1, 1)
IF NOT EXISTS(SELECT * FROM HomePage WHERE uid = 2)
	INSERT INTO [HomePage] ([uid], [IsActive]) VALUES (2, 0)
IF NOT EXISTS(SELECT * FROM HomePage WHERE uid = 3)
	INSERT INTO [HomePage] ([uid], [IsActive]) VALUES (3, 0)
SET IDENTITY_INSERT [HomePage] OFF
]]></SQLServer>
  <SQLServer><![CDATA[ 
CREATE TABLE [ImagesPreview] (
	[uid] [int] IDENTITY (1, 1) NOT NULL PRIMARY KEY,
	[DesignID] [int] NULL ,
	[Name] [nvarchar] (50) NULL ,
	[Filename] [nvarchar] (255) NULL 
) ON [PRIMARY]
]]></SQLServer>
  <!-- Merchant Tools Menu Details -->
  <SQLServer><![CDATA[ 
IF NOT EXISTS(SELECT * FROM Messages WHERE Page = 'AttributeMessage' AND Action = 'LastAttributeValue' AND Condition = 'InvalidOrOutOfStock')
	INSERT INTO [Messages] ([Page], [Action], [Condition], [Message]) VALUES ('AttributeMessage','LastAttributeValue','InvalidOrOutOfStock', 'The selected value for [AttributeName] is unavailable with the other selected values.')
IF NOT EXISTS(SELECT * FROM Messages WHERE Page = 'AttributeMessage' AND Action = 'Combination' AND Condition = 'Invalid')
	INSERT INTO [Messages] ([Page], [Action], [Condition], [Message]) VALUES ('AttributeMessage','Combination','Invalid', '(Unavailable)')
IF NOT EXISTS(SELECT * FROM Messages WHERE Page = 'AttributeMessage' AND Action = 'StockStatus' AND Condition = 'OutOfStock')
	INSERT INTO [Messages] ([Page], [Action], [Condition], [Message]) VALUES ('AttributeMessage','StockStatus','OutOfStock', '(Out of Stock)')
]]></SQLServer>
  <!-- begin - Theme1 - Blue -->
  <!-- note - Theme1 designs should not be installed until design has updated -->
  <SQLServer><![CDATA[
DECLARE @designId INT

-- sp_AddDesign inserts the record into the Designs table or updates if a record with
-- the same name exists. This procedure returns the design id used by this theme.
EXEC sp_AddStoreFrontDesign N'Theme 1 - Blue', N'Theme1', N'Blue', N'Theme 1', @designId OUT

-- sp_AddImage inserts the record into the Images table or updates if a record with
-- the same name and design id exists.
EXEC sp_AddImage @designId, N'Add', N'buttons/add.gif'
EXEC sp_AddImage @designId, N'AddAddress', N'buttons/add_addresses.gif'
EXEC sp_AddImage @designId, N'AddToOrder', N'buttons/add_to_cart.gif'
EXEC sp_AddImage @designId, N'AddToSavedCart', N'buttons/addtosavedcart.gif'
EXEC sp_AddImage @designId, N'Apply', N'buttons/apply.gif'
EXEC sp_AddImage @designId, N'BuyNow', N'buttons/buy_now.gif'
EXEC sp_AddImage @designId, N'Cancel', N'buttons/cancel.gif'
EXEC sp_AddImage @designId, N'CheckOut', N'buttons/checkout.gif'
EXEC sp_AddImage @designId, N'Clear', N'buttons/clear.gif'
EXEC sp_AddImage @designId, N'Close', N'buttons/close.gif'
EXEC sp_AddImage @designId, N'CompleteOrder', N'buttons/complete_order.gif'
EXEC sp_AddImage @designId, N'Continue', N'buttons/continue.gif'
EXEC sp_AddImage @designId, N'CreateAccount', N'buttons/continue.gif'
EXEC sp_AddImage @designId, N'Delete', N'buttons/delete.gif'
EXEC sp_AddImage @designId, N'Edit', N'buttons/edit.gif'
EXEC sp_AddImage @designId, N'EmailFriend', N'buttons/email_friend.gif'
EXEC sp_AddImage @designId, N'FilterResults', N'buttons/filter_results.gif'
EXEC sp_AddImage @designId, N'GiftWrap', N'buttons/gift_wrap.gif'
EXEC sp_AddImage @designId, N'LagardeLogo', N'ft-lagarde.gif'
EXEC sp_AddImage @designId, N'ManageAddresses', N'buttons/manage_addresses.gif'
EXEC sp_AddImage @designId, N'Remove', N'buttons/remove.gif'
EXEC sp_AddImage @designId, N'ReOrder', N'buttons/reorder.gif'
EXEC sp_AddImage @designId, N'Save', N'buttons/save.gif'
EXEC sp_AddImage @designId, N'SaveCart', N'buttons/save_cart.gif'
EXEC sp_AddImage @designId, N'Search', N'buttons/icon_go.gif'
EXEC sp_AddImage @designId, N'Send', N'buttons/send.gif'
EXEC sp_AddImage @designId, N'SignIn', N'buttons/sign_in.gif'
EXEC sp_AddImage @designId, N'SignOut', N'buttons/sign_out.gif'
EXEC sp_AddImage @designId, N'Track', N'buttons/track.gif'
EXEC sp_AddImage @designId, N'UpdateQuantity', N'buttons/update_quantity.gif'
EXEC sp_AddImage @designId, N'View', N'buttons/view.gif'
EXEC sp_AddImage @designId, N'ViewAndPrintReceipt', N'buttons/viewandprintreceipt.gif'

-- sp_AddLayout inserts the record into the Layout table or updates if a record with
-- the same name and design id exists.
EXEC sp_AddLayout @designId, N'BodyTable', NULL, NULL, NULL, NULL, NULL, N'Center', NULL, 0, 0, 0, 0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Content', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'ContentTableHeader', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'ErrorMessages', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Footer', NULL, NULL, NULL, NULL, NULL, N'Left', N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, 1
EXEC sp_AddLayout @designId, N'Headings', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Instruction', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'LeftColumn', NULL, NULL, NULL, NULL, NULL, N'Left', N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, 0
EXEC sp_AddLayout @designId, N'Messages', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'RightColumn', N'15', NULL, NULL, NULL, NULL, N'Left', N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, N'#000000', N'Normal', NULL, NULL, 1
EXEC sp_AddLayout @designId, N'TopBanner', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, 0, 1
EXEC sp_AddLayout @designId, N'TopSubBanner', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, 0, 1

-- sp_AddMenuBar inserts the record into the MenuBar table or updates if a record with
-- the same page name, menu text and design id exists.
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Categories', NULL, NULL, N'SearchResult.aspx?CategoryID=', 2, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Home', NULL, NULL, N'default.aspx', 0, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Categories', NULL, NULL, N'SearchResult.aspx?CategoryID=', 1, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Home', NULL, N'default.aspx', 3, 0, 1
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'About Us', NULL, N'about.aspx', 3, 0, 2
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Contact Us', NULL, N'contact.aspx', 3, 0, 3
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'FAQ', NULL, N'faq.aspx', 3, 0, 4
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Privacy Policy', NULL, N'privacy-policy.aspx', 3, 0, 5
]]></SQLServer>
  <!-- end - Theme1 - Blue -->
  <!-- begin - Theme1 - Green -->
  <!-- note - Theme1 designs should not be installed until design has updated -->
  <SQLServer><![CDATA[
DECLARE @designId INT

-- sp_AddDesign inserts the record into the Designs table or updates if a record with
-- the same name exists. This procedure returns the design id used by this theme.
EXEC sp_AddStoreFrontDesign N'Theme 1 - Green', N'Theme1', N'Green', N'Theme 1', @designId OUT

-- sp_AddImage inserts the record into the Images table or updates if a record with
-- the same name and design id exists.
EXEC sp_AddImage @designId, N'Add', N'buttons/add.gif'
EXEC sp_AddImage @designId, N'AddAddress', N'buttons/add_addresses.gif'
EXEC sp_AddImage @designId, N'AddToOrder', N'buttons/add_to_cart.gif'
EXEC sp_AddImage @designId, N'AddToSavedCart', N'buttons/addtosavedcart.gif'
EXEC sp_AddImage @designId, N'Apply', N'buttons/apply.gif'
EXEC sp_AddImage @designId, N'BuyNow', N'buttons/buy_now.gif'
EXEC sp_AddImage @designId, N'Cancel', N'buttons/cancel.gif'
EXEC sp_AddImage @designId, N'CheckOut', N'buttons/checkout.gif'
EXEC sp_AddImage @designId, N'Clear', N'buttons/clear.gif'
EXEC sp_AddImage @designId, N'Close', N'buttons/close.gif'
EXEC sp_AddImage @designId, N'CompleteOrder', N'buttons/complete_order.gif'
EXEC sp_AddImage @designId, N'Continue', N'buttons/continue.gif'
EXEC sp_AddImage @designId, N'CreateAccount', N'buttons/continue.gif'
EXEC sp_AddImage @designId, N'Delete', N'buttons/delete.gif'
EXEC sp_AddImage @designId, N'Edit', N'buttons/edit.gif'
EXEC sp_AddImage @designId, N'EmailFriend', N'buttons/email_friend.gif'
EXEC sp_AddImage @designId, N'FilterResults', N'buttons/filter_results.gif'
EXEC sp_AddImage @designId, N'GiftWrap', N'buttons/gift_wrap.gif'
EXEC sp_AddImage @designId, N'LagardeLogo', N'ft-lagarde.gif'
EXEC sp_AddImage @designId, N'ManageAddresses', N'buttons/manage_addresses.gif'
EXEC sp_AddImage @designId, N'Remove', N'buttons/remove.gif'
EXEC sp_AddImage @designId, N'ReOrder', N'buttons/reorder.gif'
EXEC sp_AddImage @designId, N'Save', N'buttons/save.gif'
EXEC sp_AddImage @designId, N'SaveCart', N'buttons/save_cart.gif'
EXEC sp_AddImage @designId, N'Search', N'buttons/icon_go.gif'
EXEC sp_AddImage @designId, N'Send', N'buttons/send.gif'
EXEC sp_AddImage @designId, N'SignIn', N'buttons/sign_in.gif'
EXEC sp_AddImage @designId, N'SignOut', N'buttons/sign_out.gif'
EXEC sp_AddImage @designId, N'Track', N'buttons/track.gif'
EXEC sp_AddImage @designId, N'UpdateQuantity', N'buttons/update_quantity.gif'
EXEC sp_AddImage @designId, N'View', N'buttons/view.gif'
EXEC sp_AddImage @designId, N'ViewAndPrintReceipt', N'buttons/viewandprintreceipt.gif'

-- sp_AddLayout inserts the record into the Layout table or updates if a record with
-- the same name and design id exists.
EXEC sp_AddLayout @designId, N'BodyTable', NULL, NULL, NULL, NULL, NULL, N'Center', NULL, 0, 0, 0, 0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Content', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'ContentTableHeader', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'ErrorMessages', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Footer', NULL, NULL, NULL, NULL, NULL, N'Left', N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, 1
EXEC sp_AddLayout @designId, N'Headings', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Instruction', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'LeftColumn', NULL, NULL, NULL, NULL, NULL, N'Left', N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, 0
EXEC sp_AddLayout @designId, N'Messages', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'RightColumn', N'15', NULL, NULL, NULL, NULL, N'Left', N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, N'#000000', N'Normal', NULL, NULL, 1
EXEC sp_AddLayout @designId, N'TopBanner', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, 0, 1
EXEC sp_AddLayout @designId, N'TopSubBanner', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, 0, 1

-- sp_AddMenuBar inserts the record into the MenuBar table or updates if a record with
-- the same page name, menu text and design id exists.
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Categories', NULL, NULL, N'SearchResult.aspx?CategoryID=', 2, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Home', NULL, NULL, N'default.aspx', 0, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Categories', NULL, NULL, N'SearchResult.aspx?CategoryID=', 1, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Home', NULL, N'default.aspx', 3, 0, 1
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'About Us', NULL, N'about.aspx', 3, 0, 2
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Contact Us', NULL, N'contact.aspx', 3, 0, 3
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'FAQ', NULL, N'faq.aspx', 3, 0, 4
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Privacy Policy', NULL, N'privacy-policy.aspx', 3, 0, 5
]]></SQLServer>
  <!-- end - Theme1 - Green -->
  <!-- begin - Theme1 - Red -->
  <!-- note - Theme1 designs should not be installed until design has updated -->
  <SQLServer><![CDATA[
DECLARE @designId INT

-- sp_AddDesign inserts the record into the Designs table or updates if a record with
-- the same name exists. This procedure returns the design id used by this theme.
EXEC sp_AddStoreFrontDesign N'Theme 1 - Red', N'Theme1', N'Red', N'Theme 1', @designId OUT

-- sp_AddImage inserts the record into the Images table or updates if a record with
-- the same name and design id exists.
EXEC sp_AddImage @designId, N'Add', N'buttons/add.gif'
EXEC sp_AddImage @designId, N'AddAddress', N'buttons/add_addresses.gif'
EXEC sp_AddImage @designId, N'AddToOrder', N'buttons/add_to_cart.gif'
EXEC sp_AddImage @designId, N'AddToSavedCart', N'buttons/addtosavedcart.gif'
EXEC sp_AddImage @designId, N'Apply', N'buttons/apply.gif'
EXEC sp_AddImage @designId, N'BuyNow', N'buttons/buy_now.gif'
EXEC sp_AddImage @designId, N'Cancel', N'buttons/cancel.gif'
EXEC sp_AddImage @designId, N'CheckOut', N'buttons/checkout.gif'
EXEC sp_AddImage @designId, N'Clear', N'buttons/clear.gif'
EXEC sp_AddImage @designId, N'Close', N'buttons/close.gif'
EXEC sp_AddImage @designId, N'CompleteOrder', N'buttons/complete_order.gif'
EXEC sp_AddImage @designId, N'Continue', N'buttons/continue.gif'
EXEC sp_AddImage @designId, N'CreateAccount', N'buttons/continue.gif'
EXEC sp_AddImage @designId, N'Delete', N'buttons/delete.gif'
EXEC sp_AddImage @designId, N'Edit', N'buttons/edit.gif'
EXEC sp_AddImage @designId, N'EmailFriend', N'buttons/email_friend.gif'
EXEC sp_AddImage @designId, N'FilterResults', N'buttons/filter_results.gif'
EXEC sp_AddImage @designId, N'GiftWrap', N'buttons/gift_wrap.gif'
EXEC sp_AddImage @designId, N'LagardeLogo', N'ft-lagarde.gif'
EXEC sp_AddImage @designId, N'ManageAddresses', N'buttons/manage_addresses.gif'
EXEC sp_AddImage @designId, N'Remove', N'buttons/remove.gif'
EXEC sp_AddImage @designId, N'ReOrder', N'buttons/reorder.gif'
EXEC sp_AddImage @designId, N'Save', N'buttons/save.gif'
EXEC sp_AddImage @designId, N'SaveCart', N'buttons/save_cart.gif'
EXEC sp_AddImage @designId, N'Search', N'buttons/icon_go.gif'
EXEC sp_AddImage @designId, N'Send', N'buttons/send.gif'
EXEC sp_AddImage @designId, N'SignIn', N'buttons/sign_in.gif'
EXEC sp_AddImage @designId, N'SignOut', N'buttons/sign_out.gif'
EXEC sp_AddImage @designId, N'Track', N'buttons/track.gif'
EXEC sp_AddImage @designId, N'UpdateQuantity', N'buttons/update_quantity.gif'
EXEC sp_AddImage @designId, N'View', N'buttons/view.gif'
EXEC sp_AddImage @designId, N'ViewAndPrintReceipt', N'buttons/viewandprintreceipt.gif'

-- sp_AddLayout inserts the record into the Layout table or updates if a record with
-- the same name and design id exists.
EXEC sp_AddLayout @designId, N'BodyTable', NULL, NULL, NULL, NULL, NULL, N'Center', NULL, 0, 0, 0, 0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Content', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'ContentTableHeader', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'ErrorMessages', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Footer', NULL, NULL, NULL, NULL, NULL, N'Left', N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, 1
EXEC sp_AddLayout @designId, N'Headings', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Instruction', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'LeftColumn', NULL, NULL, NULL, NULL, NULL, N'Left', N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, 0
EXEC sp_AddLayout @designId, N'Messages', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'RightColumn', N'15', NULL, NULL, NULL, NULL, N'Left', N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, N'#000000', N'Normal', NULL, NULL, 1
EXEC sp_AddLayout @designId, N'TopBanner', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, 0, 1
EXEC sp_AddLayout @designId, N'TopSubBanner', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, 0, 1

-- sp_AddMenuBar inserts the record into the MenuBar table or updates if a record with
-- the same page name, menu text and design id exists.
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Categories', NULL, NULL, N'SearchResult.aspx?CategoryID=', 2, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Home', NULL, NULL, N'default.aspx', 0, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Categories', NULL, NULL, N'SearchResult.aspx?CategoryID=', 1, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Home', NULL, N'default.aspx', 3, 0, 1
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'About Us', NULL, N'about.aspx', 3, 0, 2
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Contact Us', NULL, N'contact.aspx', 3, 0, 3
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'FAQ', NULL, N'faq.aspx', 3, 0, 4
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Privacy Policy', NULL, N'privacy-policy.aspx', 3, 0, 5
]]></SQLServer>
  <!-- end - Theme1 - Red -->
  <!-- begin - Theme4 - Green -->
  <SQLServer><![CDATA[

DECLARE @designId INT

-- sp_AddDesign inserts the record into the Designs table or updates if a record with
-- the same name exists. This procedure returns the design id used by this theme.
EXEC sp_AddStoreFrontDesign N'Theme 4 - Green', N'Theme4', N'Green', N'Theme 4', @designId OUT

-- sp_AddImage inserts the record into the Images table or updates if a record with
-- the same name and design id exists.
EXEC sp_AddImage @designId, N'Add', N'buttons/add.gif'
EXEC sp_AddImage @designId, N'AddAddress', N'buttons/add_addresses.gif'
EXEC sp_AddImage @designId, N'AddToOrder', N'buttons/add_to_cart.gif'
EXEC sp_AddImage @designId, N'AddToSavedCart', N'buttons/addtosavedcart.gif'
EXEC sp_AddImage @designId, N'Apply', N'buttons/apply.gif'
EXEC sp_AddImage @designId, N'BuyNow', N'buttons/buy_now.gif'
EXEC sp_AddImage @designId, N'Cancel', N'buttons/cancel.gif'
EXEC sp_AddImage @designId, N'CheckOut', N'buttons/checkout.gif'
EXEC sp_AddImage @designId, N'Clear', N'buttons/clear.gif'
EXEC sp_AddImage @designId, N'Close', N'buttons/close.gif'
EXEC sp_AddImage @designId, N'CompleteOrder', N'buttons/complete_order.gif'
EXEC sp_AddImage @designId, N'Continue', N'buttons/continue.gif'
EXEC sp_AddImage @designId, N'CreateAccount', N'buttons/continue.gif'
EXEC sp_AddImage @designId, N'Delete', N'buttons/delete.gif'
EXEC sp_AddImage @designId, N'Edit', N'buttons/edit.gif'
EXEC sp_AddImage @designId, N'EmailFriend', N'buttons/email_friend.gif'
EXEC sp_AddImage @designId, N'FilterResults', N'buttons/filter_results.gif'
EXEC sp_AddImage @designId, N'GiftWrap', N'buttons/gift_wrap.gif'
EXEC sp_AddImage @designId, N'LagardeLogo', N'ft-logo_lagarde.gif'
EXEC sp_AddImage @designId, N'ManageAddresses', N'buttons/manage_addresses.gif'
EXEC sp_AddImage @designId, N'Remove', N'buttons/remove.gif'
EXEC sp_AddImage @designId, N'ReOrder', N'buttons/reorder.gif'
EXEC sp_AddImage @designId, N'Save', N'buttons/save.gif'
EXEC sp_AddImage @designId, N'SaveCart', N'buttons/save_cart.gif'
EXEC sp_AddImage @designId, N'Search', N'buttons/icon_go.gif'
EXEC sp_AddImage @designId, N'Send', N'buttons/send.gif'
EXEC sp_AddImage @designId, N'SignIn', N'buttons/sign_in.gif'
EXEC sp_AddImage @designId, N'SignOut', N'buttons/sign_out.gif'
EXEC sp_AddImage @designId, N'Track', N'buttons/track.gif'
EXEC sp_AddImage @designId, N'UpdateQuantity', N'buttons/update_quantity.gif'
EXEC sp_AddImage @designId, N'View', N'buttons/view.gif'
EXEC sp_AddImage @designId, N'ViewAndPrintReceipt', N'buttons/viewandprintreceipt.gif'

-- sp_AddLayout inserts the record into the Layout table or updates if a record with
-- the same name and design id exists.
EXEC sp_AddLayout @designId, N'BodyTable', NULL, NULL, NULL, NULL, NULL, N'Center', NULL, 0, 0, 0, 0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Content', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'ContentTableHeader', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'ErrorMessages', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Footer', NULL, NULL, NULL, NULL, NULL, N'Left', N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, 1
EXEC sp_AddLayout @designId, N'Headings', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Instruction', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'LeftColumn', NULL, NULL, NULL, NULL, NULL, N'Left', N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, 1
EXEC sp_AddLayout @designId, N'Messages', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'RightColumn', NULL, NULL, NULL, NULL, NULL, N'Left', N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, 0
EXEC sp_AddLayout @designId, N'TopBanner', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', N'bn-logo.gif', 1, 1
EXEC sp_AddLayout @designId, N'TopSubBanner', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, 0, 1

-- sp_AddMenuBar inserts the record into the MenuBar table or updates if a record with
-- the same page name, menu text and design id exists.
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Home', NULL, NULL, N'default.aspx', 0, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Categories', NULL, NULL, N'SearchResult.aspx?CategoryID=', 1, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Home', NULL, N'default.aspx', 3, 0, 1
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'About Us', NULL, N'about.aspx', 3, 0, 2
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Contact Us', NULL, N'contact.aspx', 3, 0, 3
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'FAQ', NULL, N'faq.aspx', 3, 0, 4
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Privacy Policy', NULL, N'privacy-policy.aspx', 3, 0, 5
]]></SQLServer>
  <!-- end - Theme4 - Green -->
  <!-- begin - Theme6 - Blue -->
  <SQLServer><![CDATA[

DECLARE @designId INT

-- sp_AddDesign inserts the record into the Designs table or updates if a record with
-- the same name exists. This procedure returns the design id used by this theme.
EXEC sp_AddStoreFrontDesign N'Theme 6 - Blue', N'Theme6', N'Blue', N'Theme 6', @designId OUT

-- sp_AddImage inserts the record into the Images table or updates if a record with
-- the same name and design id exists.
EXEC sp_AddImage @designId, N'Add', N'buttons/add.gif'
EXEC sp_AddImage @designId, N'AddAddress', N'buttons/add_addresses.gif'
EXEC sp_AddImage @designId, N'AddToOrder', N'buttons/add_to_cart.gif'
EXEC sp_AddImage @designId, N'AddToSavedCart', N'buttons/addtosavedcart.gif'
EXEC sp_AddImage @designId, N'Apply', N'buttons/apply.gif'
EXEC sp_AddImage @designId, N'BuyNow', N'buttons/buy_now.gif'
EXEC sp_AddImage @designId, N'Cancel', N'buttons/cancel.gif'
EXEC sp_AddImage @designId, N'CheckOut', N'buttons/checkout.gif'
EXEC sp_AddImage @designId, N'Clear', N'buttons/clear.gif'
EXEC sp_AddImage @designId, N'Close', N'buttons/close.gif'
EXEC sp_AddImage @designId, N'CompleteOrder', N'buttons/complete_order.gif'
EXEC sp_AddImage @designId, N'Continue', N'buttons/continue.gif'
EXEC sp_AddImage @designId, N'CreateAccount', N'buttons/continue.gif'
EXEC sp_AddImage @designId, N'Delete', N'buttons/delete.gif'
EXEC sp_AddImage @designId, N'Edit', N'buttons/edit.gif'
EXEC sp_AddImage @designId, N'EmailFriend', N'buttons/email_friend.gif'
EXEC sp_AddImage @designId, N'FilterResults', N'buttons/filter_results.gif'
EXEC sp_AddImage @designId, N'GiftWrap', N'buttons/gift_wrap.gif'
EXEC sp_AddImage @designId, N'LagardeLogo', N'ft-logo_lagarde.jpg'
EXEC sp_AddImage @designId, N'ManageAddresses', N'buttons/manage_addresses.gif'
EXEC sp_AddImage @designId, N'Remove', N'buttons/remove.gif'
EXEC sp_AddImage @designId, N'ReOrder', N'buttons/reorder.gif'
EXEC sp_AddImage @designId, N'Save', N'buttons/save.gif'
EXEC sp_AddImage @designId, N'SaveCart', N'buttons/save_cart.gif'
EXEC sp_AddImage @designId, N'Search', N'buttons/icon_go.gif'
EXEC sp_AddImage @designId, N'Send', N'buttons/send.gif'
EXEC sp_AddImage @designId, N'SignIn', N'buttons/sign_in.gif'
EXEC sp_AddImage @designId, N'SignOut', N'buttons/sign_out.gif'
EXEC sp_AddImage @designId, N'Track', N'buttons/track.gif'
EXEC sp_AddImage @designId, N'UpdateQuantity', N'buttons/update_quantity.gif'
EXEC sp_AddImage @designId, N'View', N'buttons/view.gif'
EXEC sp_AddImage @designId, N'ViewAndPrintReceipt', N'buttons/viewandprintreceipt.gif'

-- sp_AddLayout inserts the record into the Layout table or updates if a record with
-- the same name and design id exists.
EXEC sp_AddLayout @designId, N'BodyTable', NULL, N'0', N'0', NULL, NULL, N'Center', NULL, 0, 0, 0, 0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Content', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'ContentTableHeader', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 10, NULL, N'Bold', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'ErrorMessages', NULL, NULL, NULL, NULL, NULL, N'Center', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Bold', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Footer', NULL, NULL, NULL, NULL, NULL, N'Left', N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, 1
EXEC sp_AddLayout @designId, N'Headings', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 10, NULL, N'Bold', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Instruction', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'LeftColumn', NULL, NULL, NULL, NULL, NULL, N'Left', N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, 1
EXEC sp_AddLayout @designId, N'Messages', NULL, NULL, NULL, NULL, NULL, N'Center', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Bold', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'RightColumn', NULL, NULL, NULL, NULL, NULL, N'Left', N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, 0
EXEC sp_AddLayout @designId, N'TopBanner', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 10, NULL, N'Normal', N'bn-logo.gif', 1, 1
EXEC sp_AddLayout @designId, N'TopSubBanner', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 9, NULL, N'Normal', NULL, 0, 1

-- sp_AddMenuBar inserts the record into the MenuBar table or updates if a record with
-- the same page name, menu text and design id exists.
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Home', NULL, NULL, N'default.aspx', 0, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Categories', NULL, NULL, N'SearchResult.aspx?CategoryID=', 1, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Home', NULL, N'default.aspx', 3, 0, 1
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'About Us', NULL, N'about.aspx', 3, 0, 2
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Contact Us', NULL, N'contact.aspx', 3, 0, 3
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'FAQ', NULL, N'faq.aspx', 3, 0, 4
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Privacy Policy', NULL, N'privacy-policy.aspx', 3, 0, 5
]]></SQLServer>
  <!-- end - Theme6 - Blue -->
  <!-- begin - Theme6 - Brown -->
  <SQLServer><![CDATA[

DECLARE @designId INT

-- sp_AddDesign inserts the record into the Designs table or updates if a record with
-- the same name exists. This procedure returns the design id used by this theme.
EXEC sp_AddStoreFrontDesign N'Theme 6 - Brown', N'Theme6', N'Brown', N'Theme 6', @designId OUT

-- sp_AddImage inserts the record into the Images table or updates if a record with
-- the same name and design id exists.
EXEC sp_AddImage @designId, N'Add', N'buttons/add.gif'
EXEC sp_AddImage @designId, N'AddAddress', N'buttons/add_addresses.gif'
EXEC sp_AddImage @designId, N'AddToOrder', N'buttons/add_to_cart.gif'
EXEC sp_AddImage @designId, N'AddToSavedCart', N'buttons/addtosavedcart.gif'
EXEC sp_AddImage @designId, N'Apply', N'buttons/apply.gif'
EXEC sp_AddImage @designId, N'BuyNow', N'buttons/buy_now.gif'
EXEC sp_AddImage @designId, N'Cancel', N'buttons/cancel.gif'
EXEC sp_AddImage @designId, N'CheckOut', N'buttons/checkout.gif'
EXEC sp_AddImage @designId, N'Clear', N'buttons/clear.gif'
EXEC sp_AddImage @designId, N'Close', N'buttons/close.gif'
EXEC sp_AddImage @designId, N'CompleteOrder', N'buttons/complete_order.gif'
EXEC sp_AddImage @designId, N'Continue', N'buttons/continue.gif'
EXEC sp_AddImage @designId, N'CreateAccount', N'buttons/continue.gif'
EXEC sp_AddImage @designId, N'Delete', N'buttons/delete.gif'
EXEC sp_AddImage @designId, N'Edit', N'buttons/edit.gif'
EXEC sp_AddImage @designId, N'EmailFriend', N'buttons/email_friend.gif'
EXEC sp_AddImage @designId, N'FilterResults', N'buttons/filter_results.gif'
EXEC sp_AddImage @designId, N'GiftWrap', N'buttons/gift_wrap.gif'
EXEC sp_AddImage @designId, N'LagardeLogo', N'ft-logo_lagarde.jpg'
EXEC sp_AddImage @designId, N'ManageAddresses', N'buttons/manage_addresses.gif'
EXEC sp_AddImage @designId, N'Remove', N'buttons/remove.gif'
EXEC sp_AddImage @designId, N'ReOrder', N'buttons/reorder.gif'
EXEC sp_AddImage @designId, N'Save', N'buttons/save.gif'
EXEC sp_AddImage @designId, N'SaveCart', N'buttons/save_cart.gif'
EXEC sp_AddImage @designId, N'Search', N'buttons/icon_go.gif'
EXEC sp_AddImage @designId, N'Send', N'buttons/send.gif'
EXEC sp_AddImage @designId, N'SignIn', N'buttons/sign_in.gif'
EXEC sp_AddImage @designId, N'SignOut', N'buttons/sign_out.gif'
EXEC sp_AddImage @designId, N'Track', N'buttons/track.gif'
EXEC sp_AddImage @designId, N'UpdateQuantity', N'buttons/update_quantity.gif'
EXEC sp_AddImage @designId, N'View', N'buttons/view.gif'
EXEC sp_AddImage @designId, N'ViewAndPrintReceipt', N'buttons/viewandprintreceipt.gif'

-- sp_AddLayout inserts the record into the Layout table or updates if a record with
-- the same name and design id exists.
EXEC sp_AddLayout @designId, N'BodyTable', NULL, N'0', N'0', NULL, NULL, N'Center', NULL, 0, 0, 0, 0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Content', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'ContentTableHeader', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 10, NULL, N'Bold', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'ErrorMessages', NULL, NULL, NULL, NULL, NULL, N'Center', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Bold', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Footer', NULL, NULL, NULL, NULL, NULL, N'Left', N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, 1
EXEC sp_AddLayout @designId, N'Headings', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 10, NULL, N'Bold', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Instruction', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'LeftColumn', NULL, NULL, NULL, NULL, NULL, N'Left', N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, 1
EXEC sp_AddLayout @designId, N'Messages', NULL, NULL, NULL, NULL, NULL, N'Center', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Bold', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'RightColumn', NULL, NULL, NULL, NULL, NULL, N'Left', N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, 0
EXEC sp_AddLayout @designId, N'TopBanner', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 10, NULL, N'Normal', N'bn-logo.gif', 1, 1
EXEC sp_AddLayout @designId, N'TopSubBanner', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 9, NULL, N'Normal', NULL, 0, 1

-- sp_AddMenuBar inserts the record into the MenuBar table or updates if a record with
-- the same page name, menu text and design id exists.
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Home', NULL, NULL, N'default.aspx', 0, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Categories', NULL, NULL, N'SearchResult.aspx?CategoryID=', 1, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Home', NULL, N'default.aspx', 3, 0, 1
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'About Us', NULL, N'about.aspx', 3, 0, 2
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Contact Us', NULL, N'contact.aspx', 3, 0, 3
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'FAQ', NULL, N'faq.aspx', 3, 0, 4
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Privacy Policy', NULL, N'privacy-policy.aspx', 3, 0, 5
]]></SQLServer>
  <!-- end - Theme6 - Brown -->
  <!-- begin - Theme6 - Gold -->
  <SQLServer><![CDATA[

DECLARE @designId INT

-- sp_AddDesign inserts the record into the Designs table or updates if a record with
-- the same name exists. This procedure returns the design id used by this theme.
EXEC sp_AddStoreFrontDesign N'Theme 6 - Gold', N'Theme6', N'Gold', N'Theme 6', @designId OUT

-- sp_AddImage inserts the record into the Images table or updates if a record with
-- the same name and design id exists.
EXEC sp_AddImage @designId, N'Add', N'buttons/add.gif'
EXEC sp_AddImage @designId, N'AddAddress', N'buttons/add_addresses.gif'
EXEC sp_AddImage @designId, N'AddToOrder', N'buttons/add_to_cart.gif'
EXEC sp_AddImage @designId, N'AddToSavedCart', N'buttons/addtosavedcart.gif'
EXEC sp_AddImage @designId, N'Apply', N'buttons/apply.gif'
EXEC sp_AddImage @designId, N'BuyNow', N'buttons/buy_now.gif'
EXEC sp_AddImage @designId, N'Cancel', N'buttons/cancel.gif'
EXEC sp_AddImage @designId, N'CheckOut', N'buttons/checkout.gif'
EXEC sp_AddImage @designId, N'Clear', N'buttons/clear.gif'
EXEC sp_AddImage @designId, N'Close', N'buttons/close.gif'
EXEC sp_AddImage @designId, N'CompleteOrder', N'buttons/complete_order.gif'
EXEC sp_AddImage @designId, N'Continue', N'buttons/continue.gif'
EXEC sp_AddImage @designId, N'CreateAccount', N'buttons/continue.gif'
EXEC sp_AddImage @designId, N'Delete', N'buttons/delete.gif'
EXEC sp_AddImage @designId, N'Edit', N'buttons/edit.gif'
EXEC sp_AddImage @designId, N'EmailFriend', N'buttons/email_friend.gif'
EXEC sp_AddImage @designId, N'FilterResults', N'buttons/filter_results.gif'
EXEC sp_AddImage @designId, N'GiftWrap', N'buttons/gift_wrap.gif'
EXEC sp_AddImage @designId, N'LagardeLogo', N'ft-logo_lagarde.jpg'
EXEC sp_AddImage @designId, N'ManageAddresses', N'buttons/manage_addresses.gif'
EXEC sp_AddImage @designId, N'Remove', N'buttons/remove.gif'
EXEC sp_AddImage @designId, N'ReOrder', N'buttons/reorder.gif'
EXEC sp_AddImage @designId, N'Save', N'buttons/save.gif'
EXEC sp_AddImage @designId, N'SaveCart', N'buttons/save_cart.gif'
EXEC sp_AddImage @designId, N'Search', N'buttons/icon_go.gif'
EXEC sp_AddImage @designId, N'Send', N'buttons/send.gif'
EXEC sp_AddImage @designId, N'SignIn', N'buttons/sign_in.gif'
EXEC sp_AddImage @designId, N'SignOut', N'buttons/sign_out.gif'
EXEC sp_AddImage @designId, N'Track', N'buttons/track.gif'
EXEC sp_AddImage @designId, N'UpdateQuantity', N'buttons/update_quantity.gif'
EXEC sp_AddImage @designId, N'View', N'buttons/view.gif'
EXEC sp_AddImage @designId, N'ViewAndPrintReceipt', N'buttons/viewandprintreceipt.gif'

-- sp_AddLayout inserts the record into the Layout table or updates if a record with
-- the same name and design id exists.
EXEC sp_AddLayout @designId, N'BodyTable', NULL, N'0', N'0', NULL, NULL, N'Center', NULL, 0, 0, 0, 0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Content', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'ContentTableHeader', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 10, NULL, N'Bold', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'ErrorMessages', NULL, NULL, NULL, NULL, NULL, N'Center', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Bold', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Footer', NULL, NULL, NULL, NULL, NULL, N'Left', N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, 1
EXEC sp_AddLayout @designId, N'Headings', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 10, NULL, N'Bold', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Instruction', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'LeftColumn', NULL, NULL, NULL, NULL, NULL, N'Left', N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, 1
EXEC sp_AddLayout @designId, N'Messages', NULL, NULL, NULL, NULL, NULL, N'Center', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Bold', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'RightColumn', NULL, NULL, NULL, NULL, NULL, N'Left', N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, 0
EXEC sp_AddLayout @designId, N'TopBanner', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 10, NULL, N'Normal', N'bn-logo.gif', 1, 1
EXEC sp_AddLayout @designId, N'TopSubBanner', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 9, NULL, N'Normal', NULL, 0, 1

-- sp_AddMenuBar inserts the record into the MenuBar table or updates if a record with
-- the same page name, menu text and design id exists.
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Home', NULL, NULL, N'default.aspx', 0, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Categories', NULL, NULL, N'SearchResult.aspx?CategoryID=', 1, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Home', NULL, N'default.aspx', 3, 0, 1
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'About Us', NULL, N'about.aspx', 3, 0, 2
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Contact Us', NULL, N'contact.aspx', 3, 0, 3
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'FAQ', NULL, N'faq.aspx', 3, 0, 4
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Privacy Policy', NULL, N'privacy-policy.aspx', 3, 0, 5
]]></SQLServer>
  <!-- end - Theme6 - Gold -->
  <!-- begin - Theme6 - Green -->
  <SQLServer><![CDATA[

DECLARE @designId INT

-- sp_AddDesign inserts the record into the Designs table or updates if a record with
-- the same name exists. This procedure returns the design id used by this theme.
EXEC sp_AddStoreFrontDesign N'Theme 6 - Green', N'Theme6', N'Green', N'Theme 6', @designId OUT

-- sp_AddImage inserts the record into the Images table or updates if a record with
-- the same name and design id exists.
EXEC sp_AddImage @designId, N'Add', N'buttons/add.gif'
EXEC sp_AddImage @designId, N'AddAddress', N'buttons/add_addresses.gif'
EXEC sp_AddImage @designId, N'AddToOrder', N'buttons/add_to_cart.gif'
EXEC sp_AddImage @designId, N'AddToSavedCart', N'buttons/addtosavedcart.gif'
EXEC sp_AddImage @designId, N'Apply', N'buttons/apply.gif'
EXEC sp_AddImage @designId, N'BuyNow', N'buttons/buy_now.gif'
EXEC sp_AddImage @designId, N'Cancel', N'buttons/cancel.gif'
EXEC sp_AddImage @designId, N'CheckOut', N'buttons/checkout.gif'
EXEC sp_AddImage @designId, N'Clear', N'buttons/clear.gif'
EXEC sp_AddImage @designId, N'Close', N'buttons/close.gif'
EXEC sp_AddImage @designId, N'CompleteOrder', N'buttons/complete_order.gif'
EXEC sp_AddImage @designId, N'Continue', N'buttons/continue.gif'
EXEC sp_AddImage @designId, N'CreateAccount', N'buttons/continue.gif'
EXEC sp_AddImage @designId, N'Delete', N'buttons/delete.gif'
EXEC sp_AddImage @designId, N'Edit', N'buttons/edit.gif'
EXEC sp_AddImage @designId, N'EmailFriend', N'buttons/email_friend.gif'
EXEC sp_AddImage @designId, N'FilterResults', N'buttons/filter_results.gif'
EXEC sp_AddImage @designId, N'GiftWrap', N'buttons/gift_wrap.gif'
EXEC sp_AddImage @designId, N'LagardeLogo', N'ft-logo_lagarde.jpg'
EXEC sp_AddImage @designId, N'ManageAddresses', N'buttons/manage_addresses.gif'
EXEC sp_AddImage @designId, N'Remove', N'buttons/remove.gif'
EXEC sp_AddImage @designId, N'ReOrder', N'buttons/reorder.gif'
EXEC sp_AddImage @designId, N'Save', N'buttons/save.gif'
EXEC sp_AddImage @designId, N'SaveCart', N'buttons/save_cart.gif'
EXEC sp_AddImage @designId, N'Search', N'buttons/icon_go.gif'
EXEC sp_AddImage @designId, N'Send', N'buttons/send.gif'
EXEC sp_AddImage @designId, N'SignIn', N'buttons/sign_in.gif'
EXEC sp_AddImage @designId, N'SignOut', N'buttons/sign_out.gif'
EXEC sp_AddImage @designId, N'Track', N'buttons/track.gif'
EXEC sp_AddImage @designId, N'UpdateQuantity', N'buttons/update_quantity.gif'
EXEC sp_AddImage @designId, N'View', N'buttons/view.gif'
EXEC sp_AddImage @designId, N'ViewAndPrintReceipt', N'buttons/viewandprintreceipt.gif'

-- sp_AddLayout inserts the record into the Layout table or updates if a record with
-- the same name and design id exists.
EXEC sp_AddLayout @designId, N'BodyTable', NULL, N'0', N'0', NULL, NULL, N'Center', NULL, 0, 0, 0, 0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Content', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'ContentTableHeader', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 10, NULL, N'Bold', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'ErrorMessages', NULL, NULL, NULL, NULL, NULL, N'Center', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Bold', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Footer', NULL, NULL, NULL, NULL, NULL, N'Left', N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, 1
EXEC sp_AddLayout @designId, N'Headings', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 10, NULL, N'Bold', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Instruction', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'LeftColumn', NULL, NULL, NULL, NULL, NULL, N'Left', N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, 1
EXEC sp_AddLayout @designId, N'Messages', NULL, NULL, NULL, NULL, NULL, N'Center', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Bold', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'RightColumn', NULL, NULL, NULL, NULL, NULL, N'Left', N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, 0
EXEC sp_AddLayout @designId, N'TopBanner', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 10, NULL, N'Normal', N'bn-logo.gif', 1, 1
EXEC sp_AddLayout @designId, N'TopSubBanner', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 9, NULL, N'Normal', NULL, 0, 1

-- sp_AddMenuBar inserts the record into the MenuBar table or updates if a record with
-- the same page name, menu text and design id exists.
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Home', NULL, NULL, N'default.aspx', 0, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Categories', NULL, NULL, N'SearchResult.aspx?CategoryID=', 1, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Home', NULL, N'default.aspx', 3, 0, 1
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'About Us', NULL, N'about.aspx', 3, 0, 2
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Contact Us', NULL, N'contact.aspx', 3, 0, 3
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'FAQ', NULL, N'faq.aspx', 3, 0, 4
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Privacy Policy', NULL, N'privacy-policy.aspx', 3, 0, 5
]]></SQLServer>
  <!-- end - Theme6 - Green -->
  <!-- begin - Theme6 - Grey -->
  <SQLServer><![CDATA[

DECLARE @designId INT

-- sp_AddDesign inserts the record into the Designs table or updates if a record with
-- the same name exists. This procedure returns the design id used by this theme.
EXEC sp_AddStoreFrontDesign N'Theme 6 - Grey', N'Theme6', N'Grey', N'Theme 6', @designId OUT

-- sp_AddImage inserts the record into the Images table or updates if a record with
-- the same name and design id exists.
EXEC sp_AddImage @designId, N'Add', N'buttons/add.gif'
EXEC sp_AddImage @designId, N'AddAddress', N'buttons/add_addresses.gif'
EXEC sp_AddImage @designId, N'AddToOrder', N'buttons/add_to_cart.gif'
EXEC sp_AddImage @designId, N'AddToSavedCart', N'buttons/addtosavedcart.gif'
EXEC sp_AddImage @designId, N'Apply', N'buttons/apply.gif'
EXEC sp_AddImage @designId, N'BuyNow', N'buttons/buy_now.gif'
EXEC sp_AddImage @designId, N'Cancel', N'buttons/cancel.gif'
EXEC sp_AddImage @designId, N'CheckOut', N'buttons/checkout.gif'
EXEC sp_AddImage @designId, N'Clear', N'buttons/clear.gif'
EXEC sp_AddImage @designId, N'Close', N'buttons/close.gif'
EXEC sp_AddImage @designId, N'CompleteOrder', N'buttons/complete_order.gif'
EXEC sp_AddImage @designId, N'Continue', N'buttons/continue.gif'
EXEC sp_AddImage @designId, N'CreateAccount', N'buttons/continue.gif'
EXEC sp_AddImage @designId, N'Delete', N'buttons/delete.gif'
EXEC sp_AddImage @designId, N'Edit', N'buttons/edit.gif'
EXEC sp_AddImage @designId, N'EmailFriend', N'buttons/email_friend.gif'
EXEC sp_AddImage @designId, N'FilterResults', N'buttons/filter_results.gif'
EXEC sp_AddImage @designId, N'GiftWrap', N'buttons/gift_wrap.gif'
EXEC sp_AddImage @designId, N'LagardeLogo', N'ft-logo_lagarde.jpg'
EXEC sp_AddImage @designId, N'ManageAddresses', N'buttons/manage_addresses.gif'
EXEC sp_AddImage @designId, N'Remove', N'buttons/remove.gif'
EXEC sp_AddImage @designId, N'ReOrder', N'buttons/reorder.gif'
EXEC sp_AddImage @designId, N'Save', N'buttons/save.gif'
EXEC sp_AddImage @designId, N'SaveCart', N'buttons/save_cart.gif'
EXEC sp_AddImage @designId, N'Search', N'buttons/icon_go.gif'
EXEC sp_AddImage @designId, N'Send', N'buttons/send.gif'
EXEC sp_AddImage @designId, N'SignIn', N'buttons/sign_in.gif'
EXEC sp_AddImage @designId, N'SignOut', N'buttons/sign_out.gif'
EXEC sp_AddImage @designId, N'Track', N'buttons/track.gif'
EXEC sp_AddImage @designId, N'UpdateQuantity', N'buttons/update_quantity.gif'
EXEC sp_AddImage @designId, N'View', N'buttons/view.gif'
EXEC sp_AddImage @designId, N'ViewAndPrintReceipt', N'buttons/viewandprintreceipt.gif'

-- sp_AddLayout inserts the record into the Layout table or updates if a record with
-- the same name and design id exists.
EXEC sp_AddLayout @designId, N'BodyTable', NULL, N'0', N'0', NULL, NULL, N'Center', NULL, 0, 0, 0, 0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Content', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'ContentTableHeader', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 10, NULL, N'Bold', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'ErrorMessages', NULL, NULL, NULL, NULL, NULL, N'Center', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Bold', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Footer', NULL, NULL, NULL, NULL, NULL, N'Left', N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, 1
EXEC sp_AddLayout @designId, N'Headings', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 10, NULL, N'Bold', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Instruction', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'LeftColumn', NULL, NULL, NULL, NULL, NULL, N'Left', N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, 1
EXEC sp_AddLayout @designId, N'Messages', NULL, NULL, NULL, NULL, NULL, N'Center', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Bold', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'RightColumn', NULL, NULL, NULL, NULL, NULL, N'Left', N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, 0
EXEC sp_AddLayout @designId, N'TopBanner', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 10, NULL, N'Normal', N'bn-logo.gif', 1, 1
EXEC sp_AddLayout @designId, N'TopSubBanner', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 9, NULL, N'Normal', NULL, 0, 1

-- sp_AddMenuBar inserts the record into the MenuBar table or updates if a record with
-- the same page name, menu text and design id exists.
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Home', NULL, NULL, N'default.aspx', 0, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Categories', NULL, NULL, N'SearchResult.aspx?CategoryID=', 1, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Home', NULL, N'default.aspx', 3, 0, 1
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'About Us', NULL, N'about.aspx', 3, 0, 2
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Contact Us', NULL, N'contact.aspx', 3, 0, 3
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'FAQ', NULL, N'faq.aspx', 3, 0, 4
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Privacy Policy', NULL, N'privacy-policy.aspx', 3, 0, 5
]]></SQLServer>
  <!-- end - Theme6 - Grey -->
  <!-- begin - Theme6 - Red -->
  <SQLServer><![CDATA[

DECLARE @designId INT

-- sp_AddDesign inserts the record into the Designs table or updates if a record with
-- the same name exists. This procedure returns the design id used by this theme.
EXEC sp_AddStoreFrontDesign N'Theme 6 - Red', N'Theme6', N'Red', N'Theme 6', @designId OUT

-- sp_AddImage inserts the record into the Images table or updates if a record with
-- the same name and design id exists.
EXEC sp_AddImage @designId, N'Add', N'buttons/add.gif'
EXEC sp_AddImage @designId, N'AddAddress', N'buttons/add_addresses.gif'
EXEC sp_AddImage @designId, N'AddToOrder', N'buttons/add_to_cart.gif'
EXEC sp_AddImage @designId, N'AddToSavedCart', N'buttons/addtosavedcart.gif'
EXEC sp_AddImage @designId, N'Apply', N'buttons/apply.gif'
EXEC sp_AddImage @designId, N'BuyNow', N'buttons/buy_now.gif'
EXEC sp_AddImage @designId, N'Cancel', N'buttons/cancel.gif'
EXEC sp_AddImage @designId, N'CheckOut', N'buttons/checkout.gif'
EXEC sp_AddImage @designId, N'Clear', N'buttons/clear.gif'
EXEC sp_AddImage @designId, N'Close', N'buttons/close.gif'
EXEC sp_AddImage @designId, N'CompleteOrder', N'buttons/complete_order.gif'
EXEC sp_AddImage @designId, N'Continue', N'buttons/continue.gif'
EXEC sp_AddImage @designId, N'CreateAccount', N'buttons/continue.gif'
EXEC sp_AddImage @designId, N'Delete', N'buttons/delete.gif'
EXEC sp_AddImage @designId, N'Edit', N'buttons/edit.gif'
EXEC sp_AddImage @designId, N'EmailFriend', N'buttons/email_friend.gif'
EXEC sp_AddImage @designId, N'FilterResults', N'buttons/filter_results.gif'
EXEC sp_AddImage @designId, N'GiftWrap', N'buttons/gift_wrap.gif'
EXEC sp_AddImage @designId, N'LagardeLogo', N'ft-logo_lagarde.jpg'
EXEC sp_AddImage @designId, N'ManageAddresses', N'buttons/manage_addresses.gif'
EXEC sp_AddImage @designId, N'Remove', N'buttons/remove.gif'
EXEC sp_AddImage @designId, N'ReOrder', N'buttons/reorder.gif'
EXEC sp_AddImage @designId, N'Save', N'buttons/save.gif'
EXEC sp_AddImage @designId, N'SaveCart', N'buttons/save_cart.gif'
EXEC sp_AddImage @designId, N'Search', N'buttons/icon_go.gif'
EXEC sp_AddImage @designId, N'Send', N'buttons/send.gif'
EXEC sp_AddImage @designId, N'SignIn', N'buttons/sign_in.gif'
EXEC sp_AddImage @designId, N'SignOut', N'buttons/sign_out.gif'
EXEC sp_AddImage @designId, N'Track', N'buttons/track.gif'
EXEC sp_AddImage @designId, N'UpdateQuantity', N'buttons/update_quantity.gif'
EXEC sp_AddImage @designId, N'View', N'buttons/view.gif'
EXEC sp_AddImage @designId, N'ViewAndPrintReceipt', N'buttons/viewandprintreceipt.gif'

-- sp_AddLayout inserts the record into the Layout table or updates if a record with
-- the same name and design id exists.
EXEC sp_AddLayout @designId, N'BodyTable', NULL, N'0', N'0', NULL, NULL, N'Center', NULL, 0, 0, 0, 0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Content', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'ContentTableHeader', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 10, NULL, N'Bold', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'ErrorMessages', NULL, NULL, NULL, NULL, NULL, N'Center', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Bold', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Footer', NULL, NULL, NULL, NULL, NULL, N'Left', N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, 1
EXEC sp_AddLayout @designId, N'Headings', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 10, NULL, N'Bold', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Instruction', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'LeftColumn', NULL, NULL, NULL, NULL, NULL, N'Left', N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, 1
EXEC sp_AddLayout @designId, N'Messages', NULL, NULL, NULL, NULL, NULL, N'Center', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Bold', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'RightColumn', NULL, NULL, NULL, NULL, NULL, N'Left', N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, 0
EXEC sp_AddLayout @designId, N'TopBanner', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 10, NULL, N'Normal', N'bn-logo.gif', 1, 1
EXEC sp_AddLayout @designId, N'TopSubBanner', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 9, NULL, N'Normal', NULL, 0, 1

-- sp_AddMenuBar inserts the record into the MenuBar table or updates if a record with
-- the same page name, menu text and design id exists.
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Home', NULL, NULL, N'default.aspx', 0, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Categories', NULL, NULL, N'SearchResult.aspx?CategoryID=', 1, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Home', NULL, N'default.aspx', 3, 0, 1
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'About Us', NULL, N'about.aspx', 3, 0, 2
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Contact Us', NULL, N'contact.aspx', 3, 0, 3
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'FAQ', NULL, N'faq.aspx', 3, 0, 4
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Privacy Policy', NULL, N'privacy-policy.aspx', 3, 0, 5
]]></SQLServer>
  <!-- end - Theme6 - Red -->
  <!-- begin - Theme3 - Black -->
  <SQLServer><![CDATA[

DECLARE @designId INT

-- sp_AddDesign inserts the record into the Designs table or updates if a record with
-- the same name exists. This procedure returns the design id used by this theme.
EXEC sp_AddStoreFrontDesign N'Theme 3 - Black', N'Theme3', N'Black', N'Theme 3', @designId OUT

-- sp_AddImage inserts the record into the Images table or updates if a record with
-- the same name and design id exists.
EXEC sp_AddImage @designId, N'Add', N'buttons/add.gif'
EXEC sp_AddImage @designId, N'AddAddress', N'buttons/add_addresses.gif'
EXEC sp_AddImage @designId, N'AddToOrder', N'buttons/add_to_cart.gif'
EXEC sp_AddImage @designId, N'AddToSavedCart', N'buttons/addtosavedcart.gif'
EXEC sp_AddImage @designId, N'Apply', N'buttons/apply.gif'
EXEC sp_AddImage @designId, N'BuyNow', N'buttons/buy_now.gif'
EXEC sp_AddImage @designId, N'Cancel', N'buttons/cancel.gif'
EXEC sp_AddImage @designId, N'CheckOut', N'buttons/checkout.gif'
EXEC sp_AddImage @designId, N'Clear', N'buttons/clear.gif'
EXEC sp_AddImage @designId, N'Close', N'buttons/close.gif'
EXEC sp_AddImage @designId, N'CompleteOrder', N'buttons/complete_order.gif'
EXEC sp_AddImage @designId, N'Continue', N'buttons/continue.gif'
EXEC sp_AddImage @designId, N'CreateAccount', N'buttons/continue.gif'
EXEC sp_AddImage @designId, N'Delete', N'buttons/delete.gif'
EXEC sp_AddImage @designId, N'Edit', N'buttons/edit.gif'
EXEC sp_AddImage @designId, N'EmailFriend', N'buttons/email_friend.gif'
EXEC sp_AddImage @designId, N'FilterResults', N'buttons/filter_results.gif'
EXEC sp_AddImage @designId, N'GiftWrap', N'buttons/gift_wrap.gif'
EXEC sp_AddImage @designId, N'LagardeLogo', N'ft-poweredby.gif'
EXEC sp_AddImage @designId, N'ManageAddresses', N'buttons/manage_addresses.gif'
EXEC sp_AddImage @designId, N'Remove', N'buttons/remove.gif'
EXEC sp_AddImage @designId, N'ReOrder', N'buttons/reorder.gif'
EXEC sp_AddImage @designId, N'Save', N'buttons/save.gif'
EXEC sp_AddImage @designId, N'SaveCart', N'buttons/save_cart.gif'
EXEC sp_AddImage @designId, N'Search', N'buttons/icon_go.gif'
EXEC sp_AddImage @designId, N'Send', N'buttons/send.gif'
EXEC sp_AddImage @designId, N'SignIn', N'buttons/sign_in.gif'
EXEC sp_AddImage @designId, N'SignOut', N'buttons/sign_out.gif'
EXEC sp_AddImage @designId, N'Track', N'buttons/track.gif'
EXEC sp_AddImage @designId, N'UpdateQuantity', N'buttons/update_quantity.gif'
EXEC sp_AddImage @designId, N'View', N'buttons/view.gif'
EXEC sp_AddImage @designId, N'ViewAndPrintReceipt', N'buttons/viewandprintreceipt.gif'

-- sp_AddLayout inserts the record into the Layout table or updates if a record with
-- the same name and design id exists.
EXEC sp_AddLayout @designId, N'BodyTable', NULL, NULL, NULL, NULL, NULL, N'Center', NULL, 0, 0, 0, 0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Content', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'ContentTableHeader', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'ErrorMessages', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Footer', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, 1
EXEC sp_AddLayout @designId, N'Headings', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Instruction', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'LeftColumn', NULL, NULL, NULL, NULL, NULL, NULL, N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, 1
EXEC sp_AddLayout @designId, N'Messages', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'RightColumn', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, 0
EXEC sp_AddLayout @designId, N'TopBanner', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, 0, 1
EXEC sp_AddLayout @designId, N'TopSubBanner', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, 0, 1

-- sp_AddMenuBar inserts the record into the MenuBar table or updates if a record with
-- the same page name, menu text and design id exists.
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Home', NULL, NULL, N'default.aspx', 0, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Categories', NULL, NULL, N'SearchResult.aspx?CategoryID=', 1, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Home', NULL, N'default.aspx', 3, 0, 1
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'About Us', NULL, N'about.aspx', 3, 0, 2
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Contact Us', NULL, N'contact.aspx', 3, 0, 3
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'FAQ', NULL, N'faq.aspx', 3, 0, 4
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Privacy Policy', NULL, N'privacy-policy.aspx', 3, 0, 5
]]></SQLServer>
  <!-- end - Theme3 - Black -->
  <!-- begin - Theme3 - Blue -->
  <SQLServer><![CDATA[

DECLARE @designId INT

-- sp_AddDesign inserts the record into the Designs table or updates if a record with
-- the same name exists. This procedure returns the design id used by this theme.
EXEC sp_AddStoreFrontDesign N'Theme 3 - Blue', N'Theme3', N'Blue', N'Theme 3', @designId OUT

-- sp_AddImage inserts the record into the Images table or updates if a record with
-- the same name and design id exists.
EXEC sp_AddImage @designId, N'Add', N'buttons/add.gif'
EXEC sp_AddImage @designId, N'AddAddress', N'buttons/add_addresses.gif'
EXEC sp_AddImage @designId, N'AddToOrder', N'buttons/add_to_cart.gif'
EXEC sp_AddImage @designId, N'AddToSavedCart', N'buttons/addtosavedcart.gif'
EXEC sp_AddImage @designId, N'Apply', N'buttons/apply.gif'
EXEC sp_AddImage @designId, N'BuyNow', N'buttons/buy_now.gif'
EXEC sp_AddImage @designId, N'Cancel', N'buttons/cancel.gif'
EXEC sp_AddImage @designId, N'CheckOut', N'buttons/checkout.gif'
EXEC sp_AddImage @designId, N'Clear', N'buttons/clear.gif'
EXEC sp_AddImage @designId, N'Close', N'buttons/close.gif'
EXEC sp_AddImage @designId, N'CompleteOrder', N'buttons/complete_order.gif'
EXEC sp_AddImage @designId, N'Continue', N'buttons/continue.gif'
EXEC sp_AddImage @designId, N'CreateAccount', N'buttons/continue.gif'
EXEC sp_AddImage @designId, N'Delete', N'buttons/delete.gif'
EXEC sp_AddImage @designId, N'Edit', N'buttons/edit.gif'
EXEC sp_AddImage @designId, N'EmailFriend', N'buttons/email_friend.gif'
EXEC sp_AddImage @designId, N'FilterResults', N'buttons/filter_results.gif'
EXEC sp_AddImage @designId, N'GiftWrap', N'buttons/gift_wrap.gif'
EXEC sp_AddImage @designId, N'LagardeLogo', N'ft-poweredby.gif'
EXEC sp_AddImage @designId, N'ManageAddresses', N'buttons/manage_addresses.gif'
EXEC sp_AddImage @designId, N'Remove', N'buttons/remove.gif'
EXEC sp_AddImage @designId, N'ReOrder', N'buttons/reorder.gif'
EXEC sp_AddImage @designId, N'Save', N'buttons/save.gif'
EXEC sp_AddImage @designId, N'SaveCart', N'buttons/save_cart.gif'
EXEC sp_AddImage @designId, N'Search', N'buttons/icon_go.gif'
EXEC sp_AddImage @designId, N'Send', N'buttons/send.gif'
EXEC sp_AddImage @designId, N'SignIn', N'buttons/sign_in.gif'
EXEC sp_AddImage @designId, N'SignOut', N'buttons/sign_out.gif'
EXEC sp_AddImage @designId, N'Track', N'buttons/track.gif'
EXEC sp_AddImage @designId, N'UpdateQuantity', N'buttons/update_quantity.gif'
EXEC sp_AddImage @designId, N'View', N'buttons/view.gif'
EXEC sp_AddImage @designId, N'ViewAndPrintReceipt', N'buttons/viewandprintreceipt.gif'

-- sp_AddLayout inserts the record into the Layout table or updates if a record with
-- the same name and design id exists.
EXEC sp_AddLayout @designId, N'BodyTable', NULL, NULL, NULL, NULL, NULL, N'Center', NULL, 0, 0, 0, 0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Content', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'ContentTableHeader', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'ErrorMessages', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Footer', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, 1
EXEC sp_AddLayout @designId, N'Headings', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Instruction', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'LeftColumn', NULL, NULL, NULL, NULL, NULL, NULL, N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, 1
EXEC sp_AddLayout @designId, N'Messages', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'RightColumn', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, 0
EXEC sp_AddLayout @designId, N'TopBanner', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, 0, 1
EXEC sp_AddLayout @designId, N'TopSubBanner', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, 0, 1

-- sp_AddMenuBar inserts the record into the MenuBar table or updates if a record with
-- the same page name, menu text and design id exists.
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Home', NULL, NULL, N'default.aspx', 0, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Categories', NULL, NULL, N'SearchResult.aspx?CategoryID=', 1, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Home', NULL, N'default.aspx', 3, 0, 1
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'About Us', NULL, N'about.aspx', 3, 0, 2
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Contact Us', NULL, N'contact.aspx', 3, 0, 3
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'FAQ', NULL, N'faq.aspx', 3, 0, 4
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Privacy Policy', NULL, N'privacy-policy.aspx', 3, 0, 5
]]></SQLServer>
  <!-- end - Theme3 - Blue -->
  <!-- begin - Theme3 - Brown -->
  <SQLServer><![CDATA[

DECLARE @designId INT

-- sp_AddDesign inserts the record into the Designs table or updates if a record with
-- the same name exists. This procedure returns the design id used by this theme.
EXEC sp_AddStoreFrontDesign N'Theme 3 - Brown', N'Theme3', N'Brown', N'Theme 3', @designId OUT

-- sp_AddImage inserts the record into the Images table or updates if a record with
-- the same name and design id exists.
EXEC sp_AddImage @designId, N'Add', N'buttons/add.gif'
EXEC sp_AddImage @designId, N'AddAddress', N'buttons/add_addresses.gif'
EXEC sp_AddImage @designId, N'AddToOrder', N'buttons/add_to_cart.gif'
EXEC sp_AddImage @designId, N'AddToSavedCart', N'buttons/addtosavedcart.gif'
EXEC sp_AddImage @designId, N'Apply', N'buttons/apply.gif'
EXEC sp_AddImage @designId, N'BuyNow', N'buttons/buy_now.gif'
EXEC sp_AddImage @designId, N'Cancel', N'buttons/cancel.gif'
EXEC sp_AddImage @designId, N'CheckOut', N'buttons/checkout.gif'
EXEC sp_AddImage @designId, N'Clear', N'buttons/clear.gif'
EXEC sp_AddImage @designId, N'Close', N'buttons/close.gif'
EXEC sp_AddImage @designId, N'CompleteOrder', N'buttons/complete_order.gif'
EXEC sp_AddImage @designId, N'Continue', N'buttons/continue.gif'
EXEC sp_AddImage @designId, N'CreateAccount', N'buttons/continue.gif'
EXEC sp_AddImage @designId, N'Delete', N'buttons/delete.gif'
EXEC sp_AddImage @designId, N'Edit', N'buttons/edit.gif'
EXEC sp_AddImage @designId, N'EmailFriend', N'buttons/email_friend.gif'
EXEC sp_AddImage @designId, N'FilterResults', N'buttons/filter_results.gif'
EXEC sp_AddImage @designId, N'GiftWrap', N'buttons/gift_wrap.gif'
EXEC sp_AddImage @designId, N'LagardeLogo', N'ft-poweredby.gif'
EXEC sp_AddImage @designId, N'ManageAddresses', N'buttons/manage_addresses.gif'
EXEC sp_AddImage @designId, N'Remove', N'buttons/remove.gif'
EXEC sp_AddImage @designId, N'ReOrder', N'buttons/reorder.gif'
EXEC sp_AddImage @designId, N'Save', N'buttons/save.gif'
EXEC sp_AddImage @designId, N'SaveCart', N'buttons/save_cart.gif'
EXEC sp_AddImage @designId, N'Search', N'buttons/icon_go.gif'
EXEC sp_AddImage @designId, N'Send', N'buttons/send.gif'
EXEC sp_AddImage @designId, N'SignIn', N'buttons/sign_in.gif'
EXEC sp_AddImage @designId, N'SignOut', N'buttons/sign_out.gif'
EXEC sp_AddImage @designId, N'Track', N'buttons/track.gif'
EXEC sp_AddImage @designId, N'UpdateQuantity', N'buttons/update_quantity.gif'
EXEC sp_AddImage @designId, N'View', N'buttons/view.gif'
EXEC sp_AddImage @designId, N'ViewAndPrintReceipt', N'buttons/viewandprintreceipt.gif'

-- sp_AddLayout inserts the record into the Layout table or updates if a record with
-- the same name and design id exists.
EXEC sp_AddLayout @designId, N'BodyTable', NULL, NULL, NULL, NULL, NULL, N'Center', NULL, 0, 0, 0, 0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Content', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'ContentTableHeader', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'ErrorMessages', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Footer', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, 1
EXEC sp_AddLayout @designId, N'Headings', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Instruction', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'LeftColumn', NULL, NULL, NULL, NULL, NULL, NULL, N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, 1
EXEC sp_AddLayout @designId, N'Messages', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'RightColumn', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, 0
EXEC sp_AddLayout @designId, N'TopBanner', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, 0, 1
EXEC sp_AddLayout @designId, N'TopSubBanner', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, 0, 1

-- sp_AddMenuBar inserts the record into the MenuBar table or updates if a record with
-- the same page name, menu text and design id exists.
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Home', NULL, NULL, N'default.aspx', 0, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Categories', NULL, NULL, N'SearchResult.aspx?CategoryID=', 1, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Home', NULL, N'default.aspx', 3, 0, 1
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'About Us', NULL, N'about.aspx', 3, 0, 2
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Contact Us', NULL, N'contact.aspx', 3, 0, 3
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'FAQ', NULL, N'faq.aspx', 3, 0, 4
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Privacy Policy', NULL, N'privacy-policy.aspx', 3, 0, 5
]]></SQLServer>
  <!-- end - Theme3 - Brown -->
  <!-- begin - Theme3 - Red -->
  <SQLServer><![CDATA[

DECLARE @designId INT

-- sp_AddDesign inserts the record into the Designs table or updates if a record with
-- the same name exists. This procedure returns the design id used by this theme.
EXEC sp_AddStoreFrontDesign N'Theme 3 - Red', N'Theme3', N'Red', N'Theme 3', @designId OUT

-- sp_AddImage inserts the record into the Images table or updates if a record with
-- the same name and design id exists.
EXEC sp_AddImage @designId, N'Add', N'buttons/add.gif'
EXEC sp_AddImage @designId, N'AddAddress', N'buttons/add_addresses.gif'
EXEC sp_AddImage @designId, N'AddToOrder', N'buttons/add_to_cart.gif'
EXEC sp_AddImage @designId, N'AddToSavedCart', N'buttons/addtosavedcart.gif'
EXEC sp_AddImage @designId, N'Apply', N'buttons/apply.gif'
EXEC sp_AddImage @designId, N'BuyNow', N'buttons/buy_now.gif'
EXEC sp_AddImage @designId, N'Cancel', N'buttons/cancel.gif'
EXEC sp_AddImage @designId, N'CheckOut', N'buttons/checkout.gif'
EXEC sp_AddImage @designId, N'Clear', N'buttons/clear.gif'
EXEC sp_AddImage @designId, N'Close', N'buttons/close.gif'
EXEC sp_AddImage @designId, N'CompleteOrder', N'buttons/complete_order.gif'
EXEC sp_AddImage @designId, N'Continue', N'buttons/continue.gif'
EXEC sp_AddImage @designId, N'CreateAccount', N'buttons/continue.gif'
EXEC sp_AddImage @designId, N'Delete', N'buttons/delete.gif'
EXEC sp_AddImage @designId, N'Edit', N'buttons/edit.gif'
EXEC sp_AddImage @designId, N'EmailFriend', N'buttons/email_friend.gif'
EXEC sp_AddImage @designId, N'FilterResults', N'buttons/filter_results.gif'
EXEC sp_AddImage @designId, N'GiftWrap', N'buttons/gift_wrap.gif'
EXEC sp_AddImage @designId, N'LagardeLogo', N'ft-poweredby.gif'
EXEC sp_AddImage @designId, N'ManageAddresses', N'buttons/manage_addresses.gif'
EXEC sp_AddImage @designId, N'Remove', N'buttons/remove.gif'
EXEC sp_AddImage @designId, N'ReOrder', N'buttons/reorder.gif'
EXEC sp_AddImage @designId, N'Save', N'buttons/save.gif'
EXEC sp_AddImage @designId, N'SaveCart', N'buttons/save_cart.gif'
EXEC sp_AddImage @designId, N'Search', N'buttons/icon_go.gif'
EXEC sp_AddImage @designId, N'Send', N'buttons/send.gif'
EXEC sp_AddImage @designId, N'SignIn', N'buttons/sign_in.gif'
EXEC sp_AddImage @designId, N'SignOut', N'buttons/sign_out.gif'
EXEC sp_AddImage @designId, N'Track', N'buttons/track.gif'
EXEC sp_AddImage @designId, N'UpdateQuantity', N'buttons/update_quantity.gif'
EXEC sp_AddImage @designId, N'View', N'buttons/view.gif'
EXEC sp_AddImage @designId, N'ViewAndPrintReceipt', N'buttons/viewandprintreceipt.gif'

-- sp_AddLayout inserts the record into the Layout table or updates if a record with
-- the same name and design id exists.
EXEC sp_AddLayout @designId, N'BodyTable', NULL, NULL, NULL, NULL, NULL, N'Center', NULL, 0, 0, 0, 0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Content', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'ContentTableHeader', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'ErrorMessages', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Footer', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, 1
EXEC sp_AddLayout @designId, N'Headings', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Instruction', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'LeftColumn', NULL, NULL, NULL, NULL, NULL, NULL, N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, 1
EXEC sp_AddLayout @designId, N'Messages', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'RightColumn', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, 0
EXEC sp_AddLayout @designId, N'TopBanner', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, 0, 1
EXEC sp_AddLayout @designId, N'TopSubBanner', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, 0, 1

-- sp_AddMenuBar inserts the record into the MenuBar table or updates if a record with
-- the same page name, menu text and design id exists.
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Home', NULL, NULL, N'default.aspx', 0, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Categories', NULL, NULL, N'SearchResult.aspx?CategoryID=', 1, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Home', NULL, N'default.aspx', 3, 0, 1
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'About Us', NULL, N'about.aspx', 3, 0, 2
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Contact Us', NULL, N'contact.aspx', 3, 0, 3
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'FAQ', NULL, N'faq.aspx', 3, 0, 4
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Privacy Policy', NULL, N'privacy-policy.aspx', 3, 0, 5
]]></SQLServer>
  <!-- end - Theme3 - Red -->
  <!-- begin - Theme3 - Yellow -->
  <SQLServer><![CDATA[

DECLARE @designId INT

-- sp_AddDesign inserts the record into the Designs table or updates if a record with
-- the same name exists. This procedure returns the design id used by this theme.
EXEC sp_AddStoreFrontDesign N'Theme 3 - Yellow', N'Theme3', N'Yellow', N'Theme 3', @designId OUT

-- sp_AddImage inserts the record into the Images table or updates if a record with
-- the same name and design id exists.
EXEC sp_AddImage @designId, N'Add', N'buttons/add.gif'
EXEC sp_AddImage @designId, N'AddAddress', N'buttons/add_addresses.gif'
EXEC sp_AddImage @designId, N'AddToOrder', N'buttons/add_to_cart.gif'
EXEC sp_AddImage @designId, N'AddToSavedCart', N'buttons/addtosavedcart.gif'
EXEC sp_AddImage @designId, N'Apply', N'buttons/apply.gif'
EXEC sp_AddImage @designId, N'BuyNow', N'buttons/buy_now.gif'
EXEC sp_AddImage @designId, N'Cancel', N'buttons/cancel.gif'
EXEC sp_AddImage @designId, N'CheckOut', N'buttons/checkout.gif'
EXEC sp_AddImage @designId, N'Clear', N'buttons/clear.gif'
EXEC sp_AddImage @designId, N'Close', N'buttons/close.gif'
EXEC sp_AddImage @designId, N'CompleteOrder', N'buttons/complete_order.gif'
EXEC sp_AddImage @designId, N'Continue', N'buttons/continue.gif'
EXEC sp_AddImage @designId, N'CreateAccount', N'buttons/continue.gif'
EXEC sp_AddImage @designId, N'Delete', N'buttons/delete.gif'
EXEC sp_AddImage @designId, N'Edit', N'buttons/edit.gif'
EXEC sp_AddImage @designId, N'EmailFriend', N'buttons/email_friend.gif'
EXEC sp_AddImage @designId, N'FilterResults', N'buttons/filter_results.gif'
EXEC sp_AddImage @designId, N'GiftWrap', N'buttons/gift_wrap.gif'
EXEC sp_AddImage @designId, N'LagardeLogo', N'ft-poweredby.gif'
EXEC sp_AddImage @designId, N'ManageAddresses', N'buttons/manage_addresses.gif'
EXEC sp_AddImage @designId, N'Remove', N'buttons/remove.gif'
EXEC sp_AddImage @designId, N'ReOrder', N'buttons/reorder.gif'
EXEC sp_AddImage @designId, N'Save', N'buttons/save.gif'
EXEC sp_AddImage @designId, N'SaveCart', N'buttons/save_cart.gif'
EXEC sp_AddImage @designId, N'Search', N'buttons/icon_go.gif'
EXEC sp_AddImage @designId, N'Send', N'buttons/send.gif'
EXEC sp_AddImage @designId, N'SignIn', N'buttons/sign_in.gif'
EXEC sp_AddImage @designId, N'SignOut', N'buttons/sign_out.gif'
EXEC sp_AddImage @designId, N'Track', N'buttons/track.gif'
EXEC sp_AddImage @designId, N'UpdateQuantity', N'buttons/update_quantity.gif'
EXEC sp_AddImage @designId, N'View', N'buttons/view.gif'
EXEC sp_AddImage @designId, N'ViewAndPrintReceipt', N'buttons/viewandprintreceipt.gif'

-- sp_AddLayout inserts the record into the Layout table or updates if a record with
-- the same name and design id exists.
EXEC sp_AddLayout @designId, N'BodyTable', NULL, NULL, NULL, NULL, NULL, N'Center', NULL, 0, 0, 0, 0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Content', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'ContentTableHeader', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'ErrorMessages', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Footer', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, 1
EXEC sp_AddLayout @designId, N'Headings', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Instruction', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'LeftColumn', NULL, NULL, NULL, NULL, NULL, NULL, N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, 1
EXEC sp_AddLayout @designId, N'Messages', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'RightColumn', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, 0
EXEC sp_AddLayout @designId, N'TopBanner', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, 0, 1
EXEC sp_AddLayout @designId, N'TopSubBanner', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, 0, 1

-- sp_AddMenuBar inserts the record into the MenuBar table or updates if a record with
-- the same page name, menu text and design id exists.
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Home', NULL, NULL, N'default.aspx', 0, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Categories', NULL, NULL, N'SearchResult.aspx?CategoryID=', 1, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Home', NULL, N'default.aspx', 3, 0, 1
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'About Us', NULL, N'about.aspx', 3, 0, 2
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Contact Us', NULL, N'contact.aspx', 3, 0, 3
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'FAQ', NULL, N'faq.aspx', 3, 0, 4
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Privacy Policy', NULL, N'privacy-policy.aspx', 3, 0, 5
]]></SQLServer>
  <!-- end - Theme3 - Yellow -->
  <!-- begin - Theme2 - Blue -->
  <SQLServer><![CDATA[

DECLARE @designId INT

-- sp_AddDesign inserts the record into the Designs table or updates if a record with
-- the same name exists. This procedure returns the design id used by this theme.
EXEC sp_AddStoreFrontDesign N'Theme 2 - Blue', N'Theme2', N'Blue', N'Theme 2', @designId OUT

-- sp_AddImage inserts the record into the Images table or updates if a record with
-- the same name and design id exists.
EXEC sp_AddImage @designId, N'Add', N'buttons/add.gif'
EXEC sp_AddImage @designId, N'AddAddress', N'buttons/add_addresses.gif'
EXEC sp_AddImage @designId, N'AddToOrder', N'buttons/add_to_cart.gif'
EXEC sp_AddImage @designId, N'AddToSavedCart', N'buttons/addtosavedcart.gif'
EXEC sp_AddImage @designId, N'Apply', N'buttons/apply.gif'
EXEC sp_AddImage @designId, N'BuyNow', N'buttons/buy_now.gif'
EXEC sp_AddImage @designId, N'Cancel', N'buttons/cancel.gif'
EXEC sp_AddImage @designId, N'CheckOut', N'buttons/checkout.gif'
EXEC sp_AddImage @designId, N'Clear', N'buttons/clear.gif'
EXEC sp_AddImage @designId, N'Close', N'buttons/close.gif'
EXEC sp_AddImage @designId, N'CompleteOrder', N'buttons/complete_order.gif'
EXEC sp_AddImage @designId, N'Continue', N'buttons/continue.gif'
EXEC sp_AddImage @designId, N'CreateAccount', N'buttons/continue.gif'
EXEC sp_AddImage @designId, N'Delete', N'buttons/delete.gif'
EXEC sp_AddImage @designId, N'Edit', N'buttons/edit.gif'
EXEC sp_AddImage @designId, N'EmailFriend', N'buttons/email_friend.gif'
EXEC sp_AddImage @designId, N'FilterResults', N'buttons/filter_results.gif'
EXEC sp_AddImage @designId, N'GiftWrap', N'buttons/gift_wrap.gif'
EXEC sp_AddImage @designId, N'LagardeLogo', N'ft-poweredby.gif'
EXEC sp_AddImage @designId, N'ManageAddresses', N'buttons/manage_addresses.gif'
EXEC sp_AddImage @designId, N'Remove', N'buttons/remove.gif'
EXEC sp_AddImage @designId, N'ReOrder', N'buttons/reorder.gif'
EXEC sp_AddImage @designId, N'Save', N'buttons/save.gif'
EXEC sp_AddImage @designId, N'SaveCart', N'buttons/save_cart.gif'
EXEC sp_AddImage @designId, N'Search', N'buttons/icon_go.gif'
EXEC sp_AddImage @designId, N'Send', N'buttons/send.gif'
EXEC sp_AddImage @designId, N'SignIn', N'buttons/sign_in.gif'
EXEC sp_AddImage @designId, N'SignOut', N'buttons/sign_out.gif'
EXEC sp_AddImage @designId, N'Track', N'buttons/track.gif'
EXEC sp_AddImage @designId, N'UpdateQuantity', N'buttons/update_quantity.gif'
EXEC sp_AddImage @designId, N'View', N'buttons/view.gif'
EXEC sp_AddImage @designId, N'ViewAndPrintReceipt', N'buttons/viewandprintreceipt.gif'

-- sp_AddLayout inserts the record into the Layout table or updates if a record with
-- the same name and design id exists.
EXEC sp_AddLayout @designId, N'BodyTable', NULL, NULL, NULL, NULL, NULL, N'Center', NULL, 0, 0, 0, 0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Content', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'ContentTableHeader', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'ErrorMessages', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Footer', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, 1
EXEC sp_AddLayout @designId, N'Headings', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Instruction', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'LeftColumn', NULL, NULL, NULL, NULL, NULL, NULL, N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, 1
EXEC sp_AddLayout @designId, N'Messages', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'RightColumn', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, 0
EXEC sp_AddLayout @designId, N'TopBanner', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, 0, 1
EXEC sp_AddLayout @designId, N'TopSubBanner', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, 0, 1

-- sp_AddMenuBar inserts the record into the MenuBar table or updates if a record with
-- the same page name, menu text and design id exists.
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Home', NULL, NULL, N'default.aspx', 0, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Categories', NULL, NULL, N'SearchResult.aspx?CategoryID=', 1, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Home', NULL, N'default.aspx', 3, 0, 1
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'About Us', NULL, N'about.aspx', 3, 0, 2
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Contact Us', NULL, N'contact.aspx', 3, 0, 3
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'FAQ', NULL, N'faq.aspx', 3, 0, 4
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Privacy Policy', NULL, N'privacy-policy.aspx', 3, 0, 5

-- activate this theme if there isnt already one
UPDATE Designs SET IsActive = 0
UPDATE Designs SET IsActive = 1 WHERE uid = @designId
]]></SQLServer>
  <!-- end - Theme2 - Blue -->
  <!-- begin - Theme2 - Grey -->
  <SQLServer><![CDATA[

DECLARE @designId INT

-- sp_AddDesign inserts the record into the Designs table or updates if a record with
-- the same name exists. This procedure returns the design id used by this theme.
EXEC sp_AddStoreFrontDesign N'Theme 2 - Grey', N'Theme2', N'Grey', N'Theme 2', @designId OUT

-- sp_AddImage inserts the record into the Images table or updates if a record with
-- the same name and design id exists.
EXEC sp_AddImage @designId, N'Add', N'buttons/add.gif'
EXEC sp_AddImage @designId, N'AddAddress', N'buttons/add_addresses.gif'
EXEC sp_AddImage @designId, N'AddToOrder', N'buttons/add_to_cart.gif'
EXEC sp_AddImage @designId, N'AddToSavedCart', N'buttons/addtosavedcart.gif'
EXEC sp_AddImage @designId, N'Apply', N'buttons/apply.gif'
EXEC sp_AddImage @designId, N'BuyNow', N'buttons/buy_now.gif'
EXEC sp_AddImage @designId, N'Cancel', N'buttons/cancel.gif'
EXEC sp_AddImage @designId, N'CheckOut', N'buttons/checkout.gif'
EXEC sp_AddImage @designId, N'Clear', N'buttons/clear.gif'
EXEC sp_AddImage @designId, N'Close', N'buttons/close.gif'
EXEC sp_AddImage @designId, N'CompleteOrder', N'buttons/complete_order.gif'
EXEC sp_AddImage @designId, N'Continue', N'buttons/continue.gif'
EXEC sp_AddImage @designId, N'CreateAccount', N'buttons/continue.gif'
EXEC sp_AddImage @designId, N'Delete', N'buttons/delete.gif'
EXEC sp_AddImage @designId, N'Edit', N'buttons/edit.gif'
EXEC sp_AddImage @designId, N'EmailFriend', N'buttons/email_friend.gif'
EXEC sp_AddImage @designId, N'FilterResults', N'buttons/filter_results.gif'
EXEC sp_AddImage @designId, N'GiftWrap', N'buttons/gift_wrap.gif'
EXEC sp_AddImage @designId, N'LagardeLogo', N'ft-poweredby.gif'
EXEC sp_AddImage @designId, N'ManageAddresses', N'buttons/manage_addresses.gif'
EXEC sp_AddImage @designId, N'Remove', N'buttons/remove.gif'
EXEC sp_AddImage @designId, N'ReOrder', N'buttons/reorder.gif'
EXEC sp_AddImage @designId, N'Save', N'buttons/save.gif'
EXEC sp_AddImage @designId, N'SaveCart', N'buttons/save_cart.gif'
EXEC sp_AddImage @designId, N'Search', N'buttons/icon_go.gif'
EXEC sp_AddImage @designId, N'Send', N'buttons/send.gif'
EXEC sp_AddImage @designId, N'SignIn', N'buttons/sign_in.gif'
EXEC sp_AddImage @designId, N'SignOut', N'buttons/sign_out.gif'
EXEC sp_AddImage @designId, N'Track', N'buttons/track.gif'
EXEC sp_AddImage @designId, N'UpdateQuantity', N'buttons/update_quantity.gif'
EXEC sp_AddImage @designId, N'View', N'buttons/view.gif'
EXEC sp_AddImage @designId, N'ViewAndPrintReceipt', N'buttons/viewandprintreceipt.gif'

-- sp_AddLayout inserts the record into the Layout table or updates if a record with
-- the same name and design id exists.
EXEC sp_AddLayout @designId, N'BodyTable', NULL, NULL, NULL, NULL, NULL, N'Center', NULL, 0, 0, 0, 0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Content', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'ContentTableHeader', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'ErrorMessages', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Footer', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, 1
EXEC sp_AddLayout @designId, N'Headings', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Instruction', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'LeftColumn', NULL, NULL, NULL, NULL, NULL, NULL, N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, 1
EXEC sp_AddLayout @designId, N'Messages', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'RightColumn', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, 0
EXEC sp_AddLayout @designId, N'TopBanner', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, 0, 1
EXEC sp_AddLayout @designId, N'TopSubBanner', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, 0, 1

-- sp_AddMenuBar inserts the record into the MenuBar table or updates if a record with
-- the same page name, menu text and design id exists.
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Home', NULL, NULL, N'default.aspx', 0, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Categories', NULL, NULL, N'SearchResult.aspx?CategoryID=', 1, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Home', NULL, N'default.aspx', 3, 0, 1
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'About Us', NULL, N'about.aspx', 3, 0, 2
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Contact Us', NULL, N'contact.aspx', 3, 0, 3
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'FAQ', NULL, N'faq.aspx', 3, 0, 4
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Privacy Policy', NULL, N'privacy-policy.aspx', 3, 0, 5
]]></SQLServer>
  <!-- end - Theme2 - Grey -->
  <!-- begin - Theme2 - Purple -->
  <SQLServer><![CDATA[

DECLARE @designId INT

-- sp_AddDesign inserts the record into the Designs table or updates if a record with
-- the same name exists. This procedure returns the design id used by this theme.
EXEC sp_AddStoreFrontDesign N'Theme 2 - Purple', N'Theme2', N'Purple', N'Theme 2', @designId OUT

-- sp_AddImage inserts the record into the Images table or updates if a record with
-- the same name and design id exists.
EXEC sp_AddImage @designId, N'Add', N'buttons/add.gif'
EXEC sp_AddImage @designId, N'AddAddress', N'buttons/add_addresses.gif'
EXEC sp_AddImage @designId, N'AddToOrder', N'buttons/add_to_cart.gif'
EXEC sp_AddImage @designId, N'AddToSavedCart', N'buttons/addtosavedcart.gif'
EXEC sp_AddImage @designId, N'Apply', N'buttons/apply.gif'
EXEC sp_AddImage @designId, N'BuyNow', N'buttons/buy_now.gif'
EXEC sp_AddImage @designId, N'Cancel', N'buttons/cancel.gif'
EXEC sp_AddImage @designId, N'CheckOut', N'buttons/checkout.gif'
EXEC sp_AddImage @designId, N'Clear', N'buttons/clear.gif'
EXEC sp_AddImage @designId, N'Close', N'buttons/close.gif'
EXEC sp_AddImage @designId, N'CompleteOrder', N'buttons/complete_order.gif'
EXEC sp_AddImage @designId, N'Continue', N'buttons/continue.gif'
EXEC sp_AddImage @designId, N'CreateAccount', N'buttons/continue.gif'
EXEC sp_AddImage @designId, N'Delete', N'buttons/delete.gif'
EXEC sp_AddImage @designId, N'Edit', N'buttons/edit.gif'
EXEC sp_AddImage @designId, N'EmailFriend', N'buttons/email_friend.gif'
EXEC sp_AddImage @designId, N'FilterResults', N'buttons/filter_results.gif'
EXEC sp_AddImage @designId, N'GiftWrap', N'buttons/gift_wrap.gif'
EXEC sp_AddImage @designId, N'LagardeLogo', N'ft-poweredby.gif'
EXEC sp_AddImage @designId, N'ManageAddresses', N'buttons/manage_addresses.gif'
EXEC sp_AddImage @designId, N'Remove', N'buttons/remove.gif'
EXEC sp_AddImage @designId, N'ReOrder', N'buttons/reorder.gif'
EXEC sp_AddImage @designId, N'Save', N'buttons/save.gif'
EXEC sp_AddImage @designId, N'SaveCart', N'buttons/save_cart.gif'
EXEC sp_AddImage @designId, N'Search', N'buttons/icon_go.gif'
EXEC sp_AddImage @designId, N'Send', N'buttons/send.gif'
EXEC sp_AddImage @designId, N'SignIn', N'buttons/sign_in.gif'
EXEC sp_AddImage @designId, N'SignOut', N'buttons/sign_out.gif'
EXEC sp_AddImage @designId, N'Track', N'buttons/track.gif'
EXEC sp_AddImage @designId, N'UpdateQuantity', N'buttons/update_quantity.gif'
EXEC sp_AddImage @designId, N'View', N'buttons/view.gif'
EXEC sp_AddImage @designId, N'ViewAndPrintReceipt', N'buttons/viewandprintreceipt.gif'

-- sp_AddLayout inserts the record into the Layout table or updates if a record with
-- the same name and design id exists.
EXEC sp_AddLayout @designId, N'BodyTable', NULL, NULL, NULL, NULL, NULL, N'Center', NULL, 0, 0, 0, 0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Content', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'ContentTableHeader', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'ErrorMessages', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Footer', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, 1
EXEC sp_AddLayout @designId, N'Headings', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Instruction', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'LeftColumn', NULL, NULL, NULL, NULL, NULL, NULL, N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, 1
EXEC sp_AddLayout @designId, N'Messages', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'RightColumn', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, NULL, 0
EXEC sp_AddLayout @designId, N'TopBanner', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, 0, 1
EXEC sp_AddLayout @designId, N'TopSubBanner', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 11, NULL, N'Normal', NULL, 0, 1

-- sp_AddMenuBar inserts the record into the MenuBar table or updates if a record with
-- the same page name, menu text and design id exists.
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Home', NULL, NULL, N'default.aspx', 0, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Categories', NULL, NULL, N'SearchResult.aspx?CategoryID=', 1, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Home', NULL, N'default.aspx', 3, 0, 1
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'About Us', NULL, N'about.aspx', 3, 0, 2
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Contact Us', NULL, N'contact.aspx', 3, 0, 3
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'FAQ', NULL, N'faq.aspx', 3, 0, 4
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Privacy Policy', NULL, N'privacy-policy.aspx', 3, 0, 5
]]></SQLServer>
  <!-- end - Theme2 - Purple -->
  <!-- begin - Theme5 - Blue -->
  <SQLServer><![CDATA[

DECLARE @designId INT

-- sp_AddDesign inserts the record into the Designs table or updates if a record with
-- the same name exists. This procedure returns the design id used by this theme.
EXEC sp_AddStoreFrontDesign N'Theme 5 - Blue', N'Theme5', N'Blue', N'Theme 5', @designId OUT

-- sp_AddImage inserts the record into the Images table or updates if a record with
-- the same name and design id exists.
EXEC sp_AddImage @designId, N'Add', N'buttons/add.gif'
EXEC sp_AddImage @designId, N'AddAddress', N'buttons/add_addresses.gif'
EXEC sp_AddImage @designId, N'AddToOrder', N'buttons/add_to_cart.gif'
EXEC sp_AddImage @designId, N'AddToSavedCart', N'buttons/addtosavedcart.gif'
EXEC sp_AddImage @designId, N'Apply', N'buttons/apply.gif'
EXEC sp_AddImage @designId, N'BuyNow', N'buttons/buy_now.gif'
EXEC sp_AddImage @designId, N'Cancel', N'buttons/cancel.gif'
EXEC sp_AddImage @designId, N'CheckOut', N'buttons/checkout.gif'
EXEC sp_AddImage @designId, N'Clear', N'buttons/clear.gif'
EXEC sp_AddImage @designId, N'Close', N'buttons/close.gif'
EXEC sp_AddImage @designId, N'CompleteOrder', N'buttons/complete_order.gif'
EXEC sp_AddImage @designId, N'Continue', N'buttons/continue.gif'
EXEC sp_AddImage @designId, N'CreateAccount', N'buttons/continue.gif'
EXEC sp_AddImage @designId, N'Delete', N'buttons/delete.gif'
EXEC sp_AddImage @designId, N'Edit', N'buttons/edit.gif'
EXEC sp_AddImage @designId, N'EmailFriend', N'buttons/email_friend.gif'
EXEC sp_AddImage @designId, N'FilterResults', N'buttons/filter_results.gif'
EXEC sp_AddImage @designId, N'GiftWrap', N'buttons/gift_wrap.gif'
EXEC sp_AddImage @designId, N'LagardeLogo', N'ft-lagarde_logo.gif'
EXEC sp_AddImage @designId, N'ManageAddresses', N'buttons/manage_addresses.gif'
EXEC sp_AddImage @designId, N'Remove', N'buttons/remove.gif'
EXEC sp_AddImage @designId, N'ReOrder', N'buttons/reorder.gif'
EXEC sp_AddImage @designId, N'Save', N'buttons/save.gif'
EXEC sp_AddImage @designId, N'SaveCart', N'buttons/save_cart.gif'
EXEC sp_AddImage @designId, N'Search', N'buttons/icon_go.gif'
EXEC sp_AddImage @designId, N'Send', N'buttons/send.gif'
EXEC sp_AddImage @designId, N'SignIn', N'buttons/sign_in.gif'
EXEC sp_AddImage @designId, N'SignOut', N'buttons/sign_out.gif'
EXEC sp_AddImage @designId, N'Track', N'buttons/track.gif'
EXEC sp_AddImage @designId, N'UpdateQuantity', N'buttons/update_quantity.gif'
EXEC sp_AddImage @designId, N'View', N'buttons/view.gif'
EXEC sp_AddImage @designId, N'ViewAndPrintReceipt', N'buttons/viewandprintreceipt.gif'

-- sp_AddLayout inserts the record into the Layout table or updates if a record with
-- the same name and design id exists.
EXEC sp_AddLayout @designId, N'BodyTable', NULL, N'0', N'0', NULL, NULL, N'Center', NULL, 0, 0, 0, 0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Content', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'ContentTableHeader', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 10, NULL, N'Bold', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'ErrorMessages', NULL, NULL, NULL, NULL, NULL, N'Center', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Bold', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Footer', NULL, NULL, NULL, NULL, NULL, N'Left', N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, 1
EXEC sp_AddLayout @designId, N'Headings', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 10, NULL, N'Bold', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Instruction', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'LeftColumn', NULL, NULL, NULL, NULL, NULL, N'Left', N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, 1
EXEC sp_AddLayout @designId, N'Messages', NULL, NULL, NULL, NULL, NULL, N'Center', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Bold', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'RightColumn', NULL, NULL, NULL, NULL, NULL, N'Left', N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, 0
EXEC sp_AddLayout @designId, N'TopBanner', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 10, NULL, N'Normal', N'design/bn-logo.gif', 1, 1
EXEC sp_AddLayout @designId, N'TopSubBanner', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 9, NULL, N'Normal', NULL, 0, 1

-- sp_AddMenuBar inserts the record into the MenuBar table or updates if a record with
-- the same page name, menu text and design id exists.
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Home', NULL, NULL, N'default.aspx', 0, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Categories', NULL, NULL, N'SearchResult.aspx?CategoryID=', 1, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Home', NULL, N'default.aspx', 3, 0, 1
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'About Us', NULL, N'about.aspx', 3, 0, 2
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Contact Us', NULL, N'contact.aspx', 3, 0, 3
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'FAQ', NULL, N'faq.aspx', 3, 0, 4
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Privacy Policy', NULL, N'privacy-policy.aspx', 3, 0, 5
]]></SQLServer>
  <!-- end - Theme5 - Blue -->
  <!-- begin - Theme5 - Brown -->
  <SQLServer><![CDATA[

DECLARE @designId INT

-- sp_AddDesign inserts the record into the Designs table or updates if a record with
-- the same name exists. This procedure returns the design id used by this theme.
EXEC sp_AddStoreFrontDesign N'Theme 5 - Brown', N'Theme5', N'Brown', N'Theme 5', @designId OUT

-- sp_AddImage inserts the record into the Images table or updates if a record with
-- the same name and design id exists.
EXEC sp_AddImage @designId, N'Add', N'buttons/add.gif'
EXEC sp_AddImage @designId, N'AddAddress', N'buttons/add_addresses.gif'
EXEC sp_AddImage @designId, N'AddToOrder', N'buttons/add_to_cart.gif'
EXEC sp_AddImage @designId, N'AddToSavedCart', N'buttons/addtosavedcart.gif'
EXEC sp_AddImage @designId, N'Apply', N'buttons/apply.gif'
EXEC sp_AddImage @designId, N'BuyNow', N'buttons/buy_now.gif'
EXEC sp_AddImage @designId, N'Cancel', N'buttons/cancel.gif'
EXEC sp_AddImage @designId, N'CheckOut', N'buttons/checkout.gif'
EXEC sp_AddImage @designId, N'Clear', N'buttons/clear.gif'
EXEC sp_AddImage @designId, N'Close', N'buttons/close.gif'
EXEC sp_AddImage @designId, N'CompleteOrder', N'buttons/complete_order.gif'
EXEC sp_AddImage @designId, N'Continue', N'buttons/continue.gif'
EXEC sp_AddImage @designId, N'CreateAccount', N'buttons/continue.gif'
EXEC sp_AddImage @designId, N'Delete', N'buttons/delete.gif'
EXEC sp_AddImage @designId, N'Edit', N'buttons/edit.gif'
EXEC sp_AddImage @designId, N'EmailFriend', N'buttons/email_friend.gif'
EXEC sp_AddImage @designId, N'FilterResults', N'buttons/filter_results.gif'
EXEC sp_AddImage @designId, N'GiftWrap', N'buttons/gift_wrap.gif'
EXEC sp_AddImage @designId, N'LagardeLogo', N'ft-lagarde_logo.gif'
EXEC sp_AddImage @designId, N'ManageAddresses', N'buttons/manage_addresses.gif'
EXEC sp_AddImage @designId, N'Remove', N'buttons/remove.gif'
EXEC sp_AddImage @designId, N'ReOrder', N'buttons/reorder.gif'
EXEC sp_AddImage @designId, N'Save', N'buttons/save.gif'
EXEC sp_AddImage @designId, N'SaveCart', N'buttons/save_cart.gif'
EXEC sp_AddImage @designId, N'Search', N'buttons/icon_go.gif'
EXEC sp_AddImage @designId, N'Send', N'buttons/send.gif'
EXEC sp_AddImage @designId, N'SignIn', N'buttons/sign_in.gif'
EXEC sp_AddImage @designId, N'SignOut', N'buttons/sign_out.gif'
EXEC sp_AddImage @designId, N'Track', N'buttons/track.gif'
EXEC sp_AddImage @designId, N'UpdateQuantity', N'buttons/update_quantity.gif'
EXEC sp_AddImage @designId, N'View', N'buttons/view.gif'
EXEC sp_AddImage @designId, N'ViewAndPrintReceipt', N'buttons/viewandprintreceipt.gif'

-- sp_AddLayout inserts the record into the Layout table or updates if a record with
-- the same name and design id exists.
EXEC sp_AddLayout @designId, N'BodyTable', NULL, N'0', N'0', NULL, NULL, N'Center', NULL, 0, 0, 0, 0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Content', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'ContentTableHeader', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 10, NULL, N'Bold', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'ErrorMessages', NULL, NULL, NULL, NULL, NULL, N'Center', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Bold', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Footer', NULL, NULL, NULL, NULL, NULL, N'Left', N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, 1
EXEC sp_AddLayout @designId, N'Headings', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 10, NULL, N'Bold', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Instruction', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'LeftColumn', NULL, NULL, NULL, NULL, NULL, N'Left', N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, 1
EXEC sp_AddLayout @designId, N'Messages', NULL, NULL, NULL, NULL, NULL, N'Center', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Bold', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'RightColumn', NULL, NULL, NULL, NULL, NULL, N'Left', N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, 0
EXEC sp_AddLayout @designId, N'TopBanner', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 10, NULL, N'Normal', N'design/bn-logo.gif', 1, 1
EXEC sp_AddLayout @designId, N'TopSubBanner', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 9, NULL, N'Normal', NULL, 0, 1

-- sp_AddMenuBar inserts the record into the MenuBar table or updates if a record with
-- the same page name, menu text and design id exists.
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Home', NULL, NULL, N'default.aspx', 0, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Categories', NULL, NULL, N'SearchResult.aspx?CategoryID=', 1, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Home', NULL, N'default.aspx', 3, 0, 1
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'About Us', NULL, N'about.aspx', 3, 0, 2
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Contact Us', NULL, N'contact.aspx', 3, 0, 3
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'FAQ', NULL, N'faq.aspx', 3, 0, 4
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Privacy Policy', NULL, N'privacy-policy.aspx', 3, 0, 5
]]></SQLServer>
  <!-- end - Theme5 - Brown -->
  <!-- begin - Theme5 - Grey -->
  <SQLServer><![CDATA[

DECLARE @designId INT

-- sp_AddDesign inserts the record into the Designs table or updates if a record with
-- the same name exists. This procedure returns the design id used by this theme.
EXEC sp_AddStoreFrontDesign N'Theme 5 - Grey', N'Theme5', N'Grey', N'Theme 5', @designId OUT

-- sp_AddImage inserts the record into the Images table or updates if a record with
-- the same name and design id exists.
EXEC sp_AddImage @designId, N'Add', N'buttons/add.gif'
EXEC sp_AddImage @designId, N'AddAddress', N'buttons/add_addresses.gif'
EXEC sp_AddImage @designId, N'AddToOrder', N'buttons/add_to_cart.gif'
EXEC sp_AddImage @designId, N'AddToSavedCart', N'buttons/addtosavedcart.gif'
EXEC sp_AddImage @designId, N'Apply', N'buttons/apply.gif'
EXEC sp_AddImage @designId, N'BuyNow', N'buttons/buy_now.gif'
EXEC sp_AddImage @designId, N'Cancel', N'buttons/cancel.gif'
EXEC sp_AddImage @designId, N'CheckOut', N'buttons/checkout.gif'
EXEC sp_AddImage @designId, N'Clear', N'buttons/clear.gif'
EXEC sp_AddImage @designId, N'Close', N'buttons/close.gif'
EXEC sp_AddImage @designId, N'CompleteOrder', N'buttons/complete_order.gif'
EXEC sp_AddImage @designId, N'Continue', N'buttons/continue.gif'
EXEC sp_AddImage @designId, N'CreateAccount', N'buttons/continue.gif'
EXEC sp_AddImage @designId, N'Delete', N'buttons/delete.gif'
EXEC sp_AddImage @designId, N'Edit', N'buttons/edit.gif'
EXEC sp_AddImage @designId, N'EmailFriend', N'buttons/email_friend.gif'
EXEC sp_AddImage @designId, N'FilterResults', N'buttons/filter_results.gif'
EXEC sp_AddImage @designId, N'GiftWrap', N'buttons/gift_wrap.gif'
EXEC sp_AddImage @designId, N'LagardeLogo', N'ft-lagarde_logo.gif'
EXEC sp_AddImage @designId, N'ManageAddresses', N'buttons/manage_addresses.gif'
EXEC sp_AddImage @designId, N'Remove', N'buttons/remove.gif'
EXEC sp_AddImage @designId, N'ReOrder', N'buttons/reorder.gif'
EXEC sp_AddImage @designId, N'Save', N'buttons/save.gif'
EXEC sp_AddImage @designId, N'SaveCart', N'buttons/save_cart.gif'
EXEC sp_AddImage @designId, N'Search', N'buttons/icon_go.gif'
EXEC sp_AddImage @designId, N'Send', N'buttons/send.gif'
EXEC sp_AddImage @designId, N'SignIn', N'buttons/sign_in.gif'
EXEC sp_AddImage @designId, N'SignOut', N'buttons/sign_out.gif'
EXEC sp_AddImage @designId, N'Track', N'buttons/track.gif'
EXEC sp_AddImage @designId, N'UpdateQuantity', N'buttons/update_quantity.gif'
EXEC sp_AddImage @designId, N'View', N'buttons/view.gif'
EXEC sp_AddImage @designId, N'ViewAndPrintReceipt', N'buttons/viewandprintreceipt.gif'

-- sp_AddLayout inserts the record into the Layout table or updates if a record with
-- the same name and design id exists.
EXEC sp_AddLayout @designId, N'BodyTable', NULL, N'0', N'0', NULL, NULL, N'Center', NULL, 0, 0, 0, 0, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Content', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'ContentTableHeader', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 10, NULL, N'Bold', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'ErrorMessages', NULL, NULL, NULL, NULL, NULL, N'Center', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Bold', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Footer', NULL, NULL, NULL, NULL, NULL, N'Left', N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, 1
EXEC sp_AddLayout @designId, N'Headings', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 10, NULL, N'Bold', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'Instruction', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'LeftColumn', NULL, NULL, NULL, NULL, NULL, N'Left', N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, 1
EXEC sp_AddLayout @designId, N'Messages', NULL, NULL, NULL, NULL, NULL, N'Center', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Bold', NULL, NULL, NULL
EXEC sp_AddLayout @designId, N'RightColumn', NULL, NULL, NULL, NULL, NULL, N'Left', N'Top', NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 8, NULL, N'Normal', NULL, NULL, 0
EXEC sp_AddLayout @designId, N'TopBanner', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 10, NULL, N'Normal', N'design/bn-logo.gif', 1, 1
EXEC sp_AddLayout @designId, N'TopSubBanner', NULL, NULL, NULL, NULL, NULL, N'Left', NULL, NULL, NULL, NULL, NULL, NULL, NULL, N'Arial', 9, NULL, N'Normal', NULL, 0, 1

-- sp_AddMenuBar inserts the record into the MenuBar table or updates if a record with
-- the same page name, menu text and design id exists.
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Home', NULL, NULL, N'default.aspx', 0, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Categories', NULL, NULL, N'SearchResult.aspx?CategoryID=', 1, 0, 12
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Home', NULL, N'default.aspx', 3, 0, 1
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'About Us', NULL, N'about.aspx', 3, 0, 2
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Contact Us', NULL, N'contact.aspx', 3, 0, 3
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'FAQ', NULL, N'faq.aspx', 3, 0, 4
EXEC sp_AddMenuBar @designId, N'Default.aspx', N'Privacy Policy', NULL, N'privacy-policy.aspx', 3, 0, 5
]]></SQLServer>
  <!-- end - Theme5 - Grey -->
  <!-- begin: GJV - 2/5/2008 - # 722 - clean up any bad alignment data in the searchresults table -->
  <SQLServer><![CDATA[UPDATE [SearchResults] SET [Alignment] = 0 WHERE [Alignment] = 2]]></SQLServer>
  <!-- end: GJV - 2/5/2008 - # 722 -->
  <!-- begin: GJV - issue #947 - alter the OrderTracking.SentDate to be NVARCHAR(50) -->
  <SQLServer><![CDATA[ALTER TABLE [OrderTracking] ALTER COLUMN [SentDate] NVARCHAR(50)]]></SQLServer>
  <!-- end: GJV - issue #947 -->
</SQLStatements>