@using GA.BDC.Web.MGP.Models.Branding
@{
   ViewBag.Title = "Fundraising Online, Registration - Step 5";
   ViewBag.Description = "My.Fundraising.com : Register your Fundraising Online Campaign";
   ViewBag.Keywords = "online fundraising register, sign up EfundraisingOnline.com, start your online fundraising campaign, begin fundraising, register online fundraising campaign, start fundraising campaign online, register, EfundraisingOnline.com, My.Fundraising.com";
	ViewBag.HideTopMenu = true;
   Layout = "~/Views/Shared/_public2.cshtml";
   var eventBranding = ViewBag.Event as Event;
}
<div class="registration-steps" id="step-5" ng-controller="campaignManagerController" ng-init="participantId = @eventBranding.ParticipantId; registerView.Body = '@ViewBag.Body';">
   <div class="row">
      <div class="col-xs-12 text-center">
         <h1>Step 5</h1>
      </div>
   </div>
   <div class="row">
      <div class="col-xs-12 text-center registration-subtitle">
         <span>invite people</span>
      </div>
   </div>
   <div class="row">
      <div class="col-xs-12 text-center">
         <img src="/Content/images/public/content/separator.png" class="img-responsive" />
      </div>
   </div>
   <div class="row">
      <div class="col-xs-12 text-center">
         <span class="small text-muted" ng-cloak ng-show="importContacts">Import your contacts to share your fundraising campaign</span>
         </div>
   </div>
   <br />
   <div class="row">
      <div class="col-xs-12 col-md-offset-2 col-md-8">
         <div class="panel">
            <div class="panel-body">
               <div ng-cloak ng-show="importContacts">
                  <div class="row">
                     <div class="col-xs-offset-1 col-xs-4 text-center">
                        <a href="#" data-provider="Google" class="oauth_provider_link"><img src="/Content/images/public/content/gmail-icon.svg" class="img-responsive" /></a>
                     </div>
                     <div class="col-xs-offset-2 col-xs-4 text-center">
                        <a href="#" data-provider="Yahoo" class="oauth_provider_link"><img src="/Content/images/public/content/yahoo-icon.svg" class="img-responsive" /></a>
                     </div>
                  </div>
                  <div class="row ng-cloak" ng-show="recipients.length > 0">
                     <div class="col-xs-12">
                        <br/>
                        <div class="alert alert-success text-center">
                           <strong>You've imported {{recipients.length}} contacts</strong>
                        </div>
                     </div>
                  </div>
                  <br />
                  <div class="row">
                     <div class="col-xs-12 text-center text-muted">
	                     To add them manually, <a href="#" class="text-muted" style="text-decoration: underline" ng-click="importContacts = false;"><strong>click here.</strong></a>
                     </div>
                  </div>
               </div>
               <div ng-cloak ng-hide="importContacts">
                  <div class="row">
                     <div class="col-xs-12">
                        <strong class="text-muted">Add them manually</strong>
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-xs-12">
                        <textarea class="form-control" rows="5" ng-model="recipients" id="recipientsTextArea" placeholder="Separate multiple email addresses using the semicolon character. example1@gmail.com; example2@hotmail.com"></textarea>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>
	<div class="row">
		<div class="col-xs-12 text-center">
         <span class="text-muted">
            SEND REMINDERS EVERY <label><input type="radio" name="reminderFrecuency" ng-model="reminderFrecuency" value="3" /> 3 DAYS</label> <label><input type="radio" name="reminderFrecuency" ng-model="reminderFrecuency" value="5" /> 5 DAYS</label> <label><input type="radio" name="reminderFrecuency" ng-model="reminderFrecuency" value="7" /> 7 DAYS</label> <label><input type="radio" name="reminderFrecuency" ng-model="reminderFrecuency" value="10" /> 10 DAYS</label>
           </span>
</div>
	</div>
	<div class="row">
		<div class="col-xs-12 text-center">
			<div class="alert alert-info">
				<strong>Note: </strong> Due to Spam verification, Emails are not sent immediately. It will take around 60 minutes during business hours.
			</div>
		</div>
	</div>
	<div class="row" ng-cloak ng-show="recipients.length == 0">
		<div class="col-xs-12 text-center">
			<div class="alert alert-warning">
				<strong>To continue please import or add manually at least one Email</strong>
			</div>
		</div>
	</div>
   <div class="row">
      <div class="col-xs-12 col-sm-offset-3 col-sm-6 col-md-offset-4 col-md-4 text-center" ng-hide="executingAction">
         <button type="button" class="btn btn-lg btn-facebook form-control" ng-click="manageContacts(); step5();" ng-disabled="recipients.length == 0">Next Step</button>
      </div>
   </div>
   <div class="row">
      <div class="col-xs-12" ng-hide="executingAction">
         <a href="/registration/step-4?participantId=@eventBranding.ParticipantId" class="small text-muted">Go Back</a>
      </div>
   </div>
   <div class="row" ng-show="executingAction" ng-cloak>
      <div class="col-sm-12 text-center">
         <span class="text-info"><strong><span class="glyphicon glyphicon-refresh glyphicon-refresh-animate" aria-hidden="true"></span> Sending your information...</strong></span>
      </div>
   </div>
   <div class="row" ng-show="resultFailed" ng-cloak>
      <div class="col-sm-12 text-center">
         <span class="text-danger"><strong>{{responseText}}</strong></span>
      </div>
   </div>
</div>



<br />
<br />
@section Scripts{
   <script type="text/javascript">
      window.fbAsyncInit = function() {
         FB.init({
            appId: '470107796453192',
            xfbml: true,
            version: 'v2.1'
         });
      };

      $(document).ready(function() {
         var providerName = '';


         $(".tip").tooltip({});

         $(".oauth_provider_link").click(function() {
            $("#importContactsModal").modal("hide");
            var aHref = '@Url.Action("OAuthCallback", "CampaignManager")';
            var myWindow = window.open(aHref + "?provider=" + $(this).data("provider"),
               'popup',
               'width=600,height=600,location=0,menubar=0,resizeable=0,scrollbars=0,toolbar=0');
            providerName = $(this).data("provider");
            myWindow.focus();
            return false;
         });
         window.receiveContactsFromPopup = function(data, error) {
            if (error != undefined) {
               angular.element("#step-5").scope().responseText = error;
               angular.element("#step-5").scope().resultFailed = true;
            } else {
               var jsonContactList = $.parseJSON(data);
               var recipients = "";
               $.each(jsonContactList.Contacts,
                  function(k, v) {
                     recipients += ", " + v.FirstName + " " + v.LastName + " " + v.EmailAddress;
                  });
               if (recipients.substring(0, 2) === ", ") {
                  recipients = recipients.substring(2, recipients.length);
               }
               if ($("#recipientsTextArea").val() == "") {
                  $("#recipientsTextArea").val(recipients);
               } else {
                  $("#recipientsTextArea").val($("#recipientsTextArea").val() + ", " + recipients);
               }
               angular.element("#step-5").scope().manageImportedContacts(recipients, providerName);
               angular.element("#step-5").scope().step5();
            }
         };

         $("#importContactsModal").modal({});
      });
   </script>
}